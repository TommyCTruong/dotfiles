(self.webpackChunk=self.webpackChunk||[]).push([[9561],{64078:(e,t,n)=>{n.d(t,{X:()=>N});var i,a=n(59312),o=n(27378),s=n(57050),r=n(19962),l=n(5114),d=n(44060),c=n(67424),m=n(89894),u=n(32096),h=n(40327),p=n(5739),g=n(98403),f=n(49708),b=n(85985),v=n(41398),k=n(24209),y=n(17343),x=n(38194),I=n(598),_=n(50628),w=n(25781),E=n(83078),C=n(18625);!function(e){var t="scrollaction";e.emit=function(e){return self.dispatchEvent(new CustomEvent(t,{detail:e}))},e.observe=C.P((function(){return f.R(self,t)}))}(i||(i={}));var U=n(42103),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._subs=[],t._outOfTarget=function(e){return function(t){return!r.UL.hasPoint(t.getBoundingClientRect(),e)}},t}return(0,a.ZT)(t,e),t.prototype.componentDidMount=function(){this._listenTooltipAppearance()},t.prototype.componentWillUnmount=function(){this._subs.forEach((function(e){return e.unsubscribe()})),this._subs=[],this.context.hide()},t.prototype.render=function(){return o.createElement(p.F.div,{"data-role":"tooltip"},this.context.state.view(this.props.children))},t.prototype._listenTooltipAppearance=function(){var e=this,t=f.R(document,"keydown").pipe(b.h((function(e){return e.keyCode===w.R.ESC_CODE}))),n=f.R(document,"mousedown").pipe(v.M(this.context.state),b.h((function(t){var n=t[0],i=t[1];return(0,h.pipe)(i,l.map((function(e){return e.target})),l.filter((function(){return r.pK(n.target)})),E.wo(e._outOfTarget({x:n.clientX,y:n.clientY})))}))),a=k.T(t,n,f.R(document,"scroll"),i.observe.pipe(b.h((function(e){return"show"===e.detail})))).pipe(y.h(g.PU),x.B());this._subs=[this.context.hasContent.pipe(b.h(Boolean),I.c(a.pipe(_.P()))).subscribe(this.context.hide),this.context.hasContent.pipe(b.h(Boolean),I.c(k.T(g.gw(!0,500),a.pipe(y.h(!1))).pipe(_.P())),b.h(Boolean)).subscribe(this.context.show)]},t.contextType=U.G.Context,t}(o.Component),N=function(){return o.createElement(S,null,(0,s.ls)(l.map((function(e){return o.createElement(c.t.ByAbsoluteRect,(0,a.pi)({rect:r.UL.fromEl(e.target),className:F.container},c.t.Alignment.toSelector(e.alignment),{withPin:!0}),o.createElement("div",{className:F.content},e.content))})),l.toNullable))},M={position:"fixed",zIndex:u.DY,pointerEvents:"none",$nest:{"@media print":{visibility:"hidden"}}},T={padding:"".concat(m.ux.rem(.25)," ").concat(m.ux.rem(1)),borderRadius:m.ux.rem(u.fx),background:d.Il.BackgroundTooltip,color:d.Il.CoreNeutral1,textAlign:"center",whiteSpace:"nowrap",letterSpacing:m.ux.px(.25),fontSize:m.ux.rem(.75),lineHeight:m.ux.rem(1)},F=m.ux.stylesheet({container:[M],content:[T]})},24570:(e,t,n)=>{n.r(t),n.d(t,{createReaderGmailThreadIntegration:()=>Mr});var i,a=n(17771),o=n(57050),s=n(64015),r=n(48044),l=n(45614),d=n(29511),c=n(34379),m=n(70631),u=n(38983);!function(e){e.create=function(e,t,n){return u.h.combine(e,n,t,((e,t,n)=>({threadId:e.threadId,subject:e.subject,loggedUser:e.loggedUser,messageCount:e.messageCount,messageIndexToIdMap:e.messageIndexToIdMap,expandedMessages:(0,o.zG)(e.expandedMessages,r.Su(((e,i)=>({message:(0,o.zG)(i,m.UI((e=>({id:e.id,index:e.index,author:e.context.author,audience:e.context.audience,links:e.context.links,wordCount:e.textMap.getPlainText().trim().split(/\s+/).length,date:e.context.date})))),summary:n.get(e)||(m.VZ(i)||m.IR(i)?i:m.x5),annotations:t.get(e)||(m.VZ(i)||m.IR(i)?i:m.x5)}))))})))}}(i||(i={}));var h,p,g=n(91625),f=n(27378),b=n(55415),v=n(8125),k=n(5114);!function(e){e.showContent="showContent",e.hideFilteredMessageContent="hideFilteredMessageContent",e.showFilteredMessageContent="showFilteredMessageContent"}(h||(h={})),function(e){e.overview="overview",e.coreUserJourney="coreUserJourney",e.pinning="pinning"}(p||(p={}));const y=[p.overview,p.coreUserJourney,p.pinning];function x(e){return"collapsed"===e.kind}function I(e){return"collapsed"!==e.kind}function _(e){return"messageView"===e.kind}function w(e){return"pinnedView"===e.kind}function E(e){return"onboardingView"===e.kind}function C(e){return"messageView"===e.kind&&m.d6(e.message)&&(0,o.zG)(e.summary,k.map(b.ei("data")),k.map((0,v.Kg)(m.d6,m.VZ,m.IR)),k.getOrElse(o.W8))&&(0,o.zG)(e.questions,k.map(b.ei("data")),k.map((0,v.Kg)(m.d6,m.VZ,m.IR)),k.getOrElse(o.W8))&&(0,o.zG)(e.links,k.map(b.ei("data")),k.map((0,v.Kg)(m.d6,m.VZ,m.IR)),k.getOrElse(o.W8))}var U=n(77176),S=n(5739),N=n(16027),M=n(60797),T=n(76974),F=n(61922);const A={textBoxPlaceholder:"Share your thoughts here.",textBoxAriaLabel:"Feedback text",submitButton:"Submit",cancelButton:"Close",requiredLabel:"Required"},G={onboarding:{optInButton:"Try it out",optOutButton:"No, thanks",prevIconTooltip:"Previous",nextIconTooltip:"Next",badge:"NEW",betaTermsUrl:"https://www.grammarly.com/beta-feature-terms",stepOfN:e=>`${e} OF 3`,overview:{phase0:{title:"Introducing email recaps",body:"Now Grammarly can automatically summarize key points to help you reply faster."},phase1:{title:"Introducing email recaps",body:"Now Grammarly can automatically summarize key points and follow-up actions."},phase2:{title:"Introducing email recaps",body:"Now Grammarly can automatically recap key points and help you decide whether you need to reply."},videoSrc:"https://d201kpdrh73vuz.cloudfront.net/reader/onboarding-overview.gif"},coreUserJourney:{title:"Reply faster",body:"Everything you need at your fingertips. Focus on writing, not hunting for details.",videoSrc:"https://d201kpdrh73vuz.cloudfront.net/reader/onboarding-core-user-journey.gif"},pinning:{title:"Choose what's important",body:"Pin key points and things to follow up on while you're reading.",videoSrc:"https://d201kpdrh73vuz.cloudfront.net/reader/onboarding-pinning.gif"},disclaimer:{text:"Grammarly collects data from your emails to power recaps. Learn how your information is used and protected in our %link%.",linkPlaceholder:"%link%",link:{text:"data collection policy",URL:"https://www.grammarly.com/recap"}}},expandedPanel:{viewButton:{thread:"Messages",pins:"Pinned"},goLeftIconTooltip:"Previous message",goRightIconTooltip:"Next message",jumpFirstIconTooltip:"Jump to first message",jumpLastIconTooltip:"Jump to last message",actionsButtonTooltip:"Actions",itemMenu:{copyTooltip:"Copy",pinTooltip:"Add pin",unpinTooltip:"Remove pin",dismissTooltip:"Dismiss",likeTooltip:"Helpful",dislikeTooltip:"Unhelpful",itemLikedTooltip:"This item is helpful",itemDislikedTooltip:"This item isn't helpful"},threadView:{summaries:{title:"Summary",empty:{title:"No items found",body:"Did we miss something?",CTA:"Help us improve"},filteredHidden:{title:"Content hidden",body:"Includes content from this message that you may not need.",CTA:"Show anyway"},filteredShown:{title:"Showing content from this message that you may not need."}},followUps:{title:"Follow-ups",empty:{title:"No follow-ups found",body:"Did we miss something?",CTA:"Help us improve"},filteredHidden:{title:"Content hidden",body:"Includes follow-ups from this message that you may not need.",CTA:"Show anyway"},filteredShown:{title:"Showing follow-ups from this message that you may not need."}},links:{title:"Links and attachments",empty:{title:"No links or attachments found",body:"Did we miss something?",CTA:"Help us improve"},filteredHidden:{title:"Content hidden",body:"Includes links and attachments from this message that you may not need.",CTA:"Show anyway"},filteredShown:{title:"Showing links and attachments from this message that you may not need."}}},pinnedView:{summaries:{title:"Summary",empty:{title:"Nothing pinned yet",body:"Pin important summary items to find them more easily.",CTA:"Return to Messages tab"}},followUps:{title:"Follow-ups",empty:{title:"Nothing pinned yet",body:"Pin follow-ups to find them more easily.",CTA:"Return to Messages tab"}},links:{title:"Links and attachments",empty:{title:"Nothing pinned yet",body:"Pin links and attachments to find them more easily",CTA:"Return to Messages tab"}}}},collapseIconTooltip:"Hide email recap",collapsedNothingToRecap:"Nothing to recap",expandIconTooltip:"Open email recap",recapExpandTooltip:"Open email recap",recapCollapseTooltip:"Hide email recap",sendFeedbackButton:"Send feedback",genericFeedbackDialog:{...A,ratings:["It's not helpful","It could be better","It's okay","It's pretty helpful","It's great"],title:"Is Grammarly Recap helpful?"},tellsUsMoreFeedbackDialog:{...A,cancelButton:"Skip",title:"Tell us more",description:"We'd love to hear what's going well and how we can improve."},notifications:{thankYou:"Thank you for your feedback"},enableInlineHighlights:"Show highlight",disableInlineHighlights:"Hide highlight",inlineOnboarding:{highlight:{title:"Find the key points faster",content:"Important sentences have been highlighted so you can read and act on email more quickly",next:"Next",close:"Close"},highlightsSwitch:{title:"Hide email highlights",content:"You can turn highlights off when you don't need them",next:"Next",close:"Close"},panelSwitch:{title:"View full recap",content:"Expand the panel to view email summaries, handy follow-up checklists, and more",next:"Got it"}}};var L,O,z,K,P,R,H,B,D=n(85985),V=n(22232);!function(e){e.first="first",e.last="last",e.left="left",e.right="right"}(L||(L={})),function(e){e.left="left",e.right="right"}(O||(O={})),function(e){e.onboardingPanel="onboardingPanel",e.readerPanel="readerPanel"}(z||(z={})),function(e){e.collapseButton="collapseButton",e.recapButton="recapButton"}(K||(K={})),function(e){e.expandButton="expandButton",e.recapButton="recapButton",e.replyButton="replyButton"}(P||(P={})),function(e){e.messagesButton="messagesButton",e.emptyPinnedSummaries="emptyPinnedSummaries",e.emptyPinnedFollowUps="emptyPinnedFollowUps",e.emptyPinnedLinks="emptyPinnedLinks"}(R||(R={})),function(e){let t;!function(e){e.panelMounted="panelMounted",e.collapse="collapse",e.expand="expand",e.threadViewNavigate="threadViewNavigate",e.onboardingViewNavigate="onboardingViewNavigate",e.openPinnedView="openPinnedView",e.openMessageView="openMessageView",e.optIn="optIn",e.optOut="optOut",e.closeNotification="closeNotification",e.submitFeedback="submitFeedback",e.skipFeedback="skipFeedback",e.closeFeedback="closeFeedback",e.openFeedback="openFeedback",e.columnScroll="columnScroll",e.itemBlur="itemBlur",e.itemMounted="itemMounted",e.openItemMenu="openItemMenu",e.linkClick="linkClick",e.check="check",e.pin="pin",e.copy="copy",e.dismiss="dismiss",e.like="like",e.dislike="dislike",e.toggleInlineHighlights="toggleInlineHighlights",e.seenInlineHighlightsOnboarding="seenInlineHighlightsOnboarding",e.setInlineHighlightsOnboardingStep="setInlineHighlightsOnboardingStep",e.inlineHighlightOnboardingElementMounted="inlineHighlightOnboardingElementMounted",e.showFilteredContent="showFilteredContent"}(t=e.Kind||(e.Kind={})),e.matchSubmitFeedback=function(e){return t=>{switch(t.source.kind){case"collapsedPanelButton":return e.collapsedPanelButton(t);case"expandedPanelHeaderButton":return e.expandedPanelHeaderButton(t);case"emptySummaryViewButton":case"emptyFollowUpsViewButton":case"emptyLinksViewButton":return e.emptyViewButton(t);case"itemPanelMenu":return e.itemMenu(t);default:(0,V.vE)(t.source)}}},e.itemTypeIs=function(e){return t=>t.itemType===e},e.is=function(e){return t=>t.kind===e}}(H||(H={})),function(e){e.ofType=function(e){return D.h(H.is(e))}}(B||(B={}));var Z=n(64757),j=n(76168);const q=N.UI.Grid.make((({slots:e,notify:t})=>f.createElement(S.F.div,{className:j.notification},e.icon,e.content,f.createElement(Z.zx.Ghost,{name:"close-notification",onClick:t({kind:H.Kind.closeNotification})},f.createElement(F.JO.Close,null))))),W=N.UI.Knot.make(q,{icon:N.UI.Node.make((()=>f.createElement(F.JO.NotificationInfo,null))),content:N.UI.Node.make((()=>f.createElement("span",null,G.notifications.thankYou)))});function $(e){return t=>e.actions.next(t)}function Q(e){return N.Z.composeKnot({root:N.Z.fromSideEffect($(e),null),icon:()=>T.of(null),content:()=>T.of(null)})}const J=N.UI.Union.make("kind",{thankYou:W}),Y=N.UI.Union.asOption(J);function X(e){return N.Z.composeUnion({Some:N.Z.composeKnot({value:N.Z.composeUnion({thankYou:Q(e)},(()=>e.state.pipe(U.U((e=>e.notification)),M.oA)))}),None:()=>T.of(null)},(()=>e.state.pipe(U.U((e=>e.notification)))))}var ee=n(8965),te=n(23556),ne=n(57053),ie=n(22667),ae=n(2844),oe=n(12187),se=n(78870);const re=e=>N.UI.Grid.make((({slots:t,view:n,notify:i})=>f.createElement("div",{className:se.dialog},f.createElement("header",{className:se.header},f.createElement("div",{className:se.headerGroup},f.createElement(ie.K,{size:16}),"Help us improve"),f.createElement(S.F.Fragment,null,n("source").pipe(U.U((e=>f.createElement(Z.zx.Ghost,{onClick:i({kind:"close",source:e}),name:"feedback-dialog-close"},f.createElement(F.JO.Close,null))))))),f.createElement(S.F.Fragment,null,t.title,t.rating,t.description),f.createElement(S.F.div,{role:"textbox",...(0,oe.Sh)(se.textbox,n("formErrors").pipe(U.U((e=>e.has("textRequired")?se.requiredTextBox:void 0)))),contentEditable:!0,"aria-placeholder":e.textBoxPlaceholder,"data-placeholder":e.textBoxPlaceholder,"aria-label":e.textBoxAriaLabel,onInput:e=>i({kind:"text",text:e.target.innerText})()}),f.createElement(S.F.Fragment,null,n("formErrors").pipe(U.U((t=>t.has("textRequired")?f.createElement("span",{className:se.requiredLabel},e.requiredLabel):null)))),f.createElement("div",{className:se.buttons},f.createElement(S.F.Fragment,null,n("source").pipe(U.U((t=>f.createElement(f.Fragment,null,f.createElement(Z.zx.Primary,{onClick:i({kind:"submit",source:t}),name:"feedback-dialog-submit"},e.submitButton),f.createElement(Z.zx.Ghost,{onClick:i({kind:"skip",source:t}),name:"feedback-dialog-skip"},e.cancelButton))))))))));function le(e,t){const n=u.h.create({text:"",formErrors:new Set});return N.Z.fromSideEffect((i=>{switch(i.kind){case"text":n.modify((e=>({text:i.text,formErrors:(0,o.zG)(new Set(e.formErrors),(e=>(e.delete("textRequired"),e)))})));break;case"close":n.set({text:"",formErrors:new Set}),e.actions.next({kind:H.Kind.closeFeedback,source:i.source});break;case"skip":n.set({text:"",formErrors:new Set}),e.actions.next({kind:H.Kind.skipFeedback,source:i.source});break;case"submit":{""===n.get().text.trim()&&n.lens("formErrors").set(new Set(["textRequired"]));const a=(0,o.zG)(t,k.chain((e=>e())));0===n.get().formErrors.size&&(k.isNone(t)||k.isSome(a))&&(e.actions.next({kind:H.Kind.submitFeedback,source:i.source,text:n.get().text,scoreResult:a}),n.set({text:"",formErrors:new Set}));break}default:(0,V.vE)(i)}}),ae.aj([e.state.pipe(U.U((e=>e.feedbackDialog)),M.oA),n]).pipe(U.U((([{source:e},{formErrors:t}])=>({source:e,formErrors:t})))))}var de=n(90845),ce=n(93508),me=n(19962),ue=n(61033);const he=({onMount:e})=>f.createElement("div",{ref:e,className:ue.panelOverlay}),pe=N.UI.Grid.make((({state:e,slots:t})=>{const{ref:n,onMount:i}=de.P.useElWatcher(),a=ae.aj([e,n.pipe(U.U(k.map(me.UL.fromEl)),M.oA)]).pipe(U.U((([e,t])=>({..."bottom"===e.dialogSide?{top:e.sourceRect.bottom-t.top}:"top"===e.dialogSide?{bottom:t.bottom-e.sourceRect.bottom+e.sourceRect.height}:{},..."right"===e.alignment?{right:t.right-e.sourceRect.right}:"left"===e.alignment?{left:e.sourceRect.left-t.left}:{}}))),ce.O({}));return f.createElement(f.Fragment,null,f.createElement(he,{onMount:i}),f.createElement(S.F.div,{className:ue.dialog,style:a},t.content))}));function ge(e){return()=>e.state.pipe(U.U((e=>e.feedbackDialog)),M.oA,U.U((e=>e.position)))}var fe=n(56229);const be=N.UI.Node.make((({state:e,notify:t})=>f.createElement("div",{className:fe.rating},f.createElement(ne.i,{maxRating:G.genericFeedbackDialog.ratings.length,ratingLabels:G.genericFeedbackDialog.ratings,className:fe.ratingContainer,ratingStarsClassName:fe.ratingStars,ratingLegendClassName:fe.ratingLegend,ratingLabelsClassName:fe.ratingLabels,onChange:e=>t({score:e})(),ariaLabel:G.genericFeedbackDialog.title}),f.createElement(S.F.Fragment,null,e.pipe(U.U((e=>e?f.createElement("span",{className:fe.requiredLabel},G.genericFeedbackDialog.requiredLabel):null))))))),ve=N.UI.Knot.make(re(G.genericFeedbackDialog),{title:N.UI.Node.make((()=>f.createElement("h1",{className:fe.title},G.genericFeedbackDialog.title))),rating:be,description:N.UI.Node.empty}),ke=N.UI.Knot.make(pe,{content:ve}),ye=N.UI.Union.asOption(ke);function xe(e){const t=u.h.create({score:k.none,showRequired:!1});return N.Z.composeKnot({root:le(e,k.some((()=>(0,o.zG)(t.get().score,(e=>(k.isNone(e)&&t.lens("showRequired").set(!0),e)),k.map((e=>({score:e,label:G.genericFeedbackDialog.ratings[e]||""}))))))),title:()=>T.of(null),rating:N.Z.fromSideEffect((e=>t.set({score:k.some(e.score),showRequired:!1})),t.view("showRequired")),description:()=>T.of(null)})}function Ie(e,t){return N.Z.composeUnion({Some:N.Z.composeKnot({value:N.Z.composeKnot({root:ge(e),content:xe(e)})}),None:()=>T.of(null)},(()=>e.state.pipe(U.U((0,o.ls)(b.ei("feedbackDialog"),k.filter(t))))))}var _e=n(32952),we=n(41398),Ee=n(2834);const Ce=N.UI.Node.make((({state:e,notify:t})=>{const{ref:n,onMount:i}=de.P.useElWatcher(),a=f.useRef(new _e.xQ);return de.P.useSubscriptionTo(a.current.pipe(we.M(n),U.U((([e,t])=>k.map(me.UL.fromEl)(t))),M.oA,Ee.b((e=>t({kind:"openFeedback",buttonRect:e})())))),f.createElement(S.F.Fragment,null,e.pipe(U.U((({active:e,isSupported:t})=>t?f.createElement(Z.zx.Ghost,{mount:i,onClick:()=>a.current.next(),name:"panel-open-feedback-button",title:G.sendFeedbackButton,ariaLabel:G.sendFeedbackButton,active:e},f.createElement(F.JO.AssistantFeedback,null)):null))))}));function Ue(e,t){return N.Z.fromSideEffect((n=>{if("openFeedback"===n.kind)t?e.actions.next({kind:H.Kind.openFeedback,source:{kind:"collapsedPanelButton"},position:{sourceRect:n.buttonRect,dialogSide:"top",alignment:"right"}}):e.actions.next({kind:H.Kind.openFeedback,source:{kind:"expandedPanelHeaderButton"},position:{sourceRect:n.buttonRect,dialogSide:"bottom",alignment:"right"}});else(0,V.vE)(n.kind)}),e.state.pipe(U.U((e=>e.feedbackDialog)),U.U((n=>({active:(0,o.zG)(n,k.fold(o.jv,(({source:e})=>t?"collapsedPanelButton"===e.kind:"expandedPanelHeaderButton"===e.kind))),isSupported:e.isSubmitFeedbackDialogSupported})))))}const Se=N.UI.Grid.make((({slots:e})=>f.createElement(S.F.Fragment,null,e.button,e.dialog))),Ne=N.UI.Knot.make(Se,{button:Ce,dialog:ye});function Me(e,t,n){return N.Z.composeKnot({button:Ue(e,t),dialog:Ie(e,n)})}var Te;!function(e){e.InlineHighlightsDisabled=({className:e,width:t=24})=>f.createElement(F.a1,{className:e,width:t,viewBox:"0 0 24 24"},f.createElement("path",{d:"M6.142,16.333L3.449,19.026C3.306,19.169 3.263,19.384 3.34,19.571C3.418,19.758 3.6,19.88 3.802,19.88L7.338,19.88C7.471,19.88 7.598,19.827 7.692,19.733L8.617,18.808L11.784,18.641C11.907,18.635 12.024,18.583 12.111,18.496L20.596,10.01C21.182,9.425 21.182,8.475 20.596,7.889C20.596,7.889 17.061,4.354 17.061,4.354C16.475,3.768 15.525,3.768 14.939,4.354L7.515,11.778L6.454,12.839C6.367,12.926 6.315,13.043 6.309,13.166L6.142,16.333ZM8.222,12.485L12.465,16.728L11.54,17.653C11.54,17.653 8.595,17.808 8.595,17.808C8.595,17.808 7.142,16.355 7.142,16.355L7.297,13.41L8.222,12.485ZM13.172,16.021L8.929,11.778L15.646,5.061C15.842,4.865 16.158,4.865 16.354,5.061L19.889,8.596C20.084,8.791 20.084,9.108 19.889,9.303L13.172,16.021Z",fill:"inherit",stroke:"none"})),e.InlineHighlightsEnabled=({className:e,width:t=24})=>f.createElement(F.a1,{className:e,width:t,viewBox:"0 0 24 24"},f.createElement("path",{d:"M14.939,4.354C15.525,3.768 16.475,3.768 17.061,4.354L20.596,7.889C21.182,8.475 21.182,9.425 20.596,10.01L18.934,11.673C18.533,11.574 18.117,11.516 17.689,11.503L19.889,9.303C20.084,9.108 20.084,8.791 19.889,8.596L16.353,5.061C16.158,4.865 15.842,4.865 15.646,5.061L8.929,11.778L12.078,14.927C11.921,15.257 11.794,15.603 11.699,15.962L8.222,12.485L7.297,13.41L7.142,16.355L8.595,17.808L11.502,17.655C11.51,17.995 11.547,18.327 11.61,18.651L8.616,18.808L7.691,19.733C7.598,19.827 7.47,19.88 7.338,19.88L3.802,19.88C3.6,19.88 3.418,19.758 3.34,19.571C3.263,19.384 3.306,19.169 3.449,19.026L6.141,16.333L6.308,13.166C6.315,13.043 6.367,12.926 6.454,12.839L14.939,4.354Z",fill:"inherit",stroke:"none"}),f.createElement("path",{d:"M22,17.5C22,15.015 19.985,13 17.5,13C15.015,13 13,15.015 13,17.5C13,19.985 15.015,22 17.5,22C19.985,22 22,19.985 22,17.5ZM21,17.5C21,19.433 19.433,21 17.5,21C15.567,21 14,19.433 14,17.5C14,15.567 15.567,14 17.5,14C19.433,14 21,15.567 21,17.5Z",fill:"inherit",stroke:"none"}),f.createElement("path",{d:"M20.015,16.765C20.162,16.619 20.162,16.381 20.015,16.235C19.869,16.088 19.631,16.088 19.485,16.235L17,18.72L16.015,17.735C15.869,17.588 15.631,17.588 15.485,17.735C15.338,17.881 15.338,18.119 15.485,18.265L17,19.78L20.015,16.765Z",fill:"inherit",stroke:"none"}))}(Te||(Te={}));const Fe=N.UI.Node.make((({state:e,notify:t})=>{const{onMount:n,ref:i}=de.P.useElWatcher();return de.P.useSubscriptionTo(i.pipe(M.oA,Ee.b((e=>t({kind:"buttonMounted",node:e})())))),f.createElement(S.F.Fragment,null,e.pipe(U.U((({inlineHighlightsEnabled:e,isSupported:i})=>i?f.createElement("div",{ref:n},f.createElement(Z.zx.Ghost,{onClick:t({kind:"toggleInlineHighlights",enabled:!e}),name:"panel-toggle-highlight-button",title:e?G.disableInlineHighlights:G.enableInlineHighlights,ariaLabel:e?G.disableInlineHighlights:G.enableInlineHighlights,key:"inlineHighlightsButton"},e?f.createElement(Te.InlineHighlightsEnabled,null):f.createElement(Te.InlineHighlightsDisabled,null))):null))))}));function Ae(e){return N.Z.fromSideEffect((t=>{"toggleInlineHighlights"===t.kind?e.actions.next({kind:H.Kind.toggleInlineHighlights,enabled:t.enabled}):"buttonMounted"===t.kind?e.actions.next({kind:H.Kind.inlineHighlightOnboardingElementMounted,step:"highlightsSwitch",node:t.node}):(0,V.vE)(t)}),e.inlineHighlightsEnabled.pipe(U.U((t=>({inlineHighlightsEnabled:t,isSupported:e.areInlineHighlightsSupported})))))}var Ge=n(64908),Le=n(86705),Oe=n(53112),ze=n(58120);const Ke=({onClick:e,title:t,focusable:n,browser:i,ariaLabel:a})=>f.createElement(Z.zx.Flat,{className:ze.recapButton,onClick:e,name:"recap-button",title:t,ariaLabel:a,tabIndex:n?0:-1},f.createElement(ie.K,{size:22.4,className:ze.logo}),f.createElement(Pe,null),f.createElement(Le.v,{browser:i})),Pe=({color:e=Oe.Z.neutral70})=>f.createElement("svg",{width:"44",height:"10",viewBox:"0 0 44 10",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-label":"Recap",className:ze.recap},f.createElement("path",{d:"M0 9.54578V0.454902H3.92401C4.53474 0.441273 5.14052 0.567287 5.69515 0.823335C6.18417 1.05365 6.59476 1.42255 6.8759 1.88423C7.168 2.38768 7.31401 2.96257 7.29756 3.54439C7.31546 4.10697 7.17223 4.66295 6.88473 5.14684C6.61248 5.58484 6.21939 5.93477 5.75281 6.15448L7.5994 9.54578H4.9183L3.32033 6.5451H2.46806V9.54578H0ZM2.46804 4.62749H3.33804C3.69403 4.64717 4.04783 4.56065 4.35456 4.37891C4.48182 4.28258 4.58244 4.1554 4.6469 4.00939C4.71137 3.86337 4.73756 3.70334 4.723 3.54439C4.73683 3.38295 4.71041 3.22059 4.64612 3.07185C4.58182 2.92312 4.48164 2.79264 4.35456 2.69212C4.05216 2.49864 3.69646 2.40545 3.33804 2.42578H2.46804V4.62749Z",fill:e}),f.createElement("path",{d:"M8.85059 9.5458V0.454918H15.4024V2.44356H11.3187V4.00606H15.0651V5.99469H11.3187V7.55719H15.3847V9.5458H8.85059Z",fill:e}),f.createElement("path",{d:"M25.1719 3.86399H22.6684C22.6488 3.48459 22.4872 3.12646 22.2156 2.8608C22.0648 2.72733 21.8892 2.6249 21.6988 2.5594C21.5084 2.49389 21.3069 2.46658 21.1059 2.47905C20.8315 2.46406 20.5576 2.51745 20.3089 2.63444C20.0602 2.75143 19.8445 2.92836 19.681 3.14933C19.3227 3.69763 19.15 4.34649 19.1883 5.00036C19.1409 5.66688 19.3157 6.33031 19.6854 6.8869C19.8521 7.09645 20.0662 7.26331 20.3101 7.37369C20.5541 7.48407 20.8208 7.53479 21.0882 7.52167C21.4779 7.542 21.862 7.42235 22.1713 7.18431C22.4451 6.94828 22.6221 6.61948 22.6684 6.26097L25.1719 6.27873C25.1359 6.68719 25.0261 7.08574 24.8479 7.45505C24.4293 8.33025 23.6927 9.01287 22.7883 9.36375C22.1411 9.60001 21.4525 9.70142 20.7647 9.66174C20.0769 9.62206 19.4045 9.44212 18.7888 9.133C18.1238 8.76993 17.5792 8.22072 17.2218 7.5527C16.8183 6.76399 16.6213 5.88584 16.6493 5.00033C16.62 4.11171 16.8219 3.23071 17.2352 2.44351C17.5977 1.77593 18.1468 1.22837 18.8154 0.867676C19.4982 0.504684 20.2616 0.319939 21.0348 0.330567C21.7374 0.318011 22.4343 0.458893 23.0768 0.743384C23.6602 1.00422 24.1608 1.42034 24.5238 1.94633C24.906 2.51684 25.1296 3.17864 25.1719 3.86399Z",fill:e}),f.createElement("path",{d:"M28.3137 9.5458H25.6504L28.6511 0.454918H32.0246L35.0254 9.5458H32.3621L31.8382 7.8058H28.8375L28.3137 9.5458ZM29.3968 5.95918H31.2789L30.3734 2.95847H30.3024L29.3968 5.95918Z",fill:e}),f.createElement("path",{d:"M36.2773 9.54575V0.454869H40.2013C40.8155 0.440928 41.4237 0.578119 41.9724 0.854376C42.4653 1.10813 42.8751 1.49788 43.1532 1.97742C43.4429 2.49314 43.5886 3.07729 43.5749 3.66865C43.5901 4.26188 43.4394 4.84758 43.1399 5.35988C42.852 5.83714 42.4307 6.21979 41.9281 6.46071C41.3612 6.72892 40.7395 6.86116 40.1125 6.8469H38.7453V9.54573L36.2773 9.54575ZM38.7453 4.9293H39.6153C39.9848 4.95083 40.3486 4.83012 40.6319 4.59194C40.7558 4.47337 40.8528 4.32958 40.9164 4.1703C40.9799 4.01102 41.0086 3.83995 41.0003 3.66865C41.0097 3.49854 40.9816 3.32845 40.9179 3.17043C40.8542 3.0124 40.7566 2.87032 40.6319 2.75423C40.3461 2.52145 39.9833 2.40425 39.6153 2.42575H38.7453V4.9293Z",fill:e})),Re=N.UI.Grid.make((({state:e,slots:t,notify:n})=>(de.P.useEffectOnDidMount(n("panelMounted")),f.createElement(S.F.div,{className:Ge.panelGrid},f.createElement(S.F.div,{className:Ge.header},e.pipe(U.U((({expanded:e,browser:t,focusable:i})=>f.createElement(Ke,{onClick:n(e?"collapse":"expand"),title:e?G.recapCollapseTooltip:G.recapExpandTooltip,ariaLabel:e?G.recapCollapseTooltip:G.recapExpandTooltip,browser:t,focusable:i})))),t.header,f.createElement(S.F.div,{className:Ge.toolbar},t.toolbar)),t.content))));function He(e){return N.Z.fromSideEffect((t=>{switch(t){case"collapse":e.actions.next({kind:H.Kind.collapse,source:K.recapButton});break;case"expand":e.actions.next({kind:H.Kind.expand,source:P.recapButton});break;case"panelMounted":e.actions.next({kind:H.Kind.panelMounted,subject:z.readerPanel});break;default:(0,V.vE)(t)}}),e.state.pipe(U.U((t=>({expanded:I(t),browser:e.browser,focusable:k.isNone(t.feedbackDialog)})))))}const Be=N.UI.Node.make((({state:e,notify:t})=>{const{onMount:n,ref:i}=de.P.useElWatcher();return de.P.useSubscriptionTo(i.pipe(M.oA,Ee.b((e=>t({kind:"buttonMounted",node:e})())))),f.createElement(S.F.Fragment,null,e.pipe(U.U((({expanded:e,focusable:i})=>f.createElement("div",{ref:n},f.createElement(Z.zx.Ghost,{onClick:t(e?{kind:"buttonClicked",state:"collapse"}:{kind:"buttonClicked",state:"expand"}),name:"toggle-panel-button",title:e?G.collapseIconTooltip:G.expandIconTooltip,ariaLabel:e?G.collapseIconTooltip:G.expandIconTooltip,tabIndex:i?0:-1},f.createElement(F.JO.Arrow,{direction:e?F.n4.up:F.n4.down})))))))}));function De(e){return N.Z.fromSideEffect((t=>{if("buttonClicked"===t.kind)switch(t.state){case"expand":e.actions.next({kind:H.Kind.expand,source:P.expandButton});break;case"collapse":e.actions.next({kind:H.Kind.collapse,source:K.collapseButton});break;default:(0,V.vE)(t.state)}else"buttonMounted"===t.kind?e.actions.next({kind:H.Kind.inlineHighlightOnboardingElementMounted,step:"panelSwitch",node:t.node}):(0,V.vE)(t)}),e.state.pipe(U.U((e=>({expanded:I(e),focusable:k.isNone(e.feedbackDialog)})))))}const Ve=N.UI.Grid.make((({slots:e})=>f.createElement(S.F.Fragment,null,e.toggleInlineHighlights,e.feedback,e.togglePanel))),Ze=N.UI.Knot.make(Ve,{feedback:Ne,togglePanel:Be,toggleInlineHighlights:Fe}),je=N.UI.Union.make("kind",{loaded:Ze,loading:N.UI.Node.make((()=>f.createElement(ee.$,{variation:"blue",size:18,strokeWidth:3,wrapperClassName:te.spinner})))}),qe=N.UI.Node.make((({view:e})=>f.createElement(S.F.div,{className:te.header},e("nothingToRecap").pipe(U.U((0,v.RN)(f.createElement("div",{className:te.nothingToRecap},G.collapsedNothingToRecap),f.createElement(f.Fragment,null))))))),We=N.UI.Knot.make(Re,{header:qe,toolbar:je,content:N.UI.Node.empty});function $e(e){return N.Z.composeKnot({root:He(e),header:()=>e.state.pipe(D.h(x)),toolbar:N.Z.composeUnion({loaded:N.Z.composeKnot({feedback:Me(e,!0,(e=>"collapsedPanelButton"===e.source.kind)),togglePanel:De(e),toggleInlineHighlights:Ae(e)}),loading:()=>T.of(null)},(()=>e.state.pipe(D.h(x),U.U((e=>({kind:e.loading?"loading":"loaded"})))))),content:()=>T.of(null)})}var Qe=n(49708),Je=n(83771);const Ye=(0,oe.xb)((({children:e})=>f.createElement("h6",{className:Je.sectionTitle},e))),Xe=e=>N.UI.Grid.make((({slots:t,notify:n})=>{const{onMount:i,ref:a}=de.P.useElWatcher();return de.P.useSubscriptionTo(a.pipe(M.cp((e=>Qe.R(e,"scroll"))),Ee.b(n("scroll")))),f.createElement("div",{className:Je.column,style:{flex:e}},f.createElement("div",{className:Je.scrollView,ref:i},f.createElement(Ye,null,t.title),t.content))})),et=N.UI.Grid.make((({slots:e})=>f.createElement(S.F.div,{className:Je.layout},e.summary,e.questions,e.links))),tt=350,nt=307,it=266;var at=n(26328),ot=n(62337),st=n(19429),rt=n(28043),lt=n(66310);const dt={URI:"Observable",map:(e,t)=>e.pipe(U.U(t)),ap:(e,t)=>ae.aj([e,t]).pipe(U.U((([e,t])=>e(t)))),of:e=>T.of(e)};function ct(e,t,n){return st.VF((i=>(0,o.zG)(t(i),rt.x(),lt.w((t=>n.traverseWithIndex(dt)(t,((t,n)=>e(n,t)(i.pipe(D.h((e=>e.key===t)),U.U((e=>e.action)))))))),rt.x())))}var mt=n(99094),ut=n(23063),ht=n(93253);function pt(){return N.UI.Grid.make((({state:e,view:t,slots:n,notify:i})=>{const{ref:a,onMount:s}=de.P.useElWatcher(),r=f.useRef(new _e.xQ),l=f.useRef(u.h.create(!1));return f.useEffect((()=>{const e=t("item").pipe(ut.q(1)).subscribe((e=>i({kind:"show",item:e})()));return()=>e.unsubscribe()}),[]),de.P.useSubscriptionTo(r.current.pipe(we.M(a),U.U((([e,t])=>(0,o.zG)(t,k.map((t=>{let n=0,i=0;const a=t.offsetParent;let o=t;for(;o&&o!==a;)n+=o.scrollTop,i+=o.scrollLeft,o=o.parentElement;return{item:e,top:t.offsetTop-n,left:t.offsetLeft+t.offsetWidth-i,width:t.offsetWidth,height:t.offsetHeight}}))))),M.oA,U.U((({item:e,top:t,left:n,width:a,height:o})=>i({kind:"openMenu",item:e,itemRect:ot.Wm.create({top:t,left:n,width:a,height:o})})())))),f.createElement(S.F.li,{...(0,oe.Sh)(ht.item,e.pipe(U.U((e=>e.item.pinned)),U.U((0,v.RN)(ht.pinned,void 0)))),mount:s,tabIndex:t("focusable").pipe(U.U((e=>e?0:-1))),onFocus:t("item").pipe(U.U((e=>()=>{requestAnimationFrame((()=>{i({kind:"focus",item:e})()}))}))),onBlur:t("item").pipe(U.U((e=>t=>{const n=t.currentTarget;requestAnimationFrame((()=>{var t,a;n.contains(document.activeElement)||n.contains((null===(a=null===(t=document.activeElement)||void 0===t?void 0:t.shadowRoot)||void 0===a?void 0:a.activeElement)||null)||i({kind:"blur",item:e})()}))}))),onKeyDown:e=>{var t,n;"ArrowDown"===e.key&&(null===(t=e.currentTarget)||void 0===t?void 0:t.nextElementSibling)instanceof HTMLElement?e.currentTarget.nextElementSibling.focus():"ArrowUp"===e.key&&(null===(n=e.currentTarget)||void 0===n?void 0:n.previousElementSibling)instanceof HTMLElement&&e.currentTarget.previousElementSibling.focus()},onMouseLeave:()=>{l.current.set(!1)},onMouseOver:()=>{l.current.set(!0)}},f.createElement("label",{className:ht.content},n.title,f.createElement(mt.f.Context.Provider,{value:{hovered:l.current}},n.item)),f.createElement(S.F.div,{className:ht.moreButton},e.pipe(U.U((e=>f.createElement(Z.zx.Ghost,{title:G.expandedPanel.actionsButtonTooltip,tabIndex:e.focusable?0:-1,onClick:()=>r.current.next(e.item),ariaLabel:"Actions",name:"actions-button"},f.createElement(F.JO.EllipsisSmall,{className:ht.ellipsis})))))),n.menu,n.feedback)}))}function gt(e,t,n,i,a){return o=>{switch(o.kind){case"show":a(o.item);break;case"focus":t.set(i(o.item));break;case"blur":e.actions.next({kind:H.Kind.itemBlur});break;case"openMenu":e.actions.next({kind:H.Kind.openItemMenu,itemId:i(o.item)}),n.set(k.some(o.itemRect)),t.set(i(o.item));break;default:(0,V.vE)(o)}}}function ft(e,t,n,i){return(n===e||null===n&&0===t)&&k.isNone(i)}var bt,vt=n(81336),kt=n(83078),yt=n(67465);function xt(){return N.UI.Node.make((({view:e,state:t,notify:n})=>{const{ref:i,onMount:a}=de.P.useElWatcher(),s=f.useRef(new _e.xQ);return de.P.useSubscriptionTo(s.current.pipe(we.M(i),U.U((([e,t])=>(0,o.zG)(t,k.map(me.UL.fromEl),k.map((t=>({...e,buttonRect:t})))))),M.oA,Ee.b((e=>n(e)())))),f.createElement(S.F.div,{mount:a,...(0,oe.Sh)(yt.menu,e("item").pipe(U.U((e=>e.pinned?yt.pinned:void 0)))),style:e("bottomRightCorner").pipe(U.U(k.fold((()=>({display:"none"})),(e=>({...e,display:"flex"})))))},t.pipe(U.U((({item:e,clipboardSupported:t,feedbackDialogActive:i,feedbackSupported:a})=>{const r=e.rating===vt.DE.liked||(0,o.zG)(i,kt.FX("like")),l=e.rating===vt.DE.disliked||(0,o.zG)(i,kt.FX("dislike"));return f.createElement(f.Fragment,null,t?f.createElement(Z.zx.Flat,{name:"copy-button",title:G.expandedPanel.itemMenu.copyTooltip,ariaLabel:G.expandedPanel.itemMenu.copyTooltip,className:yt.button,onClick:n({kind:"copy",item:e})},f.createElement(F.JO.Copy,null)):null,f.createElement(Z.zx.Flat,{name:"pin-button",title:e.pinned?G.expandedPanel.itemMenu.unpinTooltip:G.expandedPanel.itemMenu.pinTooltip,ariaLabel:e.pinned?G.expandedPanel.itemMenu.unpinTooltip:G.expandedPanel.itemMenu.pinTooltip,className:yt.button,onClick:n({kind:"pin",item:e,pinned:!e.pinned}),active:e.pinned},f.createElement(F.JO.Pin,null)),f.createElement(Z.zx.Flat,{name:"remove-button",title:G.expandedPanel.itemMenu.dismissTooltip,ariaLabel:G.expandedPanel.itemMenu.dismissTooltip,className:yt.button,onClick:n({kind:"dismiss",item:e})},f.createElement(F.JO.Ignore,null)),a?f.createElement(f.Fragment,null,f.createElement("div",{className:yt.separator}),k.isSome(i)||void 0===e.rating?f.createElement(f.Fragment,null,f.createElement(Z.zx.Flat,{name:"dislike-button",title:G.expandedPanel.itemMenu.dislikeTooltip,ariaLabel:G.expandedPanel.itemMenu.dislikeTooltip,className:yt.button,onClick:()=>s.current.next({kind:"dislike",item:e}),active:l},l?f.createElement(bt.ThumbsDownFilled,null):f.createElement(bt.ThumbsDown,null)),f.createElement(Z.zx.Flat,{name:"like-button",title:G.expandedPanel.itemMenu.likeTooltip,ariaLabel:G.expandedPanel.itemMenu.likeTooltip,className:yt.button,onClick:()=>s.current.next({kind:"like",item:e}),active:r},r?f.createElement(bt.ThumbsUpFilled,null):f.createElement(bt.ThumbsUp,null))):r?f.createElement(bt.ThumbsUpFilled,{className:yt.inactiveIcon}):l?f.createElement(bt.ThumbsDownFilled,{className:yt.inactiveIcon}):null):null)}))))}))}function It(e,t={dialogSide:"top",alignment:"right"}){return n=>{switch(n.kind){case"copy":e.copy(n.item);break;case"dismiss":e.dismiss(n.item);break;case"pin":e.pin(n.item,n.pinned);break;case"like":e.like(n.item,{sourceRect:n.buttonRect,...t});break;case"dislike":e.dislike(n.item,{sourceRect:n.buttonRect,...t});break;default:(0,V.vE)(n)}}}function _t(e,t,n,i){return k.toNullable(t)===e||(0,o.zG)(n,k.exists(i(e)))}!function(e){e.ThumbsDown=({className:e,width:t=18})=>f.createElement(F.a1,{className:e,width:t,viewBox:"-1 -1 22 20"},f.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.94506 1.49087L3.94129 1.49999L1.22638 7.89292C1.06797 8.31105 1.03966 8.85929 1.01631 9.57841L1.01618 9.58249C1.01167 9.72126 1.00697 9.8662 1.00031 10.0091C1.00591 10.1675 1.08822 10.3603 1.28344 10.5353C1.48809 10.7188 1.74942 10.8182 1.97538 10.8182H8.88923L7.78363 16.1831C7.74404 16.3671 7.78727 16.6111 7.90957 16.807C7.92806 16.8367 7.94592 16.8618 7.96283 16.883C7.97026 16.8765 7.97776 16.87 7.98532 16.8633C8.08412 16.7763 8.18009 16.6875 8.25236 16.6196C8.28819 16.5859 8.31747 16.558 8.33751 16.5387L8.36015 16.5169L8.36114 16.516L13.3603 11.4772C13.5028 11.3373 13.5926 11.1398 13.5926 10.9091V1.81818C13.5926 1.57101 13.483 1.34726 13.3061 1.1944C13.1632 1.07085 12.9836 1 12.7901 1H4.67906C4.66798 1 4.6565 1.00023 4.64528 1.00068M9.06411 17.2273C9.06411 17.2273 8.27026 18 8.10374 18C7.25484 18 6.60509 16.9062 6.80597 15.9727L7.66214 11.8182H1.97538C0.984023 11.8182 0 10.9917 0 9.9917C0.0070643 9.84692 0.0119094 9.6977 0.0168363 9.54596C0.039042 8.86205 0.0629075 8.12702 0.299089 7.51818L3.0208 1.10909C3.03813 1.06714 3.05698 1.02601 3.07728 0.985763C3.28437 0.575142 3.64235 0.257042 4.07809 0.102666C4.2438 0.0439576 4.42076 0.00892764 4.60495 0.00149288C4.62942 0.000509854 4.65435 0 4.67906 0H12.7901C13.2356 0 13.6447 0.165198 13.9601 0.437858C14.3466 0.771997 14.5926 1.26752 14.5926 1.81818V10.9091C14.5926 11.4091 14.3943 11.8636 14.0609 12.1909L9.06411 17.2273ZM4.64528 1.00068C4.56232 1.00405 4.48416 1.01971 4.41203 1.04526C4.22152 1.11276 4.06246 1.25304 3.97014 1.43608C3.96113 1.45395 3.95276 1.47222 3.94506 1.49087M17.3951 1V9.90909H19V1H17.3951ZM16.3951 0.75C16.3951 0.335787 16.7308 0 17.1451 0H19.25C19.6642 0 20 0.335786 20 0.75V10.1591C20 10.5733 19.6642 10.9091 19.25 10.9091H17.1451C16.7308 10.9091 16.3951 10.5733 16.3951 10.1591V0.75Z",stroke:"none"})),e.ThumbsUp=({className:e,width:t=18})=>f.createElement(F.a1,{className:e,width:t,viewBox:"-1 -1 22 20"},f.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.0549 16.5091L16.0587 16.5L18.7736 10.1071C18.932 9.68895 18.9603 9.14071 18.9837 8.42159L18.9838 8.41751C18.9883 8.27874 18.993 8.1338 18.9997 7.99095C18.9941 7.83251 18.9118 7.63967 18.7166 7.46467C18.5119 7.28121 18.2506 7.18182 18.0246 7.18182L11.1108 7.18182L12.2164 1.8169C12.256 1.63292 12.2127 1.38894 12.0904 1.19295C12.0719 1.16332 12.0541 1.13822 12.0372 1.11697C12.0297 1.12346 12.0222 1.13004 12.0147 1.13671C11.9159 1.22375 11.8199 1.31246 11.7476 1.38043C11.7118 1.41412 11.6825 1.44205 11.6625 1.46127L11.6399 1.48305L11.6389 1.48402L6.63965 6.52285C6.49717 6.66269 6.40741 6.86024 6.40741 7.09091L6.40741 16.1818C6.40741 16.429 6.51702 16.6527 6.69386 16.8056C6.83679 16.9291 7.01641 17 7.20987 17L15.3209 17C15.332 17 15.3435 16.9998 15.3547 16.9993M10.9359 0.772727C10.9359 0.772727 11.7297 -7.23009e-07 11.8963 -7.08451e-07C12.7452 -6.34238e-07 13.3949 1.09375 13.194 2.02727L12.3379 6.18182L18.0246 6.18182C19.016 6.18182 20 7.0083 20 8.0083C19.9929 8.15308 19.9881 8.3023 19.9832 8.45404C19.961 9.13795 19.9371 9.87298 19.7009 10.4818L16.9792 16.8909C16.9619 16.9329 16.943 16.974 16.9227 17.0142C16.7156 17.4249 16.3577 17.743 15.9219 17.8973C15.7562 17.956 15.5792 17.9911 15.395 17.9985C15.3706 17.9995 15.3456 18 15.3209 18L7.20987 18C6.76441 18 6.35535 17.8348 6.03991 17.5621C5.65335 17.228 5.40741 16.7325 5.40741 16.1818L5.40741 7.09091C5.40741 6.59091 5.60568 6.13636 5.93913 5.80909L10.9359 0.772727ZM15.3547 16.9993C15.4377 16.996 15.5158 16.9803 15.588 16.9547C15.7785 16.8872 15.9375 16.747 16.0299 16.5639C16.0389 16.5461 16.0472 16.5278 16.0549 16.5091M2.60495 17L2.60495 8.09091L1.00003 8.09091L1.00003 17L2.60495 17ZM3.60495 17.25C3.60495 17.6642 3.26916 18 2.85495 18L0.750031 18C0.335817 18 3.05469e-05 17.6642 3.05831e-05 17.25L3.14057e-05 7.84091C3.14419e-05 7.4267 0.335818 7.09091 0.750031 7.09091L2.85495 7.09091C3.26916 7.09091 3.60495 7.4267 3.60495 7.84091L3.60495 17.25Z",stroke:"none"})),e.ThumbsDownFilled=({className:e,width:t=18})=>f.createElement(F.a1,{className:e,width:t,viewBox:"-1 -1 22 20"},f.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.0208 1.10909C3.03813 1.06714 3.05698 1.02601 3.07728 0.985763C3.28437 0.575142 3.64235 0.257042 4.07809 0.102666C4.2438 0.0439576 4.42076 0.00892764 4.60495 0.00149288C4.62942 0.000509854 4.65435 0 4.67906 0H12.7901C13.2356 0 13.6447 0.165198 13.9601 0.437858C14.3466 0.771997 14.5926 1.26752 14.5926 1.81818V10.9091C14.5926 11.4091 14.3943 11.8636 14.0609 12.1909L9.06411 17.2273C9.06411 17.2273 8.27026 18 8.10374 18C7.25484 18 6.60509 16.9062 6.80597 15.9727L7.66214 11.8182H1.97538C0.984023 11.8182 0 10.9917 0 9.9917C0.0070643 9.84692 0.0119094 9.6977 0.0168363 9.54596C0.039042 8.86205 0.0629075 8.12702 0.299089 7.51818L3.0208 1.10909Z",stroke:"none"}),f.createElement("path",{d:"M17.1451 0C16.7308 0 16.3951 0.335787 16.3951 0.75V10.1591C16.3951 10.5733 16.7308 10.9091 17.1451 10.9091H19.25C19.6642 10.9091 20 10.5733 20 10.1591V0.75C20 0.335786 19.6642 0 19.25 0H17.1451Z",stroke:"none"})),e.ThumbsUpFilled=({className:e,width:t=18})=>f.createElement(F.a1,{className:e,width:t,viewBox:"-1 -1 22 20"},f.createElement("path",{d:"M16.9792 16.8909C16.9618 16.9329 16.943 16.974 16.9227 17.0142C16.7156 17.4249 16.3576 17.743 15.9219 17.8973C15.7562 17.956 15.5792 17.9911 15.395 17.9985C15.3706 17.9995 15.3456 18 15.3209 18L7.20984 18C6.76438 18 6.35532 17.8348 6.03988 17.5621C5.65332 17.228 5.40738 16.7325 5.40738 16.1818L5.40738 7.09091C5.40738 6.59091 5.60565 6.13636 5.9391 5.80909L10.9359 0.772727C10.9359 0.772727 11.7297 0 11.8962 0C12.7451 0 13.3949 1.09375 13.194 2.02727L12.3378 6.18182L18.0246 6.18182C19.0159 6.18182 20 7.0083 20 8.0083C19.9929 8.15308 19.9881 8.3023 19.9831 8.45404C19.9609 9.13795 19.9371 9.87298 19.7009 10.4818L16.9792 16.8909Z",stroke:"none"}),f.createElement("path",{d:"M2.85492 18C3.26913 18 3.60492 17.6642 3.60492 17.25L3.60492 7.84091C3.60492 7.4267 3.26913 7.09091 2.85492 7.09091L0.750001 7.09091C0.335788 7.09091 0 7.42669 0 7.84091V17.25C0 17.6642 0.335787 18 0.75 18H2.85492Z",stroke:"none"}))}(bt||(bt={}));var wt=n(50243);const Et=({children:e})=>f.createElement(S.F.ul,{className:wt.list},e);var Ct=n(39335),Ut=n(38459);const St=N.UI.Node.make((({state:e,notify:t})=>f.createElement(S.F.Fragment,null,e.pipe(U.U((({item:e,focusable:n})=>f.createElement("a",{href:e.url,target:"_blank",rel:"noreferrer",key:Ct.createHash("superfasthash").hash(`${e.url}${e.mimeType?e.mimeType:""}`),className:Ut.linkWrapper,tabIndex:n?0:-1,onClick:t({item:e})},f.createElement("div",{className:Ut.linkAndIcon},function(e,t){switch(e){case"hyperlink":return f.createElement(F.JO.Formatting.Link,{className:Ut.icon});case"email":return f.createElement(F.JO.Attachments.Email,{className:Ut.icon});case"attachment":switch(t){case"text/plain":case"text/html":case"application/msword":case"application/vnd.apple.pages":return f.createElement(F.JO.Attachments.Document,{className:Ut.icon});case"application/vnd.ms-excel":case"application/vnd.apple.numbers":return f.createElement(F.JO.Attachments.Spreadsheet,{className:Ut.icon});case"application/vnd.ms-powerpoint":case"application/vnd.apple.keynote":return f.createElement(F.JO.Attachments.Presentation,{className:Ut.icon});case"application/pdf":return f.createElement(F.JO.Attachments.Pdf,{className:Ut.icon});case"application/zip":case"application/vnd.rar":return f.createElement(F.JO.Attachments.Archive,{className:Ut.icon});default:return t?/^image\/.+/.test(t)?f.createElement(F.JO.Attachments.Image,{className:Ut.icon}):/^video\/.+/.test(t)?f.createElement(F.JO.Attachments.Video,{className:Ut.icon}):f.createElement(F.JO.Attachments.Attachment,{className:Ut.icon}):f.createElement(F.JO.Formatting.Link,{className:Ut.icon})}default:return f.createElement(F.JO.Formatting.Link,{className:Ut.icon})}}(e.type,e.mimeType),f.createElement("span",{className:Ut.link},"hyperlink"===e.type?""!==e.name?e.name:e.url:e.name)))))))));var Nt=n(69566);const Mt=({title:e})=>f.createElement(S.F.div,{className:Nt.title},e),Tt=pt(),Ft=xt(),At=N.UI.Knot.make(Tt,{item:St,title:N.UI.Union.asOption(N.UI.Node.make((({state:e})=>f.createElement(Mt,{title:e})))),menu:Ft,feedback:N.UI.Node.empty}),Gt=N.UI.List.make(s.Bk,At),Lt=N.UI.Composite.make(N.UI.Grid.make((({slots:e})=>f.createElement(Et,null,e.links))),Gt),Ot=e=>t=>e.actions.next({kind:H.Kind.linkClick,item:t.item});function zt(e,t,n){const i=u.h.create(null),a=u.h.create(k.none),r=e.state.pipe(D.h((0,v.Kg)(w,_)),U.U((e=>e.activeMenuItemId)));return ct(((l,d)=>{const c=t.pipe(U.U((0,o.ls)(s.hX((e=>e.url===l)),s.YM)),M.oA),m=ae.aj([e.state.view("feedbackDialog"),c,i,r,a]).pipe(U.U((([e,t,n,i,a])=>({item:t,itemRect:a,menuActive:_t(l,i,k.none,(()=>()=>!1)),focusable:ft(l,d,n,e)}))),rt.x());return N.Z.composeKnot({root:N.Z.fromSideEffect(gt(e,i,a,(e=>e.url),(t=>e.actions.next({kind:H.Kind.itemMounted,itemType:"linkItem",item:t}))),m.pipe(U.U((({item:e,focusable:t})=>({item:e,focusable:t}))))),item:N.Z.fromSideEffect(Ot(e),m.pipe(U.U((({item:e,focusable:t})=>({item:e,focusable:t}))))),title:()=>c.pipe(U.U(n)),menu:N.Z.fromSideEffect(It({pin:(t,n)=>e.actions.next({kind:H.Kind.pin,pinned:n,itemType:"linkItem",item:t}),copy:t=>e.actions.next({kind:H.Kind.copy,itemType:"linkItem",item:t}),dismiss:t=>e.actions.next({kind:H.Kind.dismiss,itemType:"linkItem",item:t}),like:o.Q1,dislike:o.Q1}),m.pipe(U.U((t=>({item:t.item,bottomRightCorner:t.menuActive?(0,o.zG)(t.itemRect,k.map(ot.Wm.topLeftPoint)):k.none,clipboardSupported:e.isClipboardSupported,feedbackSupported:!1,feedbackDialogActive:k.none}))))),feedback:()=>T.of(null)})}),(()=>t.pipe(U.U(s.UI(b.ei("url"))))),s.Bk)}var Kt=n(47397);const Pt=({title:e,children:t})=>f.createElement("div",{className:Kt.empty},f.createElement(S.F.div,{className:Kt.title},e),f.createElement(S.F.div,{className:Kt.body},t));var Rt=n(45587);const Ht={lineAndAvatar:Rt.lineAndAvatar,lineAndCheckbox:Rt.lineAndCheckbox,lineOnly:Rt.lineOnly},Bt=({lineCount:e,type:t,className:n})=>f.createElement("div",{className:n},[...Array(e).keys()].map((e=>f.createElement("div",{...(0,oe.Sh)(Rt.itemLoading,Ht[t]),key:e},f.createElement("div",{className:Rt.rect}),f.createElement("div",{className:Rt.line})))));var Dt=n(25756);const Vt=N.UI.Node.make((({state:e,notify:t})=>{const{ref:n,onMount:i}=de.P.useElWatcher(),a=f.useRef(new _e.xQ);return de.P.useSubscriptionTo(a.current.pipe(we.M(n),U.U((([e,t])=>k.map(me.UL.fromEl)(t))),M.oA,Ee.b((e=>t({kind:"openFeedback",buttonRect:e})())))),f.createElement(S.F.Fragment,null,e.pipe(U.U((({isSupported:e,CTA:t,body:n})=>e?f.createElement(f.Fragment,null,n,f.createElement(Z.zx.Ghost,{className:Dt.emptyCTAButton,mount:i,onClick:()=>a.current.next(),name:"open-feedback-button"},t)):null))))}));function Zt(e,t,n,i={dialogSide:"top",alignment:"left"}){return N.Z.fromSideEffect((t=>{if("openFeedback"===t.kind)e.actions.next({kind:H.Kind.openFeedback,source:{kind:n},position:{sourceRect:t.buttonRect,...i}});else(0,V.vE)(t.kind)}),{isSupported:e.isSubmitFeedbackDialogSupported,...t})}const jt=N.UI.Grid.make((({slots:e})=>f.createElement(S.F.Fragment,null,e.button,e.dialog))),qt=N.UI.Knot.make(jt,{button:Vt,dialog:ye});function Wt(e,t,n,i){return N.Z.composeKnot({button:Zt(e,t,n,i),dialog:Ie(e,(e=>e.source.kind===n))})}const $t=N.UI.Node.make((({view:e,notify:t})=>f.createElement(Pt,{title:e("title")},e("body"),f.createElement(Z.zx.Ghost,{className:Dt.emptyCTAButton,onClick:t("show-anyway"),name:"show-anyway-button"},e("CTA"))))),Qt=N.UI.Grid.make((({view:e,slots:t})=>f.createElement(f.Fragment,null,f.createElement("div",{className:Dt.warningGroup},f.createElement(F.JO.NotificationWarning,{width:16,className:Dt.warningIcon}),f.createElement(S.F.Fragment,null,e("title"))),f.createElement(S.F.Fragment,null,t.content)))),Jt=N.UI.Union.make("viewState",{showContent:N.UI.Group.make({content:Lt}),hideFilteredMessageContent:$t,showFilteredMessageContent:N.UI.Knot.make(Qt,{content:Lt})}),Yt=N.UI.Composite.make(N.UI.Grid.make((({slots:e})=>f.createElement(Pt,{title:G.expandedPanel.threadView.links.empty.title},e.button))),qt),Xt=N.UI.Union.make("_tag",{None:Yt,Some:N.UI.Group.make({value:Jt})}),en=N.UI.Node.make((()=>f.createElement(Bt,{type:"lineAndAvatar",lineCount:2}))),tn=N.UI.Union.make("type",{InProgress:en,Fatal:Yt,Error:Yt,Success:Xt});function nn(e){const t=e.state.pipe(D.h(_),U.U((e=>e.links)),D.h(k.isSome),U.U((e=>e.value))),n=t.pipe(U.U(b.ei("data")),D.h(m.d6),U.U((e=>e.value))),i=()=>Wt(e,G.expandedPanel.threadView.links.empty,"emptyLinksViewButton",{dialogSide:"top",alignment:"right"});return N.Z.composeUnion({InProgress:()=>T.of(null),Error:i(),Fatal:i(),Success:N.Z.composeUnion({None:i(),Some:N.Z.composeKnot({value:N.Z.composeUnion({showContent:N.Z.composeKnot({content:zt(e,n,(()=>k.none))}),hideFilteredMessageContent:N.Z.fromSideEffect((t=>e.actions.next({kind:H.Kind.showFilteredContent,column:"links"})),G.expandedPanel.threadView.links.filteredHidden),showFilteredMessageContent:N.Z.composeKnot({root:()=>T.of(G.expandedPanel.threadView.links.filteredShown),content:zt(e,n,(()=>k.none))})},(()=>t.pipe(U.U((({viewState:e})=>({viewState:e}))))))})},(()=>(0,o.zG)(n,U.U(at.nI))))},(()=>t.pipe(U.U((e=>({type:e.data.type}))))))}var an,on;!function(e){function t(e){return"itemPanelMenu"===e.kind}e.isCollapsedPanelButton=function(e){return"collapsedPanelButton"===e.kind},e.isExpandedPanelHeaderButton=function(e){return"expandedPanelHeaderButton"===e.kind},e.isReaderItemMenu=t,e.isReaderSummaryItemMenu=function(e){return t(e)&&"summaryItem"===e.itemType},e.isReaderQuestionItemMenu=function(e){return t(e)&&"followUpItem"===e.itemType}}(an||(an={})),function(e){function t(e){return an.isReaderItemMenu(e.source)}e.isReaderSummaryItemMenu=function(e){return t(e)&&an.isReaderSummaryItemMenu(e.source)},e.isReaderQuestionItemMenu=function(e){return t(e)&&an.isReaderQuestionItemMenu(e.source)}}(on||(on={}));var sn=n(35115);const rn=N.UI.Knot.make(re(G.tellsUsMoreFeedbackDialog),{title:N.UI.Node.make((()=>f.createElement("h1",{className:sn.title},G.tellsUsMoreFeedbackDialog.title))),rating:N.UI.Node.empty,description:N.UI.Node.make((()=>f.createElement("p",{className:sn.description},G.tellsUsMoreFeedbackDialog.description)))}),ln=N.UI.Knot.make(pe,{content:rn}),dn=N.UI.Union.asOption(ln);function cn(e,t){return N.Z.composeUnion({Some:N.Z.composeKnot({value:N.Z.composeKnot({root:ge(e),content:N.Z.composeKnot({root:le(e,k.none),title:()=>T.of(null),rating:()=>T.of(null),description:()=>T.of(null)})})}),None:()=>T.of(null)},(()=>e.state.pipe(U.U((0,o.ls)(b.ei("feedbackDialog"),k.filter(t))))))}var mn=n(31944),un=n(11071);const hn=N.UI.Node.make((({state:e,notify:t})=>f.createElement(S.F.Fragment,null,e.pipe(U.U((({item:e,focusable:n})=>f.createElement(mn.J,{checked:e.checked,labelId:`question-item-${e.itemId}`,className:un.checkboxWrapper,checkboxClassName:un.checkbox,labelClassName:un.label,onChange:n=>t({checked:n,item:e})(),tabIndex:n?0:-1},f.createElement("div",{...(0,oe.Sh)(e.checked?un.textChecked:void 0,un.itemText)},e.text)))))))),pn=pt(),gn=xt(),fn=N.UI.Knot.make(pn,{item:hn,title:N.UI.Union.asOption(N.UI.Node.make((({state:e})=>f.createElement(Mt,{title:e})))),menu:gn,feedback:dn}),bn=(N.UI.List.make(s.Bk,fn),N.UI.Composite.make(N.UI.Grid.make((({slots:e})=>f.createElement(Et,null,e.list))),N.UI.List.make(s.Bk,fn))),vn=e=>t=>e.actions.next({kind:H.Kind.check,item:t.item,checked:t.checked}),kn=e=>t=>on.isReaderQuestionItemMenu(t)&&t.source.item.itemId===e;function yn(e,t,n){const i=u.h.create(null),a=u.h.create(k.none),r=e.state.pipe(D.h((0,v.Kg)(w,_)),U.U((e=>e.activeMenuItemId)));return ct(((l,d)=>{const c=t.pipe(U.U((0,o.ls)(s.hX((e=>e.itemId===l)),s.YM)),M.oA),m=ae.aj([e.state.view("feedbackDialog"),c,i,r,a]).pipe(U.U((([e,t,n,i,a])=>({item:t,itemRect:a,menuActive:_t(l,i,e,kn),feedbackDialogActive:(0,o.zG)(e,k.filter(kn(l)),k.map((e=>e.source.action))),focusable:ft(l,d,n,e)}))),rt.x());return N.Z.composeKnot({root:N.Z.fromSideEffect(gt(e,i,a,(e=>e.itemId),(t=>e.actions.next({kind:H.Kind.itemMounted,itemType:"followUpItem",item:t}))),m.pipe(U.U((({item:e,focusable:t})=>({item:e,focusable:t}))))),item:N.Z.fromSideEffect(vn(e),m.pipe(U.U((({item:e,focusable:t})=>({item:e,focusable:t}))))),title:()=>c.pipe(U.U(n)),menu:N.Z.fromSideEffect(It({pin:(t,n)=>e.actions.next({kind:H.Kind.pin,pinned:n,itemType:"followUpItem",item:t}),copy:t=>e.actions.next({kind:H.Kind.copy,itemType:"followUpItem",item:t}),dismiss:t=>e.actions.next({kind:H.Kind.dismiss,itemType:"followUpItem",item:t}),like:(t,n)=>e.actions.next({kind:H.Kind.like,itemType:"followUpItem",item:t,position:n}),dislike:(t,n)=>e.actions.next({kind:H.Kind.dislike,itemType:"followUpItem",item:t,position:n})}),m.pipe(U.U((t=>({item:t.item,bottomRightCorner:t.menuActive?(0,o.zG)(t.itemRect,k.map(ot.Wm.topLeftPoint)):k.none,clipboardSupported:e.isClipboardSupported,feedbackSupported:e.isSubmitFeedbackDialogSupported,feedbackDialogActive:t.feedbackDialogActive}))))),feedback:cn(e,kn(l))})}),(()=>t.pipe(U.U(s.UI(b.ei("itemId"))))),s.Bk)}const xn=N.UI.Union.make("viewState",{showContent:N.UI.Group.make({content:bn}),hideFilteredMessageContent:$t,showFilteredMessageContent:N.UI.Knot.make(Qt,{content:bn})}),In=N.UI.Composite.make(N.UI.Grid.make((({slots:e})=>f.createElement(Pt,{title:G.expandedPanel.threadView.followUps.empty.title},e.button))),qt),_n=N.UI.Union.make("_tag",{None:In,Some:N.UI.Group.make({value:xn})}),wn=N.UI.Node.make((()=>f.createElement(Bt,{type:"lineAndCheckbox",lineCount:2}))),En=N.UI.Union.make("type",{InProgress:wn,Error:In,Fatal:In,Success:_n});function Cn(e){const t=e.state.pipe(D.h(_),U.U((e=>e.questions)),D.h(k.isSome),U.U((e=>e.value))),n=t.pipe(U.U(b.ei("data")),D.h(m.d6),U.U((e=>e.value))),i=()=>Wt(e,G.expandedPanel.threadView.followUps.empty,"emptyFollowUpsViewButton");return N.Z.composeUnion({InProgress:()=>T.of(null),Error:i(),Fatal:i(),Success:N.Z.composeUnion({None:i(),Some:N.Z.composeKnot({value:N.Z.composeUnion({showContent:N.Z.composeKnot({content:yn(e,n,(()=>k.none))}),hideFilteredMessageContent:N.Z.fromSideEffect((t=>e.actions.next({kind:H.Kind.showFilteredContent,column:"followUps"})),G.expandedPanel.threadView.followUps.filteredHidden),showFilteredMessageContent:N.Z.composeKnot({root:()=>T.of(G.expandedPanel.threadView.followUps.filteredShown),content:yn(e,n,(()=>k.none))})},(()=>t.pipe(U.U((({viewState:e})=>({viewState:e}))))))})},(()=>(0,o.zG)(n,U.U(at.nI))))},(()=>t.pipe(U.U((e=>({type:e.data.type}))))))}var Un=n(83581);const Sn=pt(),Nn=xt(),Mn=N.UI.Knot.make(Sn,{item:N.UI.Node.make((({state:e})=>f.createElement(S.F.div,{className:Un.itemText},e))),title:N.UI.Union.asOption(N.UI.Node.make((({state:e})=>f.createElement(Mt,{title:e})))),menu:Nn,feedback:dn}),Tn=N.UI.List.make(s.Bk,Mn),Fn=N.UI.Composite.make(N.UI.Grid.make((({slots:e})=>f.createElement(Et,null,e.list))),Tn),An=e=>t=>on.isReaderSummaryItemMenu(t)&&t.source.item.itemId===e;function Gn(e,t,n){const i=u.h.create(null),a=u.h.create(k.none),r=e.state.pipe(D.h((0,v.Kg)(w,_)),U.U((e=>e.activeMenuItemId)));return ct(((l,d)=>{const c=t.pipe(U.U((0,o.ls)(s.hX((e=>e.itemId===l)),s.YM)),M.oA),m=ae.aj([e.state.view("feedbackDialog"),c,i,r,a]).pipe(U.U((([e,t,n,i,a])=>({item:t,itemRect:a,menuActive:_t(l,i,e,An),feedbackDialogActive:(0,o.zG)(e,k.filter(An(l)),k.map((e=>e.source.action))),focusable:ft(l,d,n,e)}))),rt.x());return N.Z.composeKnot({root:N.Z.fromSideEffect(gt(e,i,a,(e=>e.itemId),(t=>e.actions.next({kind:H.Kind.itemMounted,itemType:"summaryItem",item:t}))),m.pipe(U.U((({item:e,focusable:t})=>({item:e,focusable:t}))))),item:()=>c.pipe(U.U((e=>e.text))),title:()=>c.pipe(U.U(n)),menu:N.Z.fromSideEffect(It({pin:(t,n)=>e.actions.next({kind:H.Kind.pin,pinned:n,itemType:"summaryItem",item:t}),copy:t=>e.actions.next({kind:H.Kind.copy,itemType:"summaryItem",item:t}),dismiss:t=>e.actions.next({kind:H.Kind.dismiss,itemType:"summaryItem",item:t}),like:(t,n)=>e.actions.next({kind:H.Kind.like,itemType:"summaryItem",item:t,position:n}),dislike:(t,n)=>e.actions.next({kind:H.Kind.dislike,itemType:"summaryItem",item:t,position:n})},{dialogSide:"top",alignment:"left"}),m.pipe(U.U((t=>({item:t.item,bottomRightCorner:t.menuActive?(0,o.zG)(t.itemRect,k.map(ot.Wm.topLeftPoint)):k.none,clipboardSupported:e.isClipboardSupported,feedbackSupported:e.isSubmitFeedbackDialogSupported,feedbackDialogActive:t.feedbackDialogActive}))))),feedback:cn(e,An(l))})}),(()=>t.pipe(U.U(s.UI(b.ei("itemId"))))),s.Bk)}const Ln=N.UI.Union.make("viewState",{showContent:N.UI.Group.make({content:Fn}),hideFilteredMessageContent:$t,showFilteredMessageContent:N.UI.Knot.make(Qt,{content:Fn})}),On=N.UI.Composite.make(N.UI.Grid.make((({slots:e})=>f.createElement(Pt,{title:G.expandedPanel.threadView.summaries.empty.title},e.button))),qt),zn=N.UI.Union.make("_tag",{None:On,Some:N.UI.Group.make({value:Ln})}),Kn=N.UI.Node.make((()=>f.createElement(Bt,{className:Dt.loader,type:"lineOnly",lineCount:2}))),Pn=N.UI.Union.make("type",{InProgress:Kn,Error:On,Fatal:On,Success:zn});function Rn(e){const t=e.state.pipe(D.h(_),U.U((e=>e.summary)),D.h(k.isSome),U.U((e=>e.value))),n=t.pipe(U.U(b.ei("data")),D.h(m.d6),U.U((e=>e.value))),i=()=>Wt(e,G.expandedPanel.threadView.summaries.empty,"emptySummaryViewButton",{dialogSide:"top",alignment:"left"});return N.Z.composeUnion({InProgress:()=>T.of(null),Error:i(),Fatal:i(),Success:N.Z.composeUnion({None:i(),Some:N.Z.composeKnot({value:N.Z.composeUnion({showContent:N.Z.composeKnot({content:Gn(e,n,(()=>k.none))}),hideFilteredMessageContent:N.Z.fromSideEffect((t=>e.actions.next({kind:H.Kind.showFilteredContent,column:"summary"})),G.expandedPanel.threadView.summaries.filteredHidden),showFilteredMessageContent:N.Z.composeKnot({root:()=>T.of(G.expandedPanel.threadView.summaries.filteredShown),content:Gn(e,n,(()=>k.none))})},(()=>t.pipe(U.U((({viewState:e})=>({viewState:e}))))))})},(()=>(0,o.zG)(n,U.U(at.nI))))},(()=>t.pipe(U.U((e=>({type:e.data.type}))))))}const Hn=N.UI.Knot.make(Xe(tt),{content:Pn,title:N.UI.Node.make((()=>f.createElement("span",null,G.expandedPanel.threadView.summaries.title)))}),Bn=N.UI.Knot.make(Xe(nt),{content:En,title:N.UI.Node.make((()=>f.createElement("span",null,G.expandedPanel.threadView.followUps.title)))}),Dn=N.UI.Knot.make(Xe(it),{content:tn,title:N.UI.Node.make((()=>f.createElement("span",null,G.expandedPanel.threadView.links.title)))}),Vn=N.UI.Union.asOption(Hn),Zn=N.UI.Union.asOption(Bn),jn=N.UI.Union.asOption(Dn),qn=N.UI.Knot.make(et,{summary:Vn,questions:Zn,links:jn});function Wn(e){const t=e.state.pipe(D.h(_)),n=t=>e.actions.next({kind:H.Kind.columnScroll}),i=T.of(null);return N.Z.composeKnot({summary:N.Z.composeUnion({Some:N.Z.composeKnot({value:N.Z.composeKnot({root:N.Z.fromSideEffect(n,i),content:Rn(e),title:()=>i})}),None:()=>i},(()=>t.pipe(U.U((e=>e.summary))))),questions:N.Z.composeUnion({Some:N.Z.composeKnot({value:N.Z.composeKnot({root:N.Z.fromSideEffect(n,i),content:Cn(e),title:()=>i})}),None:()=>i},(()=>t.pipe(U.U((e=>e.questions))))),links:N.Z.composeUnion({Some:N.Z.composeKnot({value:N.Z.composeKnot({root:N.Z.fromSideEffect(n,i),content:nn(e),title:()=>i})}),None:()=>i},(()=>t.pipe(U.U((e=>e.links)))))})}var $n=n(37896);function Qn(e){if("parsedDate"===e.kind){const t=new Date(e.timestamp);return`${$n.Rb[t.getMonth()]} ${t.getDate()}`}return e.date}var Jn=n(79579);const Yn=N.UI.Union.make("_tag",{None:N.UI.Node.make((({notify:e})=>f.createElement(Pt,{title:G.expandedPanel.pinnedView.links.empty.title},G.expandedPanel.pinnedView.links.empty.body,f.createElement(Z.zx.Ghost,{onClick:e("showMessages"),name:"pinned-mentions-empty-cta",className:Jn.emptyCTAButton},G.expandedPanel.pinnedView.links.empty.CTA)))),Some:N.UI.Group.make({value:Lt})});function Xn(e){const t=e.state.pipe(D.h(w),U.U((e=>e.links)),D.h(k.isSome),U.U((e=>e.value)));return N.Z.composeUnion({None:N.Z.fromSideEffect((t=>{if("showMessages"===t)e.actions.next({kind:H.Kind.openMessageView,source:R.emptyPinnedLinks});else(0,V.vE)(t)}),null),Some:N.Z.composeKnot({value:zt(e,t,(e=>(0,o.zG)(e.messagePinnedFrom,k.map((e=>{var t;return`From ${null!==(t=e.author.name)&&void 0!==t?t:e.author.email}, ${Qn(e.date)}`})))))})},(()=>(0,o.zG)(t,U.U(at.nI))))}const ei=N.UI.Union.make("_tag",{None:N.UI.Node.make((({notify:e})=>f.createElement(Pt,{title:G.expandedPanel.pinnedView.followUps.empty.title},G.expandedPanel.pinnedView.followUps.empty.body,f.createElement(Z.zx.Ghost,{onClick:e("showMessages"),name:"pinned-follow-ups-empty-cta",className:Jn.emptyCTAButton},G.expandedPanel.pinnedView.followUps.empty.CTA)))),Some:N.UI.Group.make({value:bn})});function ti(e){const t=e.state.pipe(D.h(w),U.U((e=>e.questions)),D.h(k.isSome),U.U((e=>e.value)));return N.Z.composeUnion({None:N.Z.fromSideEffect((t=>{if("showMessages"===t)e.actions.next({kind:H.Kind.openMessageView,source:R.emptyPinnedFollowUps});else(0,V.vE)(t)}),null),Some:N.Z.composeKnot({value:yn(e,t,(e=>{var t;return k.some(`From ${null!==(t=e.message.author.name)&&void 0!==t?t:e.message.author.email}, ${Qn(e.message.date)}`)}))})},(()=>(0,o.zG)(t,U.U(at.nI))))}const ni=N.UI.Union.make("_tag",{None:N.UI.Node.make((({notify:e})=>f.createElement(Pt,{title:G.expandedPanel.pinnedView.summaries.empty.title},G.expandedPanel.pinnedView.summaries.empty.body,f.createElement(Z.zx.Ghost,{onClick:e("showMessages"),name:"pinned-summary-empty-cta",className:Jn.emptyCTAButton},G.expandedPanel.pinnedView.summaries.empty.CTA)))),Some:N.UI.Group.make({value:Fn})});function ii(e){const t=e.state.pipe(D.h(w),U.U((e=>e.summaryItems)),D.h(k.isSome),U.U((e=>e.value)));return N.Z.composeUnion({None:N.Z.fromSideEffect((t=>{if("showMessages"===t)e.actions.next({kind:H.Kind.openMessageView,source:R.emptyPinnedSummaries});else(0,V.vE)(t)}),null),Some:N.Z.composeKnot({value:Gn(e,t,(e=>{var t;return k.some(`From ${null!==(t=e.message.author.name)&&void 0!==t?t:e.message.author.email}, ${Qn(e.message.date)}`)}))})},(()=>(0,o.zG)(t,U.U(at.nI))))}const ai=N.UI.Knot.make(Xe(tt),{content:ni,title:N.UI.Node.make((()=>f.createElement("span",null,G.expandedPanel.pinnedView.summaries.title)))}),oi=N.UI.Knot.make(Xe(nt),{content:ei,title:N.UI.Node.make((()=>f.createElement("span",null,G.expandedPanel.pinnedView.followUps.title)))}),si=N.UI.Knot.make(Xe(it),{content:Yn,title:N.UI.Node.make((()=>f.createElement("span",null,G.expandedPanel.pinnedView.links.title)))}),ri=N.UI.Union.asOption(ai),li=N.UI.Union.asOption(oi),di=N.UI.Union.asOption(si),ci=N.UI.Knot.make(et,{summary:ri,questions:li,links:di});function mi(e){const t=e.state.pipe(D.h(w)),n=t=>e.actions.next({kind:H.Kind.columnScroll}),i=T.of(null);return N.Z.composeKnot({summary:N.Z.composeUnion({Some:N.Z.composeKnot({value:N.Z.composeKnot({root:N.Z.fromSideEffect(n,i),content:ii(e),title:()=>i})}),None:()=>i},(()=>t.pipe(U.U((e=>e.summaryItems))))),questions:N.Z.composeUnion({Some:N.Z.composeKnot({value:N.Z.composeKnot({root:N.Z.fromSideEffect(n,i),content:ti(e),title:()=>i})}),None:()=>i},(()=>t.pipe(U.U((e=>e.questions))))),links:N.Z.composeUnion({Some:N.Z.composeKnot({value:N.Z.composeKnot({root:N.Z.fromSideEffect(n,i),content:Xn(e),title:()=>i})}),None:()=>i},(()=>t.pipe(U.U((e=>e.links)))))})}const ui=N.UI.Union.make("kind",{messageView:qn,pinnedView:ci});function hi(e){return N.Z.composeUnion({messageView:Wn(e),pinnedView:mi(e)},(()=>e.state.pipe(D.h((0,v.Kg)(w,_)),U.U((e=>({kind:e.kind}))))))}var pi=n(37903),gi=n(89739);const fi=N.UI.Node.make((({view:e})=>f.createElement("div",{className:gi.activeMailInfo},f.createElement(S.F.span,{className:gi.date},e("date").pipe(U.U(Qn))),f.createElement(S.F.span,{className:gi.author},e("author").pipe(U.U((e=>{var t;return null!==(t=e.name)&&void 0!==t?t:e.email}))))))),bi=N.UI.Node.make((()=>f.createElement("div",{className:gi.activeMailInfo},"Loading..."))),vi=N.UI.Union.make("type",{InProgress:bi,Success:fi,Fatal:N.UI.Node.make((()=>f.createElement("div",{className:gi.activeMailInfo}))),Error:N.UI.Node.make((()=>f.createElement("div",{className:gi.activeMailInfo})))});function ki(e){return N.Z.composeUnion({InProgress:()=>T.of(null),Success:()=>e.state.pipe(D.h(_),U.U((e=>e.header)),D.h(m.d6),U.U((e=>e.value))),Fatal:()=>T.of(null),Error:()=>T.of(null)},(()=>e.state.pipe(D.h(_),U.U((e=>e.header)))))}var yi=n(14692);const xi=N.UI.Knot.make(N.UI.Grid.make((({slots:e,state:t,notify:n})=>f.createElement(S.F.div,{className:yi.navigationFrame},f.createElement(S.F.div,{className:yi.buttonGroup},t.pipe(U.U((e=>f.createElement(f.Fragment,null,f.createElement(Z.zx.Ghost,{onClick:n(L.first),name:"navigate-first",disabled:!e.canGoBack,title:e.canGoBack?G.expandedPanel.jumpFirstIconTooltip:void 0,ariaLabel:e.canGoBack?G.expandedPanel.jumpFirstIconTooltip:void 0,tabIndex:e.focusable?0:-1},f.createElement(F.JO.Exit,{...(0,oe.Sh)(yi.iconJump,yi.iconGoFirst)})),f.createElement(Z.zx.Ghost,{onClick:n(L.left),name:"navigate-left",disabled:!e.canGoBack,title:e.canGoBack?G.expandedPanel.goLeftIconTooltip:void 0,ariaLabel:e.canGoBack?G.expandedPanel.goLeftIconTooltip:void 0,tabIndex:e.focusable?0:-1},f.createElement(F.JO.Arrow,{direction:F.n4.left,className:yi.icon}))))))),e.mailInfo,f.createElement(S.F.div,{className:yi.buttonGroup},t.pipe(U.U((e=>f.createElement(f.Fragment,null,f.createElement(Z.zx.Ghost,{onClick:n(L.right),name:"navigate-right",disabled:!e.canGoForward,title:e.canGoForward?G.expandedPanel.goRightIconTooltip:void 0,ariaLabel:e.canGoForward?G.expandedPanel.goRightIconTooltip:void 0,tabIndex:e.focusable?0:-1},f.createElement(F.JO.Arrow,{direction:F.n4.right,className:yi.icon})),f.createElement(Z.zx.Ghost,{onClick:n(L.last),name:"navigate-last",disabled:!e.canGoForward,title:e.canGoForward?G.expandedPanel.jumpLastIconTooltip:void 0,ariaLabel:e.canGoForward?G.expandedPanel.jumpLastIconTooltip:void 0,tabIndex:e.focusable?0:-1},f.createElement(F.JO.Exit,{className:yi.iconJump})))))))))),{mailInfo:vi});function Ii(e){return N.Z.composeKnot({root:N.Z.fromSideEffect((t=>(0,o.zG)(e.getNextActiveMessageIndex(t),kt.bw((n=>e.actions.next({kind:H.Kind.threadViewNavigate,action:t,nextIndex:n}))))),e.state.pipe(D.h(_)).pipe(U.U((e=>({...e.navigation,focusable:k.isNone(e.feedbackDialog)}))))),mailInfo:ki(e)})}var _i=n(16204);const wi=N.UI.Node.make((({state:e,notify:t})=>f.createElement(S.F.Fragment,null,e.pipe(U.U((({activeView:e,focusable:n})=>f.createElement(Z.zx.Group,{sticky:!0,className:_i.buttonGroup},f.createElement(Z.zx.White,{name:"thread-view",onClick:t("messageView"),active:"messageView"===e,className:_i.button,tabIndex:n?0:-1},G.expandedPanel.viewButton.thread),f.createElement(Z.zx.White,{name:"pinned-view",onClick:t("pinnedView"),active:"pinnedView"===e,className:_i.button,tabIndex:n?0:-1},G.expandedPanel.viewButton.pins))))))));function Ei(e){return N.Z.fromSideEffect((t=>{switch(t){case"pinnedView":e.actions.next({kind:H.Kind.openPinnedView});break;case"messageView":e.actions.next({kind:H.Kind.openMessageView,source:R.messagesButton});break;default:(0,V.vE)(t)}}),e.state.pipe(D.h((0,v.Kg)(_,w)),U.U((e=>({activeView:e.kind,focusable:k.isNone(e.feedbackDialog)})))))}const Ci=N.UI.Grid.make((({slots:e})=>f.createElement(S.F.div,{className:pi.header},e.viewButtons,e.frame))),Ui=N.UI.Union.asOption(xi),Si=N.UI.Union.asOption(wi),Ni=N.UI.Knot.make(Ci,{viewButtons:Si,frame:Ui});function Mi(e){return N.Z.composeKnot({viewButtons:N.Z.composeUnion({None:()=>T.of(null),Some:N.Z.composeKnot({value:Ei(e)})},(()=>e.state.pipe(U.U((e=>(0,v.Kg)(_,w)(e)?k.some(e):k.none))))),frame:N.Z.composeUnion({None:()=>T.of(null),Some:N.Z.composeKnot({value:Ii(e)})},(()=>e.state.pipe(U.U((e=>_(e)?k.some(e):k.none)))))})}const Ti=N.UI.Knot.make(Re,{header:Ni,toolbar:Ze,content:ui});function Fi(e){return N.Z.composeKnot({root:He(e),header:Mi(e),toolbar:N.Z.composeKnot({feedback:Me(e,!1,(e=>"expandedPanelHeaderButton"===e.source.kind)),togglePanel:De(e),toggleInlineHighlights:Ae(e)}),content:hi(e)})}var Ai=n(86885),Gi=n(40349);const Li=N.UI.Node.make((({state:e,notify:t})=>f.createElement("div",{className:Gi.controls},f.createElement("div",{className:Gi.onboardingButtonGroup},f.createElement(Z.zx.Primary,{name:"try-it-out-button",onClick:t("optIn"),className:Gi.optInButton},G.onboarding.optInButton),f.createElement(Z.zx.Flat,{name:"no-thanks-button",onClick:t("optOut"),className:Gi.optOutButton},G.onboarding.optOutButton)),f.createElement(S.F.div,{className:Gi.navigation},e.pipe(U.U((e=>f.createElement(f.Fragment,null,f.createElement(Z.zx.Flat,{name:"left-button",onClick:t(O.left),disabled:y[0]===e,className:Gi.leftButton,title:G.onboarding.prevIconTooltip,ariaLabel:G.onboarding.prevIconTooltip},f.createElement(F.JO.Arrow,{direction:F.n4.left,width:12})),f.createElement(Z.zx.Flat,{name:"right-button",onClick:t(O.right),disabled:y[y.length-1]===e,className:Gi.rightButton,title:G.onboarding.nextIconTooltip,ariaLabel:G.onboarding.nextIconTooltip},f.createElement(F.JO.Arrow,{direction:F.n4.right,width:12,className:Gi.arrowRight})),f.createElement("div",{className:Gi.stepOfN},G.onboarding.stepOfN(y.indexOf(e)+1))))))))));var Oi=n(86564);const zi=N.UI.Node.make((()=>{const e=G.onboarding.disclaimer.text.split(G.onboarding.disclaimer.linkPlaceholder);return f.createElement("div",{className:Oi.disclaimer},e.map(((e,t,n)=>f.createElement(f.Fragment,null,e,t<n.length-1?f.createElement("a",{target:"_blank",rel:"noreferrer",href:G.onboarding.disclaimer.link.URL},G.onboarding.disclaimer.link.text):null))))}));var Ki=n(57391);const Pi=N.UI.Node.make((({state:e})=>f.createElement(f.Fragment,null,f.createElement("link",{rel:"preload",as:"image",href:G.onboarding.overview.videoSrc}),f.createElement("link",{rel:"preload",as:"image",href:G.onboarding.coreUserJourney.videoSrc}),f.createElement("link",{rel:"preload",as:"image",href:G.onboarding.pinning.videoSrc}),f.createElement(S.F.Fragment,null,e.pipe(U.U((e=>f.createElement("img",{src:G.onboarding[e].videoSrc,key:e,className:Ki.illustration}))))))));var Ri=n(51869),Hi=n(19230);const Bi=({title:e,children:t})=>f.createElement(f.Fragment,null,f.createElement("div",{className:Hi.title},e),f.createElement("div",{className:Hi.body},t)),Di=({features:e,browser:t})=>{const n=e=>f.createElement(f.Fragment,null,e,f.createElement(Le.v,{browser:t,title:f.createElement("a",{href:G.onboarding.betaTermsUrl,target:"_blank",rel:"noreferrer"},"BETA")}));return e.has("followUps")&&e.has("links")?f.createElement(Bi,{title:n(G.onboarding.overview.phase2.title)},G.onboarding.overview.phase2.body):e.has("followUps")?f.createElement(Bi,{title:n(G.onboarding.overview.phase1.title)},G.onboarding.overview.phase1.body):f.createElement(Bi,{title:n(G.onboarding.overview.phase0.title)},G.onboarding.overview.phase0.body)},Vi=()=>f.createElement(Bi,{title:G.onboarding.coreUserJourney.title},G.onboarding.coreUserJourney.body),Zi=()=>f.createElement(Bi,{title:G.onboarding.pinning.title},G.onboarding.pinning.body),ji=N.UI.Node.make((({state:e})=>f.createElement(S.F.Fragment,null,e.pipe(U.U((e=>{switch(e.step){case p.overview:return f.createElement(Di,{key:"step-overview",features:e.features,browser:e.browser});case p.coreUserJourney:return f.createElement(Vi,{key:"step-core-user-journey"});case p.pinning:return f.createElement(Zi,{key:"step-pinning"});default:(0,V.vE)(e.step)}})))))),qi=({onShow:e,children:t})=>(de.P.useEffectOnDidMount(e),f.createElement("div",{className:Ri.onboarding},t)),Wi=N.UI.Grid.make((({slots:e,notify:t})=>f.createElement(qi,{onShow:t("panelMounted")},f.createElement(S.F.div,null,e.illustrations),f.createElement(ie.K,{size:22.4,className:Ri.logo}),f.createElement("div",{className:Ri.content,"data-grammarly-part":"reader-onboarding-content"},f.createElement("div",{className:Ri.badge},G.onboarding.badge),f.createElement(S.F.div,{className:Ri.steps},e.steps),f.createElement(S.F.div,null,e.controls),f.createElement(S.F.div,null,e.disclaimer))))),$i=N.UI.Knot.make(Wi,{steps:ji,illustrations:Pi,controls:Li,disclaimer:zi});function Qi(e){return N.Z.fromSideEffect((t=>{const n=t.action;switch(n){case"optIn":e.actions.next({kind:H.Kind.optIn});break;case"optOut":e.actions.next({kind:H.Kind.optOut});break;case O.left:case O.right:e.actions.next({kind:H.Kind.onboardingViewNavigate,action:n});break;case"panelMounted":e.actions.next({kind:H.Kind.panelMounted,subject:z.onboardingPanel});break;default:(0,V.vE)(n)}}),e.state.pipe(D.h(E),U.U((t=>({steps:{step:y[t.step],features:t.features,browser:e.browser},illustrations:y[t.step],controls:y[t.step]})))))}var Ji=n(35300);const Yi=N.UI.Grid.make((({slots:e})=>f.createElement("div",{className:Ji.onboarding,"data-grammarly-part":"reader-onboarding"},f.createElement(S.F.Fragment,null,e.content),f.createElement(S.F.div,{className:Ji.toolbar},e.toolbar)))),Xi=N.UI.Knot.make(Yi,{content:$i,toolbar:Be});function ea(e){return N.Z.composeKnot({toolbar:De(e),content:Qi(e)})}const ta=N.UI.Union.make("kind",{collapsed:We,expanded:Ti,onboarding:Xi}),na=N.UI.Knot.make(N.UI.Grid.make((({slots:e})=>f.createElement(S.F.div,{className:Ai.panelWrapper,"data-grammarly-part":"reader-panel"},e.content,e.notification))),{content:ta,notification:Y});var ia,aa=n(2005),oa=n(77821);!function(e){const t=f.createElement("svg",{viewBox:"0 0 40 48",fill:"none",className:oa["highlightsOnboarding-icon"]},f.createElement("g",null,f.createElement("path",{d:"M28.6883 4.0469C29.4694 3.26586 30.7357 3.26586 31.5168 4.0469L38.7017 11.2318C39.4827 12.0129 39.4827 13.2792 38.7017 14.0602L20.2171 32.5447L10.2038 22.5314L28.6883 4.0469Z",fill:"#79A8F2",stroke:"#0E101A"}),f.createElement("path",{d:"M8.49338 24.2418C8.19961 24.5356 8.00462 24.9136 7.93548 25.3232L6.80716 32.0092L10.7387 35.9407L17.4252 34.813C17.8349 34.7439 18.213 34.5489 18.5068 34.2551L20.9242 31.8377L10.9108 21.8244L8.49338 24.2418Z",fill:"#4A6EE0",stroke:"#0E101A",strokeLinejoin:"round"}),f.createElement("path",{d:"M6.80713 32.009L10.7387 35.9406L8.59296 38.0863L1.08523 37.7309L6.80713 32.009Z",fill:"#79A8F2",stroke:"#0E101A",strokeLinejoin:"round"}),f.createElement("path",{d:"M39.3246 30.9133C39.3246 36.1382 35.0939 40.3268 29.9123 40.3268C24.6867 40.3268 20.5 36.1397 20.5 30.9133C20.5 25.687 24.6867 21.4999 29.9123 21.4999C35.1379 21.4999 39.3246 25.687 39.3246 30.9133Z",fill:"#15C39A",stroke:"#0E101A",strokeMiterlimit:"10"}),f.createElement("path",{d:"M25.2656 31.6833L28.2955 34.6904L34.7437 28.3717",stroke:"white",strokeWidth:"2",strokeLinecap:"round"}),f.createElement("path",{d:"M8 3L9.35045 6.64955L13 8L9.35045 9.35045L8 13L6.64955 9.35045L3 8L6.64955 6.64955L8 3Z",fill:"white"}),f.createElement("path",{d:"M18.5 40L19.4453 42.5547L22 43.5L19.4453 44.4453L18.5 47L17.5547 44.4453L15 43.5L17.5547 42.5547L18.5 40Z",fill:"white"})));function n(e){return N.Z.fromSideEffect((({action:t})=>"next"===t?e.actions.next({kind:H.Kind.setInlineHighlightsOnboardingStep,step:"highlightsSwitch"}):"close"===t?e.actions.next({kind:H.Kind.seenInlineHighlightsOnboarding}):(0,V.vE)(t)),void 0)}function i(e){return N.Z.fromSideEffect((({action:t})=>"next"===t?e.actions.next({kind:H.Kind.setInlineHighlightsOnboardingStep,step:"panelSwitch"}):"close"===t?e.actions.next({kind:H.Kind.seenInlineHighlightsOnboarding}):(0,V.vE)(t)),void 0)}function a(e){return N.Z.fromSideEffect((t=>"inlineHighlightsOnboardingAction"===t.kind?e.actions.next({kind:H.Kind.seenInlineHighlightsOnboarding}):(0,V.vE)(t.kind)),void 0)}function o(e){return N.Z.composeUnion({highlight:n(e),highlightsSwitch:i(e),panelSwitch:a(e)},(()=>e.state.pipe(U.U((({step:e})=>e)),D.h(k.isSome),U.U(kt.MH))))}function s(e){return N.Z.composeKnot({root:()=>e.state.pipe(D.h((e=>k.isSome(e.step))),U.U((({seen:e,step:t})=>({seen:e,step:kt.MH(t)})))),content:o(e)})}e.HighlightStep=N.UI.Node.make((({notify:e})=>f.createElement("div",{className:oa.highlightsOnboarding},t,f.createElement("div",null,f.createElement("h2",{className:oa["highlightsOnboarding-header"]},G.inlineOnboarding.highlight.title),f.createElement("div",{className:oa["highlightsOnboarding-content"]},G.inlineOnboarding.highlight.content),f.createElement("div",{className:oa["highlightsOnboarding-buttons"]},f.createElement(Z.zx.Primary,{onClick:e({kind:"inlineHighlightsOnboardingAction",action:"next"}),name:"inline-highlight-onboarding-next-button",ariaLabel:G.inlineOnboarding.highlight.next},G.inlineOnboarding.highlight.next),f.createElement(Z.zx.Ghost,{onClick:e({kind:"inlineHighlightsOnboardingAction",action:"close"}),name:"inline-highlight-onboarding-close-button",ariaLabel:G.inlineOnboarding.highlight.close,className:oa["highlightsOnboarding-button"]},G.inlineOnboarding.highlight.close)))))),e.HighlightsSwitchStep=N.UI.Node.make((({notify:e})=>f.createElement("div",{className:oa.highlightsOnboarding},t,f.createElement("div",null,f.createElement("h2",{className:oa["highlightsOnboarding-header"]},G.inlineOnboarding.highlightsSwitch.title),f.createElement("div",{className:oa["highlightsOnboarding-content"]},G.inlineOnboarding.highlightsSwitch.content),f.createElement("div",{className:oa["highlightsOnboarding-buttons"]},f.createElement(Z.zx.Primary,{onClick:e({kind:"inlineHighlightsOnboardingAction",action:"next"}),name:"inline-highlight-onboarding-next-button",ariaLabel:G.inlineOnboarding.highlightsSwitch.next},G.inlineOnboarding.highlightsSwitch.next),f.createElement(Z.zx.Ghost,{onClick:e({kind:"inlineHighlightsOnboardingAction",action:"close"}),name:"inline-highlight-onboarding-close-button",ariaLabel:G.inlineOnboarding.highlightsSwitch.close,className:oa["highlightsOnboarding-button"]},G.inlineOnboarding.highlightsSwitch.close)))))),e.PanelSwitchStep=N.UI.Node.make((({notify:e})=>f.createElement("div",{className:oa.highlightsOnboarding},t,f.createElement("div",null,f.createElement("h2",{className:oa["highlightsOnboarding-header"]},G.inlineOnboarding.panelSwitch.title),f.createElement("div",{className:oa["highlightsOnboarding-content"]},G.inlineOnboarding.panelSwitch.content),f.createElement("div",{className:oa["highlightsOnboarding-buttons"]},f.createElement(Z.zx.Primary,{onClick:e({kind:"inlineHighlightsOnboardingAction",action:"next"}),name:"inline-highlight-onboarding-next-button",ariaLabel:G.inlineOnboarding.panelSwitch.next},G.inlineOnboarding.panelSwitch.next)))))),e.OnboardingContent=N.UI.Union.make("kind",{highlight:e.HighlightStep,highlightsSwitch:e.HighlightsSwitchStep,panelSwitch:e.PanelSwitchStep}),e.createOnboardingContentFlow=o,e.OnboardingGrid=N.UI.Grid.make((({slots:e,state:t})=>f.createElement(S.F.Fragment,null,t.pipe(U.U((({seen:t,step:n})=>t?null:f.createElement(aa.J,{mainContent:f.createElement(S.F.Fragment,null,e.content),isOutsideReferenceElement:!0,outsideReferenceElement:n.anchorElement,backgroundTheme:"dark",placement:"top",includeMainContentPadding:!1,distanceFromReferenceElement:"highlight"===n.kind?12:void 0,style:{zIndex:1},show:!0}))))))),e.OnboardingSome=N.UI.Knot.make(e.OnboardingGrid,{content:e.OnboardingContent}),e.Onboarding=N.UI.Union.make("_tag",{Some:e.OnboardingSome,None:N.UI.Node.empty}),e.createFlow=function(e){return N.Z.composeUnion({Some:s(e),None:()=>T.of(null)},(()=>e.state.pipe(U.U((({step:e})=>e)))))}}(ia||(ia={}));var sa,ra=n(14601);!function(e){e.ViewModelImpl=class{constructor(e,t,n,i){this._readerCSState=e,this._gnar=t,this._sessionUuid=n,this._threadContext=i,this._subscriptions=new ra.w,this._state=u.h.create({step:k.none,seen:this._readerCSState.get().seenInlineHighlightsOnboarding||!1}),this.state=this._state.view(),this.actions=new _e.xQ,this._elements=new Map,this._step=new _e.xQ,this._subscriptions.add(this._handleMounts()),this._subscriptions.add(this._handleNextStepClick()),this._subscriptions.add(this._handleSeen()),this._subscriptions.add(this._handleStepChange()),this._step.next("highlight")}dispose(){this._subscriptions.unsubscribe(),this._elements.clear()}_handleMounts(){return this.actions.pipe(B.ofType(H.Kind.inlineHighlightOnboardingElementMounted)).subscribe((({step:e,node:t})=>this._elements.set(e,t)))}_handleStepChange(){return ae.aj([this._step,this.actions.pipe(B.ofType(H.Kind.inlineHighlightOnboardingElementMounted))]).pipe(U.U((([e])=>({kind:e,anchorElement:this._elements.get(e)}))),D.h((e=>!!e.anchorElement)),U.U(k.some),ce.O(k.none)).subscribe((e=>{(0,o.zG)(e,kt.bw((e=>{const t=(0,o.zG)(this._threadContext.get().threadId,k.fromEither,k.toUndefined);switch(e.kind){case"highlight":this._gnar.readerMailInlineHighlightsOnboardingShown(this._sessionUuid,t);break;case"highlightsSwitch":case"panelSwitch":this._gnar.readerMailInlineHighlightsOnboardingNext(this._sessionUuid,t);break;default:(0,V.vE)(e)}}))),this._state.lens("step").set(e)}))}_handleNextStepClick(){return this.actions.pipe(B.ofType(H.Kind.setInlineHighlightsOnboardingStep)).subscribe((({step:e})=>this._step.next(e)))}_handleSeen(){return this.actions.pipe(B.ofType(H.Kind.seenInlineHighlightsOnboarding)).subscribe((()=>{const e=(0,o.zG)(this._threadContext.get().threadId,k.fromEither,k.toUndefined);this._gnar.readerMailInlineHighlightsOnboardingDismissed(this._sessionUuid,e),this._state.lens("seen").set(!0)}))}}}(sa||(sa={}));var la,da,ca=n(26430),ma=n(38348),ua=n(30625),ha=n(90361),pa=n(85548),ga=n(13444),fa=n(2768),ba=n(24209),va=n(12126),ka=n(77843),ya=n(95195),xa=n(20817),Ia=n(65219),_a=n(44760);function wa(e,t=self){return t.navigator&&t.navigator.clipboard&&t.navigator.clipboard.writeText?t.navigator.clipboard.writeText(e):Promise.reject("The Clipboard API is not available.")}function Ea(e){return(t,n)=>i=>(0,o.zG)(i,r.cq(e)(t,(0,o.ls)(k.some,n)),k.getOrElse((()=>(0,o.zG)(i,r.ZQ(e)(t,n(k.none))))))}!function(e){e.thankYou="thankYou"}(la||(la={})),function(e){e.create=function(e,t=6e3){return{kind:e,dismissTimestamp:Date.now()+t}}}(da||(da={}));const Ca=(e,t)=>Ea(Ia.h.Id.eq)(e,t),Ua=(e,t)=>Ea(g.p.Id.eq)(e,t),Sa=(e,t)=>Ea(pa.A.eq)(e,t);var Na,Ma;!function(e){let t;e.empty=(e,t,n)=>({activeMenuItemId:k.none,activeMessageIndex:k.none,onboardingStep:(null==e?void 0:e.seenOnboarding)?k.none:k.some(0),panelState:n,feedbackDialog:k.none,notification:k.none,activeView:(null==e?void 0:e.seenOnboarding)?"messageView":"onboardingView",showFilteredContent:{summary:!1,followUps:!1,links:!1},annotations:(0,o.zG)(t,k.chain((t=>{var n,i;return k.fromNullable(null===(i=null===(n=null==e?void 0:e.threadState)||void 0===n?void 0:n[t])||void 0===i?void 0:i.annotations)})),k.fold((()=>new Map),l.To(new Map,((e,t,n)=>(0,o.zG)(g.X.decode(n),ya.g_((()=>t),(n=>t.set(e,n)))))))),summaryItems:(0,o.zG)(t,k.chain((t=>{var n,i;return k.fromNullable(null===(i=null===(n=null==e?void 0:e.threadState)||void 0===n?void 0:n[t])||void 0===i?void 0:i.summaries)})),k.fold((()=>new Map),l.To(new Map,((e,t,n)=>(0,o.zG)(Ia.k.decode(n),ya.g_((()=>t),(n=>t.set(e,n)))))))),links:(0,o.zG)(t,k.chain((t=>{var n,i;return k.fromNullable(null===(i=null===(n=null==e?void 0:e.threadState)||void 0===n?void 0:n[t])||void 0===i?void 0:i.links)})),k.fold((()=>new Map),l.To(new Map,((e,t,n)=>(0,o.zG)(_a.e9.decode(n),ya.g_((()=>t),(n=>t.set(e,n))))))))}),function(e){e.summaryItems=xa.Ri.create((e=>e.summaryItems),((e,t)=>({...t,summaryItems:e}))),e.annotations=xa.Ri.create((e=>e.annotations),((e,t)=>({...t,annotations:e}))),e.links=xa.Ri.create((e=>e.links),((e,t)=>({...t,links:e})))}(t=e.Lens||(e.Lens={}))}(Na||(Na={}));class Ta{constructor(e,t,n,i,a,s,l,d=s.has("feedbackDialog")){var c;this._mailThread=e,this._hasInlineAnnotations=t,this.browser=n,this._gnar=i,this._sessionUuid=a,this._features=s,this._readerCSState=l,this.isSubmitFeedbackDialogSupported=d,this._subscriptions=new ra.w,this.isClipboardSupported=function(e=self){return!!(e.navigator&&e.navigator.clipboard&&e.navigator.clipboard.writeText)}(),this.areInlineHighlightsSupported=this._features.has("inlineHighlights")||this._features.has("inlineCards"),this._state=u.h.create(Na.empty(this._readerCSState.get(),(0,o.zG)(this._mailThread.get().threadId,k.fromEither),(null===(c=this._readerCSState.get())||void 0===c?void 0:c.seenOnboarding)&&this.areInlineHighlightsSupported?"collapsed":"expanded")),this._panelInjected=!1,this._onboardingPanelShown=!1,this._userNavigatedInPanel=!1,this.actions=new _e.xQ,this.state=u.h.combine(this._mailThread,this._state,((e,{panelState:t,activeMessageIndex:n,activeView:i,annotations:a,summaryItems:s,links:l,onboardingStep:d,activeMenuItemId:c,feedbackDialog:u,notification:p,showFilteredContent:f})=>{const b=(0,o.zG)(n,k.getOrElse((()=>e.messageCount-1))),y=(0,o.zG)(k.fromNullable(e.messageIndexToIdMap.get(b)),k.chain((t=>k.fromNullable(e.expandedMessages.get(t)))));if("collapsed"===t)return{kind:"collapsed",loading:"onboardingView"!==i&&!Ga(e),feedbackDialog:u,notification:p,nothingToRecap:"onboardingView"!==i&&(0,o.zG)(y,k.fold(o.jv,La))};const x=(0,o.zG)(y,k.fold(o.jv,Oa));return{feedbackDialog:u,notification:p,..."onboardingView"===i?{kind:"onboardingView",step:(0,o.zG)(d,k.getOrElse((()=>0))),features:this._features}:"pinnedView"===i?{kind:"pinnedView",summaryItems:(0,o.zG)(s,r.hX((e=>!e.dismissed&&e.pinned)),r.VO(Ia.h.ord),Ka(this._features,"summaries")),questions:(0,o.zG)(a,r.hX((e=>!e.dismissed&&e.pinned)),r.VO(g.p.ord),Ka(this._features,"followUps")),links:(0,o.zG)((0,o.zG)(l,r.hX((0,v.W9)((e=>!e.dismissed),_a.kP)),r.VO(_a.WO.ord)),Ka(this._features,"links")),activeMenuItemId:c}:"messageView"===i?{kind:"messageView",header:(0,o.zG)(y,k.fold((()=>m.x5),(e=>(0,o.zG)(e.message,m.UI((e=>({author:e.author,date:e.date}))))))),navigation:{canGoBack:b>0,canGoForward:b<e.messageCount-1},message:(0,o.zG)(y,k.fold((()=>m.x5),(e=>(0,o.zG)(e.message,m.UI((e=>({id:e.id,date:e.date,wordCount:e.wordCount}))))))),summary:(0,o.zG)(Pa(y,s),Ka(this._features,"summaries"),k.map((e=>({data:e,viewState:x?f.summary?h.showFilteredMessageContent:h.hideFilteredMessageContent:h.showContent})))),questions:(0,o.zG)(Ra(y,a),Ka(this._features,"followUps"),k.map((e=>({data:e,viewState:x?f.followUps?h.showFilteredMessageContent:h.hideFilteredMessageContent:h.showContent})))),links:(0,o.zG)(Ha(y,l),Ka(this._features,"links"),k.map((e=>({data:e,viewState:x?f.links?h.showFilteredMessageContent:h.hideFilteredMessageContent:h.showContent})))),activeMenuItemId:c}:(0,V.vE)(i)}})),this.inlineHighlightsEnabled=this._readerCSState.view((({inlineHighlightsEnabled:e})=>(0,o.zG)(k.fromNullable(e),k.getOrElse((()=>!0))))),this._maybeThreadId=(0,o.zG)(this._mailThread.get().threadId,k.fromEither,k.toUndefined),this._subscriptions.add(this._mailThread.view("messageCount").subscribe((e=>this._state.lens("activeMessageIndex").modify(k.map((t=>Math.max(0,Math.min(t,e-1)))))))),this._subscriptions.add(this._trackMessageShow()),this._subscriptions.add(this._autoDismissNotifications()),this._subscriptions.add(this._handleCollapseButtonClick()),this._subscriptions.add(this._handleExpandButtonClick()),this._subscriptions.add(this._handlePanelMounted()),this._subscriptions.add(this._handleThreadViewNavigate()),this._subscriptions.add(this._handleOpenPinnedView()),this._subscriptions.add(this._handleOpenMessageView()),this._subscriptions.add(this._handleOnboardingViewNavigate()),this._subscriptions.add(this._handleCheckQuestionItem()),this._subscriptions.add(this._handleColumnScroll()),this._subscriptions.add(this._handleItemBlur()),this._subscriptions.add(this._handleOpenItemMenu()),this._subscriptions.add(this._handleLinkItemClick()),this._subscriptions.add(this._handlePin()),this._subscriptions.add(this._handleDismiss()),this._subscriptions.add(this._handleCopy()),this._subscriptions.add(this._handleRating()),this._subscriptions.add(this._handleOptIn()),this._subscriptions.add(this._handleOptOut()),this._subscriptions.add(this._handleCloseNotification()),this._subscriptions.add(this._handleOpenFeedbackDialog()),this._subscriptions.add(this._handleSubmitFeedbackDialog()),this._subscriptions.add(this._handleSkipFeedbackDialog()),this._subscriptions.add(this._handleCloseFeedbackDialog()),this._subscriptions.add(this._handleInlineHighlightsToggle()),this._subscriptions.add(this._handleShowFilteredContent()),this._subscriptions.add(this._autoExpand())}_autoExpand(){return this._mailThread.pipe(ga.g(0),fa.R(ba.T(this.actions.pipe(B.ofType(H.Kind.collapse)),this.actions.pipe(B.ofType(H.Kind.expand)),this._hasInlineAnnotations.pipe(D.h(ha.fQ)))),U.U((e=>(0,o.zG)(k.fromNullable(e.messageIndexToIdMap.get(e.messageCount-1)),k.chain((t=>k.fromNullable(e.expandedMessages.get(t)))),k.fold(o.jv,(({annotations:e,summary:t})=>!m.n2(e)&&(Fa(e)||Aa(t))))))),D.h(ha.fQ)).subscribe((()=>this._state.lens("panelState").set("expanded")))}_handlePanelMounted(){return this.actions.pipe(B.ofType(H.Kind.panelMounted)).subscribe((({subject:e})=>{e===z.readerPanel?this._panelInjected||"onboardingView"===this._state.get().activeView||(this._gnar.readerMailPanelShow(this._sessionUuid,this._maybeThreadId),this._panelInjected=!0):e===z.onboardingPanel?this._onboardingPanelShown||(this._gnar.readerMailOnboardingPanelShow(this._sessionUuid,this._maybeThreadId),this._onboardingPanelShown=!0):(0,V.vE)(e)}))}_handleExpandButtonClick(){return this.actions.pipe(B.ofType(H.Kind.expand)).subscribe((({source:e})=>{switch(this._state.modify((e=>({...e,panelState:"expanded",feedbackDialog:k.none,notification:k.none}))),e){case P.expandButton:this._gnar.readerMailPanelExpandButtonClick(this._state.get().activeView,this._sessionUuid,this._maybeThreadId);break;case P.recapButton:this._gnar.readerMailRecapExpandButtonClick(this._state.get().activeView,this._sessionUuid,this._maybeThreadId);break;case P.replyButton:this._gnar.readerMailEmailClientReplyButtonClick(this._state.get().activeView,this._sessionUuid,this._maybeThreadId);break;default:(0,V.vE)(e)}}))}_handleCollapseButtonClick(){return this.actions.pipe(B.ofType(H.Kind.collapse)).subscribe((({source:e})=>{switch(this._state.modify((e=>({...e,panelState:"collapsed",feedbackDialog:k.none,notification:k.none}))),e){case K.collapseButton:this._gnar.readerMailPanelCollapseButtonClick(this._state.get().activeView,this._sessionUuid,this._maybeThreadId);break;case K.recapButton:this._gnar.readerMailRecapCollapseButtonClick(this._sessionUuid,this._maybeThreadId);break;default:(0,V.vE)(e)}}))}_handleOptIn(){return this.actions.pipe(B.ofType(H.Kind.optIn)).subscribe((()=>{this._state.modify((e=>({...e,activeView:"messageView",onboardingStep:k.none}))),this._gnar.readerMailOnboardingPanelOptInButtonClick(this._sessionUuid,this._maybeThreadId)}))}_handleOptOut(){return this.actions.pipe(B.ofType(H.Kind.optOut)).subscribe((()=>{this._state.modify((e=>({...e,panelState:"collapsed",onboardingStep:k.none,feedbackDialog:k.none,notification:k.none}))),this._gnar.readerMailOnboardingPanelOptOutButtonClick(this._sessionUuid,this._maybeThreadId)}))}_handleOnboardingViewNavigate(){return this.actions.pipe(B.ofType(H.Kind.onboardingViewNavigate)).subscribe((({action:e})=>{const t=(0,o.zG)(this._state.get().onboardingStep,k.getOrElse((()=>0)),(t=>{switch(e){case O.left:return Math.max(t-1,0);case O.right:return Math.min(t+1,2);default:(0,V.vE)(e)}}));this._state.lens("onboardingStep").set(k.some(t)),this._gnar.readerMailOnboardingPanelNavigationButtonClick(this._sessionUuid,y[t],this._maybeThreadId)}))}getNextActiveMessageIndex(e){return function(e,t,n){if(e===L.left&&t>0)return k.some(t-1);if(e===L.right&&t<n-1)return k.some(t+1);if(e===L.first&&t>0)return k.some(0);if(e===L.last&&t<n-1)return k.some(n-1);return k.none}(e,(0,o.zG)(this._state.get().activeMessageIndex,k.getOrElse((()=>this._mailThread.get().messageCount-1))),this._mailThread.get().messageCount)}_handleThreadViewNavigate(){return this.actions.pipe(B.ofType(H.Kind.threadViewNavigate)).subscribe((({action:e,nextIndex:t})=>{this._userNavigatedInPanel=!0,this._state.lens("activeMessageIndex").set(k.some(t)),this._gnar.readerMailPanelNavigationButtonClick(e,this._sessionUuid,this._maybeThreadId)}))}_handleOpenPinnedView(){return this.actions.pipe(B.ofType(H.Kind.openPinnedView)).subscribe((()=>{this._state.lens("activeView").set("pinnedView"),this._gnar.readerMailPanelPinnedButtonClick(this._sessionUuid,this._maybeThreadId)}))}_handleOpenMessageView(){return this.actions.pipe(B.ofType(H.Kind.openMessageView)).subscribe((({source:e})=>{switch(this._state.lens("activeView").set("messageView"),e){case R.messagesButton:this._gnar.readerMailPanelMessagesButtonClick(this._sessionUuid,this._maybeThreadId);break;case R.emptyPinnedSummaries:case R.emptyPinnedFollowUps:case R.emptyPinnedLinks:this._gnar.readerMailPanelReturnToMessagesButtonClick(this._sessionUuid,e,this._maybeThreadId);break;default:(0,V.vE)(e)}}))}_handleCheckQuestionItem(){return this.actions.pipe(B.ofType(H.Kind.check)).subscribe((({item:e,checked:t})=>{this._state.lens(Na.Lens.annotations).modify(Ua(e.itemId,(0,o.ls)(k.getOrElse((()=>e)),(e=>({...e,checked:t}))))),this._gnar.readerMailPanelQuestionItemCheck(e.message.id,this._state.get().activeView,this._sessionUuid,t,this._maybeThreadId)}))}_handlePin(){return this.actions.pipe(B.ofType(H.Kind.pin)).subscribe((({item:e,itemType:t,pinned:n})=>{switch(t){case"summaryItem":this._state.lens(Na.Lens.summaryItems).modify(Ca(e.itemId,(0,o.ls)(k.getOrElse((()=>e)),(e=>({...e,pinned:n}))))),this._gnar.readerMailPanelSummaryItemPin(e.message.id,this._sessionUuid,n,this._maybeThreadId);break;case"followUpItem":this._state.lens(Na.Lens.annotations).modify(Ua(e.itemId,(0,o.ls)(k.getOrElse((()=>e)),(e=>({...e,pinned:n}))))),this._gnar.readerMailPanelQuestionItemPin(e.message.id,this._sessionUuid,n,this._maybeThreadId);break;case"linkItem":this._state.lens(Na.Lens.links).modify(Sa(e.url,(0,o.ls)(k.getOrElse((()=>e)),(e=>({...e,pinned:n,messagePinnedFrom:n?k.some(e.message):k.none}))))),this._gnar.readerMailPanelLinkItemPin(e.message.id,this._sessionUuid,n,this._maybeThreadId);break;default:(0,V.vE)(e)}this._setActiveItemId(null)}))}_handleCopy(){return this.actions.pipe(B.ofType(H.Kind.copy)).subscribe((({item:e,itemType:t})=>{switch(t){case"summaryItem":this._subscriptions.add(va.D(wa(e.text)).subscribe()),this._gnar.readerMailPanelSummaryItemCopy(e.message.id,this._sessionUuid,this._maybeThreadId);break;case"followUpItem":this._subscriptions.add(va.D(wa(e.text)).subscribe()),this._gnar.readerMailPanelQuestionItemCopy(e.message.id,this._sessionUuid,this._maybeThreadId);break;case"linkItem":this._subscriptions.add(va.D(wa(e.name)).subscribe()),this._gnar.readerMailPanelLinkItemCopy(e.message.id,this._sessionUuid,this._maybeThreadId);break;default:(0,V.vE)(e)}this._setActiveItemId(null)}))}_handleDismiss(){return this.actions.pipe(B.ofType(H.Kind.dismiss)).subscribe((({item:e,itemType:t})=>{switch(t){case"summaryItem":this._state.lens(Na.Lens.summaryItems).modify(Ca(e.itemId,(0,o.ls)(k.getOrElse((()=>e)),(e=>({...e,dismissed:!0}))))),this._gnar.readerMailPanelSummaryItemDismiss(e.message.id,this._sessionUuid,this._maybeThreadId);break;case"followUpItem":this._state.lens(Na.Lens.annotations).modify(Ua(e.itemId,(0,o.ls)(k.getOrElse((()=>e)),(e=>({...e,dismissed:!0}))))),this._gnar.readerMailPanelQuestionItemDismiss(e.message.id,this._sessionUuid,this._maybeThreadId);break;case"linkItem":this._state.lens(Na.Lens.links).modify(Sa(e.url,(0,o.ls)(k.getOrElse((()=>e)),(e=>({...e,dismissed:!0}))))),this._gnar.readerMailPanelLinkItemDismiss(e.message.id,this._sessionUuid,this._maybeThreadId);break;default:(0,V.vE)(e)}this._setActiveItemId(null)}))}_handleRating(){return this.actions.pipe(D.h((0,v.Kg)(H.is(H.Kind.like),H.is(H.Kind.dislike)))).subscribe((({kind:e,item:t,itemType:n,position:i})=>{switch(n){case"summaryItem":this._state.lens(Na.Lens.summaryItems).modify(Ca(t.itemId,(0,o.ls)(k.getOrElse((()=>t)),(t=>({...t,rating:za(e)}))))),this.actions.next({kind:H.Kind.openFeedback,source:{kind:"itemPanelMenu",itemType:"summaryItem",item:t,action:e},position:i});break;case"followUpItem":this._state.lens(Na.Lens.annotations).modify(Ua(t.itemId,(0,o.ls)(k.getOrElse((()=>t)),(t=>({...t,rating:za(e)}))))),this.actions.next({kind:H.Kind.openFeedback,source:{kind:"itemPanelMenu",itemType:"followUpItem",item:t,action:e},position:i});break;default:(0,V.vE)(t)}}))}_setActiveItemId(e){this._state.lens("activeMenuItemId").set(k.fromNullable(e))}_handleOpenItemMenu(){return this.actions.pipe(B.ofType(H.Kind.openItemMenu)).subscribe((({itemId:e})=>this._setActiveItemId(e)))}_handleColumnScroll(){return this.actions.pipe(B.ofType(H.Kind.columnScroll)).subscribe((()=>this._setActiveItemId(null)))}_handleItemBlur(){return this.actions.pipe(B.ofType(H.Kind.itemBlur)).subscribe((()=>this._setActiveItemId(null)))}_handleOpenFeedbackDialog(){return this.actions.pipe(B.ofType(H.Kind.openFeedback)).subscribe((({source:e,position:t})=>this._state.lens("feedbackDialog").set(k.some({source:e,position:t}))))}_handleCloseFeedbackDialog(){return this.actions.pipe(B.ofType(H.Kind.closeFeedback)).subscribe((()=>this._state.modify((e=>({...e,feedbackDialog:k.none,activeMenuItemId:k.none})))))}_handleSkipFeedbackDialog(){return this.actions.pipe(B.ofType(H.Kind.skipFeedback)).subscribe((()=>this._state.modify((e=>({...e,feedbackDialog:k.none,activeMenuItemId:k.none})))))}_handleSubmitFeedbackDialog(){return this.actions.pipe(B.ofType(H.Kind.submitFeedback)).subscribe((()=>this._state.modify((e=>({...e,feedbackDialog:k.none,activeMenuItemId:k.none,notification:k.some(da.create(la.thankYou))})))))}_handleCloseNotification(){return this.actions.pipe(B.ofType(H.Kind.closeNotification)).subscribe((()=>this._state.lens("notification").set(k.none)))}_handleLinkItemClick(){return this.actions.pipe(B.ofType(H.Kind.linkClick)).subscribe((({item:e})=>{this._gnar.readerMailPanelLinkItemClick(e.message.id,this._sessionUuid,this._maybeThreadId)}))}_handleInlineHighlightsToggle(){return this.actions.pipe(B.ofType(H.Kind.toggleInlineHighlights)).subscribe((({enabled:e})=>{e?this._gnar.readerMailInlineHighlightsDisable(this._sessionUuid,this._maybeThreadId):this._gnar.readerMailInlineHighlightsEnable(this._sessionUuid,this._maybeThreadId)}))}_handleShowFilteredContent(){return this.actions.pipe(B.ofType(H.Kind.showFilteredContent)).subscribe((e=>this._state.lens("showFilteredContent",e.column).set(!0)))}dispose(){this._subscriptions.unsubscribe()}_autoDismissNotifications(){return ka.F(1e3).pipe(we.M(this._state),D.h((([e,t])=>(0,o.zG)(t.notification,k.fold(o.jv,(e=>Date.now()>=e.dismissTimestamp)))))).subscribe((()=>this._state.lens("notification").modify(k.filter((e=>Date.now()<e.dismissTimestamp)))))}_trackMessageShow(){return this.state.pipe(D.h(C),rt.x(((e,t)=>ca.Rb.eq.equals(e.message.value,t.message.value)))).subscribe((e=>{const t=(0,o.zG)(e.summary,k.map(b.ei("data")),k.filter(m.d6),k.fold((()=>0),(e=>e.value.length))),n=(0,o.zG)(e.questions,k.map(b.ei("data")),k.filter(m.d6),k.fold((()=>0),(e=>e.value.length))),i=(0,o.zG)(e.links,k.map(b.ei("data")),k.filter(m.d6),k.fold((()=>0),(e=>e.value.length)));this._gnar.readerMailPanelMessageShow(Array.from(this._features),i,e.message.value.id,n,this._sessionUuid,this._userNavigatedInPanel?"navigation":"firstLoad",t,e.message.value.wordCount,"parsedDate"===e.message.value.date.kind?e.message.value.date.timestamp:void 0,this._maybeThreadId)}))}}function Fa(e){return m.d6(e)&&(0,o.zG)(e.value,k.exists((e=>e.annotations.length>0&&k.isNone(e.filteringInfo))))}function Aa(e){return m.d6(e)&&(0,o.zG)(e.value,k.exists((e=>e.summary.length>0&&k.isNone(e.filteringInfo))))}function Ga(e){return(0,o.zG)(k.fromNullable(e.messageIndexToIdMap.get(e.messageCount-1)),k.chain((t=>k.fromNullable(e.expandedMessages.get(t)))),k.fold(o.jv,(({annotations:e,summary:t})=>Fa(e)||Aa(t)||!m.n2(e)&&!m.n2(t))))}function La(e){const t=!m.n2(e.annotations)&&(0,o.zG)((0,ua.zk)(e.annotations),k.flatten,k.map(b.ei("annotations")),k.fold(o.W8,(e=>0===e.length))),n=!m.n2(e.summary)&&(0,o.zG)((0,ua.zk)(e.summary),k.flatten,k.map(b.ei("summary")),k.fold(o.W8,(e=>0===e.length)));return t&&n}function Oa(e){return(0,o.zG)((0,ua.zk)(e.annotations),k.flatten,k.chain((e=>e.filteringInfo)),k.alt((()=>(0,o.zG)((0,ua.zk)(e.summary),k.flatten,k.chain((e=>e.filteringInfo))))),k.isSome)}function za(e){return"like"===e?vt.DE.liked:"dislike"===e?vt.DE.disliked:(0,V.vE)(e)}function Ka(e,t){return e.has(t)?k.some:(0,o.a9)(k.none)}function Pa(e,t){return(0,o.zG)(e,k.fold((()=>m.x5),(e=>(0,o.zG)(a.Y(m.$w)({summary:e.summary,message:e.message}),m.UI((({summary:e,message:n})=>(0,o.zG)(e,k.fold((()=>[]),(0,o.ls)(b.ei("summary"),s.UI((e=>{var i,a;const o=Ia.h.Id.create(e.id),s=t.get(o);return{message:{id:n.id,author:n.author,date:n.date,index:n.index},itemId:o,text:e.text,pinned:null!==(i=null==s?void 0:s.pinned)&&void 0!==i&&i,dismissed:null!==(a=null==s?void 0:s.dismissed)&&void 0!==a&&a,rating:null==s?void 0:s.rating}})),s.hX((e=>!e.dismissed)))))))))))}function Ra(e,t){return(0,o.zG)(e,k.fold((()=>m.x5),(e=>(0,o.zG)(a.Y(m.$w)({annotations:e.annotations,message:e.message}),m.UI((({annotations:e,message:n})=>(0,o.zG)(e,k.fold((()=>[]),(0,o.ls)(b.ei("annotations"),s.UI((e=>{var i,a,o;const s=g.p.Id.create(e.id),r=t.get(s);return{message:{id:n.id,author:n.author,date:n.date,index:n.index},itemId:s,text:e.text,type:e.type,pinned:null!==(i=null==r?void 0:r.pinned)&&void 0!==i&&i,checked:null!==(a=null==r?void 0:r.checked)&&void 0!==a&&a,dismissed:null!==(o=null==r?void 0:r.dismissed)&&void 0!==o&&o,rating:null==r?void 0:r.rating}})),s.hX((e=>!e.dismissed)),s.hX((e=>"question"===e.type||"action_item"===e.type)))))))))))}function Ha(e,t){return(0,o.zG)(e,k.fold((()=>m.x5),(e=>(0,o.zG)(e.message,m.tS((e=>m.Vp(e.links.map((n=>{var i,a,o;const s=t.get(n.url);return{message:{id:e.id,author:e.author,date:e.date,index:e.index},messagePinnedFrom:null!==(i=null==s?void 0:s.messagePinnedFrom)&&void 0!==i?i:k.none,name:n.name,url:n.url,type:n.type,mimeType:ma.q.isAttachment(n)?n.mimeType:void 0,pinned:null!==(a=null==s?void 0:s.pinned)&&void 0!==a&&a,dismissed:null!==(o=null==s?void 0:s.dismissed)&&void 0!==o&&o,rating:null==s?void 0:s.rating}})).filter((e=>!e.dismissed)))))))))}!function(e){e.Mock=class{constructor(e,t=!0,n=!0){this._state=e,this.isSubmitFeedbackDialogSupported=t,this.areInlineHighlightsSupported=n,this._subscriptions=new ra.w,this.inlineHighlightsEnabled=u.h.create(!0),this.actions=new _e.xQ,this.browser="chrome",this.isClipboardSupported=!0,this.state=this._state.view(),this._subscriptions.add(this.actions.pipe(D.h((0,v.Kg)(H.is(H.Kind.submitFeedback),H.is(H.Kind.skipFeedback),H.is(H.Kind.closeFeedback)))).subscribe((()=>this._updateFeedback(k.none)))),this._subscriptions.add(this.actions.pipe(B.ofType(H.Kind.openFeedback)).subscribe((({source:e,position:t})=>this._updateFeedback(k.some({source:e,position:t}))))),this._subscriptions.add(this.actions.pipe(D.h((0,v.Kg)(H.is(H.Kind.columnScroll),H.is(H.Kind.itemBlur)))).subscribe((()=>this._setActiveItemId(null)))),this._subscriptions.add(this.actions.pipe(B.ofType(H.Kind.openItemMenu)).subscribe((({itemId:e})=>this._setActiveItemId(e)))),this._subscriptions.add(this.actions.pipe(D.h((0,v.Kg)(H.is(H.Kind.like),H.is(H.Kind.dislike)))).subscribe((({kind:e,item:t,itemType:n,position:i})=>{switch(n){case"summaryItem":this.actions.next({kind:H.Kind.openFeedback,source:{kind:"itemPanelMenu",itemType:"summaryItem",item:t,action:e},position:i});break;case"followUpItem":this.actions.next({kind:H.Kind.openFeedback,source:{kind:"itemPanelMenu",itemType:"followUpItem",item:t,action:e},position:i});break;default:(0,V.vE)(t)}})))}getNextActiveMessageIndex(e){return k.none}dispose(){this._subscriptions.unsubscribe()}_setActiveItemId(e){this._state.modify((t=>_(t)||w(t)?{...t,activeMenuItemId:k.fromNullable(e)}:t))}_updateFeedback(e){this._state.modify((t=>"collapsed"!==t.kind&&"onboardingView"!==t.kind?{...t,activeMenuItemId:k.isNone(e)?k.none:t.activeMenuItemId,feedbackDialog:e}:"collapsed"===t.kind?{...t,feedbackDialog:e}:t))}}}(Ma||(Ma={}));var Ba=n(84603),Da=n(66319),Va=n(75420),Za=n(74850),ja=n(19751),qa=n(40151),Wa=n(17343),$a=n(16118),Qa=n(78674),Ja=n(71032),Ya=n(85321),Xa=n(67434),eo=n(73975),to=n(69243),no=n(71249);const io=to.OT(to.dt({filteringVersion:to.pk,filteredMessages:to.OT(to.IM(ca.Rb.Id.codec,to.Bk(to.Z_)))}));var ao;!function(e){e.eq=eo.MW({filteringVersion:eo.lr,filteringReasons:no.Eh(eo.yv)})}(ao||(ao={}));const oo=to.OT(to.dt({s:to.pk,e:to.pk})),so=to.G0([to.i0("main_point"),to.i0("date"),to.i0("question"),to.i0("action_item")]);var ro;!function(e){let t;!function(e){e.codec=to.UQ(to.Z_,(e=>"string"==typeof e),"ReaderAnnotationId"),e.create=function(e,t,n){return`${e}|${t.s}-${t.e}-${n}`}}(t=e.Id||(e.Id={}))}(ro||(ro={}));const lo=to.jV([to.r$({filteringInfo:io}),to.dt({annotations:to.IX(to.jV([to.dt({message_id:ca.Rb.Id.codec,span:oo,type:so}),to.r$({id:ro.Id.codec})]))})]);new to.Dy("ReaderAnnotations",lo.is,lo.validate,(e=>e.annotations.reduce(((t,n)=>{var i;return t[n.message_id]={messageId:n.message_id,annotations:((null===(i=t[n.message_id])||void 0===i?void 0:i.annotations)||[]).concat({id:n.id||ro.Id.create(n.message_id,n.span,n.type),span:n.span,type:n.type}),filteringInfo:(0,o.zG)(k.fromNullable(e.filteringInfo),k.chain((t=>{var i,o;return a.Y(k.option)({filteringReasons:k.fromNullable(null===(i=t.filteredMessages)||void 0===i?void 0:i[n.message_id]),filteringVersion:k.fromNullable(null===(o=e.filteringInfo)||void 0===o?void 0:o.filteringVersion)})})))},t}),{})));var co;!function(e){e.eq=eo.MW({id:eo.yv,span:eo.MW({s:eo.lr,e:eo.lr}),type:eo.yv})}(ro||(ro={})),function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={}))}(co||(co={}));var mo=n(25691);class uo{constructor(e=Za.Y.create("Reader-Card-Controller")){this._logger=e,this._hovered=new _e.xQ,this._dismissed=new _e.xQ,this.cardHovered=this._hovered.pipe((0,ce.O)(!1),(0,rt.x)()),this.cardDismissed=this._dismissed.pipe((0,rt.x)()),this._activeCardModel=u.h.create(null),this.view=(0,ae.aj)([this._activeCardModel]).pipe((0,U.U)((([e])=>(null==e?void 0:e.annotation)?f.createElement(mo.W,{anchorRect:e.highlightRect},f.createElement("div",{style:{background:"white",borderRadius:10,padding:10,fontSize:"12px",fontFamily:"sans-serif",boxShadow:"0px 2px 10px rgba(0, 0, 0, 0.6)"}},f.createElement("b",null,"Annotation"),f.createElement("pre",{style:{maxWidth:400,whiteSpace:"pre-wrap"}},JSON.stringify(e.annotation,null,4)))):null))),this._logger.debug("Created")}show(e){this._activeCardModel.set(e)}hide(){this._activeCardModel.set(null),this._hovered.next(!1)}dispose(){this.hide()}}var ho=n(34311);class po{constructor(e){this._annotationsStateService=e}getHoveredStateBehavior(e){return this._annotationsStateService.getHighlightedAnnotation().pipe((0,U.U)((t=>t&&t.highlightIds.includes(e)?ho.pc.hovered:ho.pc.none)))}}var go,fo=n(50628),bo=n(24755),vo=n(95300),ko=n(95343),yo=n(11407),xo=n(28728),Io=n(15555),_o=n(13718);!function(e){e.eq=eo.f7(((e,t)=>e&&t?e.annotationId===t.annotationId:e===t))}(go||(go={}));class wo{constructor(e,t=Za.Y.create(wo.name)){this._options=e,this._log=t,this._rawHighlightedAnnotation=()=>this._options.mouseData.pipe(_o.U(yo.S.hz30),ja.skipBy(xo.Z.eq),U.U((({client:e,offset:t})=>{if(e&&t&&function(e,t){var n;let i=t.ownerDocument.elementFromPoint(e.left,e.top);(null===(n=null==i?void 0:i.shadowRoot)||void 0===n?void 0:n.elementFromPoint)&&(i=i.shadowRoot.elementFromPoint(e.left,e.top));return t.contains(i)}(e,this._options.textNode)){const e=this._options.highlightGeometry.geometry.get();return Array.from(e.keys()).reduce(((n,i)=>{const a=e.get(i);if(a){const e=a.rects&&(null===a.meta.highlightDisplayFormat||Io.jk.isInteractable(a.meta.highlightDisplayFormat))&&a.rects.find((e=>ot.UL.contains(t,e)));if(e)return{annotationId:a.meta.annotationId,activeHighlightId:a.meta.highlightId,activeHighlightRect:e,highlightIds:[]}}return n}),null)}return null})),ja.skipBy(go.eq),U.U((e=>{if(!e)return null;const t=this._options.highlightGeometry.geometry.get(),n=[];return t.forEach(((t,i)=>{t.meta.annotationId===e.annotationId&&n.push(i)})),{...e,highlightIds:n}}))),this._offByUpdatedGeometry=e=>this._options.highlightGeometry.geometry.pipe(U.U((t=>e&&t.has(e.activeHighlightId)?e:null)),D.h((e=>null===e)),Wa.h(null),Ee.b((e=>this._log.trace("OffByUpdatedGeometry",e)))),this._offByTextPositionChange=()=>ba.T(this._options.textNodeLayout.rect.changes.pipe(Ee.b((()=>this._log.trace("Text field position, size has been changed")))),this._options.textNodeLayout.scroll.changes.pipe(Ee.b((()=>this._log.trace("Text field scroll has been changed")))),Qe.R(self,"scroll").pipe(Ee.b((()=>this._log.trace("Window scroll detected"))))).pipe(fo.P(),Wa.h(null))}getActiveAnnotation(){throw new Error("Not implemented")}getHighlightedAnnotation(){throw new Error("Not implemented")}}class Eo extends wo{constructor(e,t=Za.Y.create(Eo.name)){super(e,t)}getActiveAnnotation(){return this.getHighlightedAnnotation().pipe(ja.skipBy(go.eq))}getHighlightedAnnotation(){return this._rawHighlightedAnnotation().pipe(ja.skipBy(go.eq),lt.w((e=>e?ba.T(this._offByUpdatedGeometry(e),this._offByTextPositionChange()).pipe(Ee.b((()=>this._log.trace("Active state was overriden by text or geometry change"))),fo.P(),ce.O(e)):T.of(null))),ja.skipBy(go.eq),bo.O(new vo.X(null)),ko.x())}}var Co=n(93356),Uo=n(76331),So=n(40327),No=n(10166),Mo=n(4432);class To{constructor(){}create(e,t){return{getRects:()=>{var n;const i=[];let a,o=e.start,s=!1;do{const r=t.getFragmentAtOrBeforeOffset(o);if(r&&a!==o){a=o;if(null===(n=r.node.textContent)||void 0===n?void 0:n.replace(/\s/g,"")){const n=Mo.M.createRange(t,o,Math.min(r.endOffset,e.end));n&&i.push(...Array.from(n.getClientRects()))}o=r.endOffset===o?r.endOffset+1:r.endOffset}else s=!0}while(o<e.end&&!s);return(0,So.pipe)(i,No.e,No.y,no.UI(ot.Pf.create))}}}getClientRects(e){return e.getRects()}getIsInvalid(e){return!1}getIsConsistent(e,t,n){return!0}dispose(e){}}var Fo=n(13116),Ao=n(28094),Go=n(95981),Lo=n(63919),Oo=n(25924),zo=n(18505),Ko=n(2780),Po=n(68383),Ro=n(92783),Ho=n(57356),Bo=n(51655),Do=n(70718),Vo=n(13822);function Zo(e,t,n,i=!1){const a=(0,Bo.Me)(e).body,o=(0,Bo.Jj)(e);let s={left:"0px",top:"0px"};if(t.fieldPaintingPositioning===Ho.Q.nonPositioned&&t.positionedAncestor===a){const e=o.getComputedStyle(a);s={left:e.marginLeft||"0px",top:e.marginRight||"0px"}}else if(t.positionedAncestor!==a){const e=o.getComputedStyle(t.positionedAncestor);s={left:e.borderLeftWidth&&`-${e.borderLeftWidth}`||"0px",top:e.borderTopWidth&&`-${e.borderTopWidth}`||"0px"}}return a=>{a.style.position="absolute",a.style.top=s.top,a.style.left=i?"auto":s.left,a.style.right=i?s.left:"auto",a.style.pointerEvents="none",function({subjectElement:e,isPositioned:t,subjectElementStyle:n,integrationRoot:i,positionedAncestor:a}){t?(i.style.zIndex=n.zIndex,e.insertAdjacentElement("afterend",i)):a.insertAdjacentElement("afterbegin",i)}({subjectElement:e,isPositioned:t.fieldPaintingPositioning===Ho.Q.positioned,subjectElementStyle:n,integrationRoot:a,positionedAncestor:t.positionedAncestor})}}function jo(e){return ot.Pf.create({...e.client,...e.size})}class qo{constructor(e){this._highlightsSubject=e,this.getFieldPositionRelativeToViewport=()=>{const e=this._highlightsSubject.getBoundingClientRect();return{top:e.top,left:e.left,width:e.width,height:e.height}},this._prepareHighlights=(e,t=(0,Bo.is)(e))=>{const n=(0,Bo.o)(e),i=(0,Do.fL)(e,!1,n,t);return{layout:i,rootInjector:Zo(e,i,n),enableHighlightsBlendingOnRoot:(0,Ao.$)(e,n)}},this._prepareInnerElements=(e,t=(0,Bo.is)(e),n)=>{const i=(0,Bo.o)(e),a=n||(0,Do.fL)(e,!1,i,t);return{layout:a,rootInjector:Zo(e,a,i,!0)}},this._highlights=this._prepareHighlights(this._highlightsSubject),this._innerElements=this._prepareInnerElements(this._highlightsSubject,void 0,this._highlights.layout),this._win=(0,Bo.Jj)(this._highlightsSubject),this._createTextNodeRect=e=>({page:Lo.Cv.fromClient(e.client,{top:this._win.scrollY,left:this._win.scrollX}),offset:e.offset,client:e.client,size:e.size,padding:e.padding}),this.textNode={rect:this._highlights.layout.textField.paddingRect.map(this._createTextNodeRect),visibleRect:this._highlights.layout.textField.visibleRect.map(this._createTextNodeRect),scroll:this._highlights.layout.textField.scroll,scrollSize:this._highlights.layout.textField.scrollSize,scroller:(0,c.iX)(this._highlightsSubject,{rect:this._highlights.layout.textField.paddingRect.map(this._createTextNodeRect),scrollSize:this._highlights.layout.textField.scrollSize})},this.highlightHeightOffset=0,this.mouse=(0,ae.aj)([this._highlights.layout.textField.paddingRect.behavior,this._highlights.layout.textField.scroll.behavior]).pipe((0,U.U)((([e,t])=>({rect:jo(e),scroll:t}))),(0,lt.w)((({rect:e,scroll:t})=>(0,Ro.Am)()?(0,Oo.q7)(this._win,e,t):(0,Oo.B0)(this._win,e,t))),(0,rt.x)(ha.fS))}createGeometryLayout(){return new Go.D((()=>jo(this._highlights.layout.textField.paddingRect.getCurrent())),(()=>this._highlights.layout.textField.scroll.getCurrent()),(()=>jo(this._highlights.layout.textField.paddingRect.getApproximate())),(()=>this._highlights.layout.textField.scroll.getApproximate()))}render(e,t){const n={position:"absolute",top:0,left:0},i={position:"absolute",top:0,right:0},a=()=>e.innerElements?f.createElement(e.innerElements,null):null,o=(0,Bo.Me)(this._highlightsSubject),s=zo.VB.get({monitorAs:"highlights"}).inject(Ko.EM.fromDocument(o,"grammarly-extension"),(e=>{t.highlightsBlendingEnabled&&this._highlights.enableHighlightsBlendingOnRoot(e),this._highlights.rootInjector(e)}),Po.G7.showWhenLoaded(f.createElement((()=>f.createElement(f.Fragment,null,e.highlights&&f.createElement("div",{"data-grammarly-part":"highlights",style:n},f.createElement(Vo.V,{layout:this._highlights.layout},f.createElement("div",{style:n},f.createElement(e.highlights,null)))))),null))),r=zo.VB.get({monitorAs:"inner-elements"}).inject(Ko.EM.fromDocument(o,"grammarly-extension"),this._innerElements.rootInjector,Po.G7.showWhenLoaded(f.createElement((()=>e.innerElements?f.createElement("div",{"data-grammarly-part":"inner-elements",style:i},f.createElement(a,null)):null),null))),l=e.outerElements&&zo.VB.get({monitorAs:"outer-elements"}).inject(Ko.EM.fromDocument(o,"grammarly-popups"),Ko.zs.appendChild(o.documentElement),Po.G7.showWhenLoaded(f.createElement(e.outerElements,null)),{eventPropagationHandler:t.eventPropagationHandler});return{dispose:()=>{s&&s.dispose(),l&&l.dispose(),r&&r.dispose()}}}}var Wo,$o=n(43675),Qo=n(92843),Jo=n(37881),Yo=n(22679),Xo=n(87965),es=n(50663),ts=n(48189),ns=n(49468);class is{constructor(e,t,n,i){this._layout=e,this._highlights=t,this._annotationCards=n,this._getHoveredStateBehavior=i,this._highlightHoverStateBehavior=e=>this._getHoveredStateBehavior(e),this._getHighlightsContainer=e=>f.createElement(S.F.div,{style:this._layout.textNode.scrollSize.behavior.pipe((0,U.U)((e=>({height:e.height,width:e.width}))))},e),this.highlights=()=>this._getHighlightsContainer(f.createElement(f.Fragment,null,f.createElement(Jo.$v,{key:"aqua-highlights",highlightHeightOffset:0,highlights:this._highlights.geometry.view((e=>Array.from(e.values()))),getHoverState:this._highlightHoverStateBehavior}))),this.outerElements=()=>{const e=this._annotationCards;return f.createElement(ns.o,{style:{zIndex:Yo.op,position:"absolute",top:0,left:0,width:"100%"}},f.createElement(Xo.p,null,f.createElement("div",{style:{position:"fixed",visibility:"hidden"}}),f.createElement(S.F.Fragment,null,e),f.createElement(es.G,null),f.createElement(ts.p,{regular:!0,bold:!0})))}}}!function(e){e.eqByAnnotations=eo.Uz((e=>({annotations:e.annotations,messageId:e.messageId})))(eo.MW({messageId:eo.yv,annotations:no.Eh(ro.eq)}))}(Wo||(Wo={}));class as{constructor(e,t,n,i,s=Za.Y.create("Reader-Gmail-Annotations")){this._annotatedMessages=e,this._features=n,this._onboardingVM=i,this._logger=s,this._subscriptions=new ra.w,this._currentAnnotations=new Map,this._geometryProvider=new To,this._state=new Map,this._bodyNodeToMessageId=new WeakMap,this._annotationIdsForMessageId=new Map,this._hiddenMessages=new WeakMap,this._annotationsChanged=new _e.xQ,this.annotations=this._annotationsChanged.pipe(U.U((()=>Array.from(this._currentAnnotations.values()))));const r=new _e.xQ,l=ba.T(this._annotatedMessages.pipe(ce.O(new Map),$a.G(),U.U((([e,t])=>(0,o.zG)($o.yi(Wo.eqByAnnotations)(e,t),Qo.v.reduce([],((e,{messageId:t})=>e.concat({kind:"remove",messageId:t})),((e,t,n)=>e.concat({kind:"update",prevAnnotations:t.annotations,...n})),((e,t)=>e.concat({kind:"add",...t})))))),Ya.zg(o.yR)),r);this._intersectionObserver=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting?(0,o.zG)(k.fromNullable(this._hiddenMessages.get(e.target)),kt.bw((t=>{this._hiddenMessages.delete(e.target),r.next({kind:"add",...t})}))):(0,o.zG)(k.fromNullable(this._bodyNodeToMessageId.get(e.target)),k.chain((e=>k.fromNullable(this._state.get(e)))),kt.bw((({message:t})=>{const{messageId:n,bodyNode:i}=t;r.next({kind:"remove",messageId:n}),this._hiddenMessages.set(e.target,t),this._intersectionObserver.observe(i)})))}))}),{root:t}),this._subscriptions.add(l.subscribe((e=>{const t=this._state.get(e.messageId);if(t&&("update"===e.kind?e.prevAnnotations.forEach((t=>{const n=co.Id.create(t.id);this._currentAnnotations.delete(n),this._annotationsChanged.next(null),(0,o.zG)(k.fromNullable(this._annotationIdsForMessageId.get(e.messageId)),kt.bw((e=>{e.delete(n)})))})):"remove"===e.kind&&((0,o.zG)(k.fromNullable(this._annotationIdsForMessageId.get(e.messageId)),kt.bw((e=>{for(const t of e.values())this._currentAnnotations.delete(t),this._annotationsChanged.next(null)}))),this._annotationIdsForMessageId.delete(e.messageId),this._bodyNodeToMessageId.delete(t.message.bodyNode),this._state.delete(e.messageId)),t.disposables.forEach((e=>e.dispose())),this._logger.trace(`Annotations for ${e.messageId} cleared`)),"add"===e.kind||"update"===e.kind){const t=k.fromNullable(this._features.has("inlineCards")?new uo:null),n=new qo(e.bodyNode),i=new Uo.C(this._geometryProvider,n.createGeometryLayout(),(()=>e.textMap),(0,Co.u)(),(0,ho.WF)(n.textNode)),s=(0,o.zG)(t,k.map((()=>new Eo({textNode:e.bodyNode,textNodeLayout:n.textNode,mouseData:n.mouse,highlightGeometry:i})))),r=(0,o.zG)(s,k.map((e=>new po(e)))),l=(0,o.zG)(a.Y(k.option)({stateService:s,controller:t}),k.map((({stateService:e,controller:t})=>e.getActiveAnnotation().subscribe((e=>{if(e){const i=this._currentAnnotations.get(e.annotationId);i&&t.show({highlightRect:(0,Fo.Z)(e.activeHighlightRect,n.textNode.rect.getApproximate().client,n.textNode.scroll.getApproximate()),annotation:i})}else t.hide()}))))),d=this._onboardingVM.state.get().seen?null:i.geometry.pipe(D.h((e=>e.size>0)),ut.q(1),Ee.b((e=>{(0,o.zG)(Array.from(e.values()),no.YM,k.map(b.ei("rects")),k.chain(no.YM),kt.bw((e=>{this._onboardingVM.actions.next({kind:H.Kind.inlineHighlightOnboardingElementMounted,step:"highlight",node:{getBoundingClientRect:()=>{const t=(0,Fo.Z)(e,n.textNode.rect.getCurrent().client,n.textNode.scroll.getCurrent());return DOMRect.fromRect({x:t.left,y:t.top,width:0,height:t.height})}}})})))}))).subscribe(),c=new is(n,i,(0,o.zG)(t,k.map((e=>e.view)),k.getOrElse((()=>T.of(null)))),(e=>(0,o.zG)(r,k.map((t=>t.getHoveredStateBehavior(e))),k.getOrElse((()=>T.of(ho.pc.none))))));this._intersectionObserver.observe(e.bodyNode),this._state.set(e.messageId,{message:e,disposables:[i,n.render(c,{}),{dispose:()=>this._intersectionObserver.unobserve(e.bodyNode)},{dispose:()=>null==d?void 0:d.unsubscribe()},...(0,o.zG)(t,k.map((e=>[e])),k.getOrElse((()=>[]))),...(0,o.zG)(l,k.map((e=>[{dispose:()=>e.unsubscribe()}])),k.getOrElse((()=>[])))]}),this._bodyNodeToMessageId.set(e.bodyNode,e.messageId);const m=(0,o.zG)(k.fromNullable(this._annotationIdsForMessageId.get(e.messageId)),k.getOrElse((()=>{const t=new Set;return this._annotationIdsForMessageId.set(e.messageId,t),t})));e.annotations.filter((e=>"main_point"===e.type)).forEach((e=>{const t=ho.y$.Id.create(e.id),n=co.Id.create(e.id);this._logger.trace("Adding annotation highlight",t),this._currentAnnotations.set(n,e),this._annotationsChanged.next(null),m.add(n),i.addHighlight(t,{start:e.span.s,end:e.span.e},{highlightId:t,annotationId:n,highlightColor:Io.hE.Preset.create(Io.al.blue),highlightDisplayFormat:Io.jk.background,highlightLiveliness:this._features.has("inlineCards")?Io.iY.animated:Io.iY.static})}))}})))}dispose(){this._subscriptions.unsubscribe();for(const{disposables:e}of this._state.values())e.forEach((e=>e.dispose()));this._currentAnnotations.clear(),this._annotationsChanged.next(null),this._state.clear(),this._annotationIdsForMessageId.clear(),this._intersectionObserver.disconnect()}}var os=n(85089),ss=n(89068),rs=n(91224),ls=n(73572),ds=n(18347),cs=n(44586),ms=n(17733),us=n(79582);function hs(e,t){return new cs.y((function(n){var i=e.length;if(0!==i)for(var a=new Array(i),o=0,s=0,r=function(r){var l=(0,va.D)(e[r]),d=!1;n.add(l.subscribe({next:function(e){d||(d=!0,s++),a[r]=e},error:function(e){return n.error(e)},complete:function(){++o!==i&&d||(s===i&&n.next(t?t.reduce((function(e,t,n){return e[t]=a[n],e}),{}):a),n.complete())}}))},l=0;l<i;l++)r(l);else n.complete()}))}var ps=n(55822),gs=n(16169),fs=n(44923),bs=n(29567),vs=n(68477),ks=n(60655),ys=n(58028),xs=n(66081),Is=n(24713),_s=n(38194),ws=n(81407),Es=n(78146),Cs=n(44212),Us=n(86400);function Ss(e){return e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function Ns(e){const t=e.match(/(?<name>.*?)\s*<(?<email>.*?)>/);if(null==t?void 0:t.groups){const e=t.groups.email,n=t.groups.name;return(0,o.zG)(bs.G.create(e),ya.Yo((()=>"No email address found")),ya.UI((e=>({email:e,name:(0,o.zG)(n,Ss,(e=>""===e?void 0:e))}))))}return(0,o.zG)(bs.G.create(e.trim()),k.map((e=>({name:void 0,email:e}))),ya.Yo((()=>`Malformed user [${e}]`)))}function Ms(e){const t=e.includes("<")&&e.includes(">");return(0,o.zG)(t?e.split(/>\s*,\s*/):e.split(/\s*,\s*/),(e=>e.length>1&&t?e.map((e=>e+">")):e),no.hX((e=>!e.match(/^undisclosed/))),no.UI(Ns),no.IX.sequence(ya.wE))}function Ts(e){try{const t=e.split(/\n{2,}/)[0];return t?(0,o.zG)(function(e){const t=e.split(/\n+/),n=[];for(const e of t)if(/^\s+/.test(e))n.length>0&&(n[n.length-1].value+=e.trimStart());else{const t=e.match(/(.*?):\s*(.*)/);t&&t.length>=3&&n.push({header:String(t[1]).toLowerCase(),value:t[2]})}return n.reduce(((e,{header:t,value:n})=>({...e,[t]:n})),{})}(t),(e=>{var t,n,i,s;return a.Y(ya.wE)({id:(0,o.zG)(null===(n=null===(t=e["message-id"])||void 0===t?void 0:t.match(/<(.*?)>/))||void 0===n?void 0:n[1],ya.ij("No Message-ID header")),inReplyTo:ya.F2(null===(s=null===(i=e["in-reply-to"])||void 0===i?void 0:i.match(/<(.*?)>/))||void 0===s?void 0:s[1]),date:(0,o.zG)(e.date,ya.ij("No Date header"),ya.UI((e=>new Date(e)))),from:(0,o.zG)(e.from,ya.ij("No From header"),ya.tS(Ns)),to:(0,o.zG)(e.to,ya.ij("No To header"),ya.tS(Ms)),cc:(0,o.zG)(e.cc,(e=>e?Ms(e):ya.F2(void 0))),bcc:(0,o.zG)(e.bcc,(e=>e?Ms(e):ya.F2(void 0))),subject:(0,o.zG)(e.subject,ya.ij("No Subject header")),deliveredTo:(0,o.zG)(e["delivered-to"],ya.F2),replyTo:(0,o.zG)(e["reply-to"],(e=>e?Ms(e):ya.F2(void 0))),listUnsubscribe:(0,o.zG)(e["list-unsubscribe"],(e=>e?function(e){const t=(0,Us.rL)(e,/<([^<>]+)>/g,(e=>e[1]));return t.length?t:void 0}(e):void 0),ya.F2),headers:ya.F2(e)})})):ya.t$("Expected headers")}catch(e){return ya.t$(String(e))}}async function Fs(e,t,n){const i=await async function(e,t,n){var i,a,o,s;const r=(null===(a=null===(i=/^(?<url>.*?)\/?[#\?]/.exec(e))||void 0===i?void 0:i.groups)||void 0===a?void 0:a.url)||"https://mail.google.com/mail/u/0";try{const e=await fetch(`${r}/?ik=${encodeURIComponent(t)}&view=om&permmsgid=${encodeURIComponent(n)}`),i=await e.text(),a=null===(s=null===(o=/<pre[\s\S]*?id="raw_message_text"[\s\S]*?>(?<orig_msg>[\s\S]*?)<\/pre>/m.exec(i))||void 0===o?void 0:o.groups)||void 0===s?void 0:s.orig_msg;return a?ya.ij({message:"Could not decode message"})((0,ua.l_)(a.trim())):ya.t$({message:"Could not extract message from response",mimeMessageNotFound:!0})}catch(e){return ya.t$({message:String(e)})}}(n,t,e);return(0,o.zG)(i,ya.tS((e=>(0,o.zG)(Ts(e),ya.Vn((e=>({message:e})))))))}function As(e){return!!e.messageNode&&!!e.id&&void 0!==e.index}class Gs{constructor(e,t,n,i,s=Za.Y.create("Reader-Gmail-Thread-Context")){this._doc=e,this._messageList=t,this._telemetry=i,this._logger=s,this._subscriptions=new ra.w,this._state=u.h.create((0,o.zG)(function(e){const t=ya.ij(new ps.DH("Cannot find thread subject container"))(e.querySelector(ls.Av)||e.querySelector(ls.cE));return{threadId:(0,o.zG)(t,ya.tS((e=>ya.ij(new ps.DH("Cannot find thread ID"))(e.getAttribute("data-thread-perm-id"))))),subject:(0,o.zG)(t,ya.tS((e=>ya.ij(new ps.DH("Cannot find thread Subject"))(e.textContent)))),loggedUser:(0,o.zG)(ya.ij(new ps.DH("Cannot extract user from avatar"))(Ba.x.getAuthor()),ya.tS((e=>(0,o.zG)(bs.G.create(e.email),k.map((t=>({name:e.name?e.name:void 0,email:t}))),ya.Yo((()=>new ps.DH("No email address found in avatar")))))))}}(this._doc),(e=>({threadId:e.threadId,subject:e.subject,loggedUser:e.loggedUser,messageCount:Hs(this._messageList).length,expandedMessages:new Map,messageIndexToIdMap:new Map,messageNodeToIdMap:new Map})))),this.threadContext=this._state.view(),(0,o.zG)(this._state.get(),(e=>a.Y(ya.wE)({threadId:e.threadId,subject:e.subject,loggedUser:e.loggedUser})),ya.Vn((e=>{this._telemetry.readerGmail.warning("threadInfoExtraction",e.message),this._logger.warn("Static thread info extraction error",e)})));const l=Da.x.create(this._messageList,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["aria-expanded","tabindex"]}).pipe(xs.e(50),ce.O(null),ja.shareReplay({bufferSize:1,refCount:!0})).pipe(U.U((e=>{const t=Hs(this._messageList);return{nodes:t,expandedCount:t.filter(Ds).length}})),rt.x(((e,t)=>e.nodes.length===t.nodes.length&&e.expandedCount===t.expandedCount)),Is.j("nodes"));this._subscriptions.add(l.pipe(Ee.b((e=>{this._state.modify((t=>({...t,messageCount:e.length})))})),(0,o.ls)(U.U((e=>{const t=e.map(((e,t)=>({messageNode:e,index:t}))),n=t.filter((({messageNode:e})=>Ds(e))).map((({messageNode:e,index:t})=>{var n,i;return{id:null===(i=null===(n=e.querySelector(ls.k2))||void 0===n?void 0:n.getAttribute(ls.bq))||void 0===i?void 0:i.slice(1),messageNode:e,index:t}})).filter(As).reduce(((e,t)=>e.set(t.id,[t.messageNode,t.index])),new Map);return{allNodes:t.reduce(((e,t)=>e.set(t.messageNode,[t.messageNode,t.index])),new Map),expandedNodes:n}})),ce.O({allNodes:new Map,expandedNodes:new Map}),$a.G(),U.U((([e,t])=>{const n=new Set(e.expandedNodes.keys()),i=new Set(t.expandedNodes.keys()),a=Array.from(ds.e5(eo.yv)(n)(i)),o=new Set(e.allNodes.keys()),s=new Set(t.allNodes.keys()),r=Array.from(ds.e5(eo.w4)(s)(o));return{expanded:a.map((e=>{const n=t.expandedNodes.get(e);return{id:e,messageNode:null==n?void 0:n[0],index:null==n?void 0:n[1]}})).filter(As),removed:r.reduce(((e,t)=>(e.add(t),e)),new Set),all:t.allNodes}})),D.h((e=>e.expanded.length>0||e.removed.size>0))),Ee.b((e=>{const{expanded:t,removed:n,all:i}=e;t.length&&(this._logger.debug(`New message(s) expanded [${t.map((e=>e.id)).join(", ")}]`),this._state.modify((e=>{const n=(0,o.zG)(e.expandedMessages,r.UI(m.UI((e=>{var t,n;return{...e,index:null!==(n=null===(t=i.get(e.messageNode))||void 0===t?void 0:t[1])&&void 0!==n?n:e.index}})))),a=t.reduce(((e,t)=>(e.set(t.id,m.x5),e)),new Map(n)),s=t.reduce(((e,t)=>(e.set(t.messageNode,t.id),e)),new Map(e.messageNodeToIdMap)),l=Array.from(i.values()).reduce(((e,[t,n])=>(s.has(t)&&e.set(n,s.get(t)),e)),new Map);return{...e,expandedMessages:a,messageIndexToIdMap:l,messageNodeToIdMap:s}}))),n.size&&(this._logger.debug(`Message(s) removed [${Array.from(n.values()).join(", ")}]`),this._state.modify((e=>{const t=(0,o.zG)(e.expandedMessages,r.UI(m.UI((e=>{var t,n;return{...e,index:null!==(n=null===(t=i.get(e.messageNode))||void 0===t?void 0:t[1])&&void 0!==n?n:e.index}}))),r.hX((e=>!(m.d6(e)&&n.has(e.value.messageNode))))),a=Array.from(n.values()).reduce(((e,t)=>(e.delete(t),e)),new Map(e.messageNodeToIdMap)),s=Array.from(i.values()).reduce(((e,[t,n])=>a.has(t)?e.set(n,a.get(t)):e),new Map);return{...e,expandedMessages:t,messageIndexToIdMap:s,messageNodeToIdMap:a}})))})),Is.j("expanded"),D.h((e=>e.length>0)),Ya.zg(n),Ee.b((({message:{id:e,messageNode:t,index:n},context:i})=>{this._state.modify((a=>({...a,expandedMessages:new Map(a.expandedMessages).set(e,(0,o.zG)(i,ya.g_((t=>{const n=`Could not extract context for #${e}: ${String(t)}`;return this._logger.warn(n),m.kH(new ps.DH(n))}),(i=>(0,o.zG)(k.fromNullable(t.querySelector(ls.xR)),k.filter(Va.Re),k.fold((()=>{const n=`Could not find message body for #${e}`;return this._logger.warn(n,t),m.kH(new ps.DH(n))}),(a=>{this._logger.trace(`Message #${e} extracted`),this._logger.trace(`Got ${i.links.length} links`);const s=Os(a);return m.Vp({id:e,index:n,messageNode:t,bodyNode:a,context:i,textMap:s,semanticInformation:{...i.semanticInformation,...(0,o.zG)(Ls(a),(e=>void 0!==e?{textTableCoverage:e}:{}))}})})))))))})))}))).subscribe())}dispose(){this._subscriptions.unsubscribe()}}function Ls(e){const t=[];e.querySelectorAll("table").forEach((e=>{0!==t.length&&t[t.length-1].contains(e)||t.push(e)}));const n=e.innerText.replace(/\s+/g,""),i=t.map((e=>e.innerText.replace(/\s+/g,"")));let a=n;for(const e of i)a=a.replace(e,"");const o=Math.max(0,Math.min(1,(n.length-a.length)/n.length));return Number.isNaN(o)?void 0:o}function Os(e){return new gs.Z(e,((e,t)=>gs.Z.defaultFilterNodeAllowList(["PRE","CODE","BLOCKQUOTE"])(e,t)&&!fs.W.maybeGmailHistoryQuote(e)),void 0,gs.Z.isBlockNodeFromTagList((0,o.zG)(new Set(gs.Z.blockTags),ds.Od(eo.yv)("CODE"))),void 0,void 0,fs.W.gmailNodeFormatting,void 0,void 0,!1)}function zs(e){return a.Y(ya.wE)({email:(0,o.zG)(ya.ij(new ps.DH("No email found"))(null==e?void 0:e.getAttribute("email")),ya.tS((e=>ya.Yo((()=>new ps.DH("Invalid email address")))(bs.G.create(e))))),name:(0,o.zG)(ya.ij(new ps.DH("No name found"))(null==e?void 0:e.getAttribute("name")),ya.UI((e=>e||void 0)))})}function Ks(e,t,n=6e3){return i=>ba.T(...e.map((e=>{return i.pipe(D.h((t=>t.message.id===e.id)),(a=n,e=>{const t=e.pipe(_s.B()),[n,i]=ws.u(t,((e,t)=>0===t));return ba.T(n.pipe(ss.V(a),ut.q(1)),i)}),rs.K((n=>T.of({message:e,context:ya.t$(new ps.DH(t+((0,vs.H)(n)?` [${n.message}]`:"")))}))));var a})))}function Ps(e,t,n,i,s,r=5){return l=>{const{left:d,right:c}=(0,o.zG)(l,no.uK(i));return ba.T((0,o.zG)(d,Rs(e),Ks(d,"DOM-only extraction timeout")),ba.T((0,o.zG)(c,Rs(e),Ks(c,"DOM extraction timeout"),U.U((e=>({...e,kind:"fromDOM"})))),(0,o.zG)(c,function(e,t,n,i=5){const a=new _e.xQ,s=new Map;return r=>ba.T(T.of(r),a).pipe(lt.w((e=>va.D(e.reduce(((e,t)=>(e.length>0&&e[e.length-1].length<i?e[e.length-1].push(t):e.push([t]),e)),[])))),we.M(e),Ja.b((([e,n])=>function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=e[0];if((0,ms.k)(n))return hs(n,null);if((0,us.K)(n)&&Object.getPrototypeOf(n)===Object.prototype){var i=Object.keys(n);return hs(i.map((function(e){return n[e]})),i)}}if("function"==typeof e[e.length-1]){var a=e.pop();return hs(e=1===e.length&&(0,ms.k)(e[0])?e[0]:e,null).pipe((0,U.U)((function(e){return a.apply(void 0,e)})))}return hs(e,null)}(e.map((e=>va.D(Fs(e.id,n,t())).pipe(U.U((t=>({message:e,headers:t}))))))))),Ja.b((e=>e)),lt.w((({message:e,headers:t})=>(0,o.zG)(t,ya.g_((t=>{n.warn(`Error accessing MIME headers for #${e.id}:`,t.message);const i=s.get(e.id)||0,o=1;return t.mimeMessageNotFound&&i<o?(n.warn(`Retrying to fetch MIME headers for #${e.id}`),s.set(e.id,i+1),a.next([e]),qa.E):T.of({message:e,context:ya.t$(new ps.DH(t.message))})}),(t=>T.of({message:e,context:ya.F2({date:{kind:"parsedDate",timestamp:t.date.getTime()},author:t.from,audience:t.to.concat(t.cc||[]).concat(t.bcc||[]),replyTo:t.replyTo||[],links:[],isFromMailingList:!!t.listUnsubscribe,semanticInformation:{isWholeHTMLDocument:/^text\/html\b/.test(t.headers["content-type"])}})})))))))}(t,n,s,r),Ks(c,"MIME headers extraction timeout"),U.U((e=>({...e,kind:"fromHeaders"}))))).pipe(Es.v((e=>e.message.id)),Ya.zg((e=>e.pipe(Ee.b((e=>(0,o.zG)(e.context,ya.Vn((t=>s.warn(`Context extraction error [${e.kind}] for ${e.message.id}`,t)))))),Xa.R(((e,t)=>({...e,message:t.message,[t.kind]:t.context})),{}),D.h((e=>!!(null==e?void 0:e.message)&&!!(null==e?void 0:e.fromDOM)&&!!(null==e?void 0:e.fromHeaders))),U.U((e=>(0,o.zG)(a.Y(ya.wE)({fromDOM:e.fromDOM,fromHeaders:e.fromHeaders}),ya.UI((({fromDOM:e,fromHeaders:t})=>(0,ys.RH)(e,t))),ya.wp((()=>e.fromDOM)),ya.wp((()=>e.fromHeaders)),(t=>({message:e.message,context:t})))))))))).pipe(Ee.b((e=>(0,o.zG)(e.context,ya.g_((t=>s.warn(`Context extraction error for ${e.message.id}`,t)),(t=>s.info(`Context extracted for ${e.message.id}`,t)))))))}}function Rs(e){return t=>T.of(t).pipe(Cs.u(),Ya.zg((t=>{var n;const i=(0,o.zG)(ya.ij(new ps.DH("No message date found"))(null===(n=t.messageNode.querySelector(ls.ms))||void 0===n?void 0:n.getAttribute("title")),ya.UI((t=>(0,o.zG)(new Date(t),(n=>{var i;return Number.isNaN(n.valueOf())?{kind:"unparsedDate",date:t,locale:(null===(i=e.querySelector(ls.Gg))||void 0===i?void 0:i.getAttribute(ls.sC))||void 0}:{kind:"parsedDate",timestamp:n.getTime()}}))))),a=(0,o.zG)(ya.ij(new ps.DH("No message author found"))(t.messageNode.querySelector(ls.OL)),ya.tS(zs)),s=(0,o.zG)(ya.ij(new ps.DH("No <to> field found in message"))(t.messageNode.querySelectorAll(ls.VN)),ya.tS((e=>(0,o.zG)(Array.from(e),no.UI(zs),no.IX.sequence(ya.wE))))),r=(0,o.zG)(t.messageNode.querySelector(ls.hZ),(e=>ya.F2(!!e)));return ae.aj([T.of({message:t,date:i,author:a,audience:s,isFromMailingList:r}),(l=t.messageNode,ae.aj([T.of(Vs(l)),(0,o.zG)(Array.from(l.querySelectorAll(ls.Mz)).map(qs),(e=>e.length>0?ae.aj(e):T.of([])))]).pipe(U.U((([e,t])=>Array.from(e.concat(t).reduce(((e,t)=>e.set(t.url,t)),new Map).values())))))]);var l})),U.U((([{message:e,date:t,author:n,audience:i,isFromMailingList:o},s])=>({message:e,context:a.Y(ya.wE)({date:t,author:n,audience:i,replyTo:ya.F2([]),links:ya.F2(s),isFromMailingList:o})}))))}function Hs(e){return Array.from(e.children).filter(Bs)}function Bs(e){return e instanceof HTMLDivElement&&(e.matches("[aria-expanded]")&&!!e.innerText||!e.matches("[aria-expanded]"))}function Ds(e){return e instanceof HTMLDivElement&&e.matches('[tabindex="-1"]')&&!!e.innerText}function Vs(e){return(0,o.zG)(Array.from(e.querySelectorAll(ls.rf)),no.DZ((0,o.ls)(k.fromPredicate((e=>!e.closest(ls.A4)&&!e.matches(ls.wJ))),k.chain((e=>(0,o.zG)(pa.A.create(e.getAttribute("href")),k.map((t=>({url:t,name:e.innerText,type:t.startsWith("mailto:")?ma.Q.email:ma.Q.hyperlink})))))))))}function Zs(e){return(0,o.zG)(k.fromNullable(e),k.chain((e=>k.fromNullable(/^([^:]+):([^:]+):(https?:\/\/.+)?(https?:\/\/.+)$/.exec(e)))),k.chain((([e,t,n,i,a])=>(0,o.zG)(pa.A.create(a),k.map((e=>({name:decodeURIComponent(n),url:e,type:ma.Q.attachment,mimeType:k.toUndefined(ks.I.create(t))})))))))}function js(e){return(0,o.zG)(pa.A.create(e.getAttribute("href")),k.map((t=>{var n;return{name:e.getAttribute("data-tooltip")||(null===(n=e.querySelector("div"))||void 0===n?void 0:n.innerText)||e.innerText,url:t,type:ma.Q.attachment,mimeType:void 0}})))}function qs(e,t=4e3){return(0,o.zG)(e.getAttribute("href")||"",k.fromPredicate((e=>!/^https?:\/\/docs\.google\.[^./]+\//.test(e))),k.map((n=>new cs.y((t=>{var n;(0,o.zG)(k.fromNullable(null===(n=e.parentElement)||void 0===n?void 0:n.getAttribute("download_url")),k.filter((e=>!!e)),k.fold((()=>t.error("Attachment not found")),(()=>{t.next(!0),t.complete()})))})).pipe((0,ua.WV)(t/200,200),ss.V(t),rs.K((()=>T.of(!1))),U.U((t=>{var n;return(0,o.zG)(k.fromNullable(null===(n=e.parentElement)||void 0===n?void 0:n.getAttribute("download_url")),k.chain(Zs),k.alt((()=>js(e))))}))))),k.getOrElse((()=>T.of(js(e)))),M.oA)}function Ws(e){const t=null===e.querySelector(ls.Py);return Array.from(e.querySelectorAll(t?ls.KL:ls.Py)).filter(Ds).length}var $s;function Qs(e){const t=e.querySelector(ls.bK)||e.querySelector(ls.Gc),n=t?Hs(t).length:0;if(!t||0===n)return T.of(ya.t$("No messages"));if(Ws(e)===n)return T.of(ya.F2($s.noExpansionNeeded));const i=e.querySelector(ls.p4)||e.querySelector(ls.Vz);return null==i||i.click(),(0,o.zG)((a=t,os.rl(a,{subtree:!0,childList:!1,attributes:!0,attributeFilter:["role","aria-expanded"]}).pipe(ce.O(null))),Qa.b(10),D.h((()=>Ws(e)===n)),ss.V(3e3),ut.q(1),Wa.h(ya.F2($s.expanded)),rs.K((e=>T.of(ya.t$(e.message)))));var a}!function(e){e.expanded="expanded",e.noExpansionNeeded="noExpansionNeeded"}($s||($s={}));var Js=n(35214),Ys=n(32426),Xs=n(45701),er=Js.getFunctionMonoid(k.getApplyMonoid({concat:(0,Ys.getJoinSemigroup)(Xs.ordNumber).concat,empty:0}))();function tr(e){return function(t){return t.iterNumber>=e?k.none:k.some(0)}}function nr(e){return function(t){return k.some(e*Math.pow(2,t.iterNumber))}}var ir={iterNumber:0,cumulativeDelay:0,previousDelay:k.none};var ar=er,or=n(2788);class sr{constructor(e){this._rpc=e,this.getReaderAnnotations=this._rpc.getReaderAnnotations,this.getReaderSummaries=this._rpc.getReaderSummaries,this.sendReaderEvents=this._rpc.sendReaderEvents,this.sendReaderSurvey=this._rpc.sendReaderSurvey}}var rr=n(99596),lr=n(99950),dr=n(62965);function cr(e,t,n){var i=Js.fold(ar)(t);return cs.y.create((function(t){var a=!1,o=function(s){return(0,So.pipe)(dr.dk((function(){return t.next(m.x5)})),dr.a1(e),dr.g_((function(e){var r=!a&&n(e)?function(e,t){var n=e(t);return{iterNumber:t.iterNumber+1,cumulativeDelay:t.cumulativeDelay+k.getOrElse((function(){return 0}))(n),previousDelay:n}}(i,s):ir;return(0,So.pipe)(r.previousDelay,k.fold((function(){return dr.t$(e)}),(function(n){return t.next(m.vU(e,{cumulativeDelay:r.cumulativeDelay,iterNumber:r.iterNumber,previousDelay:n})),(0,So.pipe)(dr.F2(r),lr.delay(n),dr.tS((function(t){return a?dr.t$(e):o(t)})))})))}),dr.F2))};return(0,So.pipe)(o(ir),dr.Pd((function(e){return t.next(m.kH(e))}),(function(e){return t.next(m.Vp(e))})))().then((function(){return t.complete()}),(function(e){return t.error(e)})),function(){return a=!0}}))}var mr=n(17160);class ur{constructor(e,t,n,i,a,o=d.O,s,r=Za.Y.create("Reader-Gmail-Feedback-Manager")){this._actions=e,this._threadRemoteDataManager=t,this._threadContext=n,this._sessionUuid=i,this._featuresAndExperiments=a,this._getEnv=o,this._telemetry=s,this._logger=r,this._subscriptions=new ra.w,this._rpcClient=(0,ha.Vo)((()=>new sr(this._getEnv().bgRpc.api))),this._subscriptions.add(this._handleUIEvents()),this._subscriptions.add(this._handleSubmitFeedbackEvents())}_handleSubmitFeedbackEvents(){return this._actions.pipe(B.ofType(H.Kind.submitFeedback),D.h((()=>this._featuresAndExperiments.features.has("feedbackDialog"))),Ya.zg((0,o.ls)(H.matchSubmitFeedback({itemMenu:hr,collapsedPanelButton:pr,expandedPanelHeaderButton:pr,emptyViewButton:pr}),(e=>a.Y(ya.wE)({threadId:this._threadContext.get().threadId,reader:(0,o.zG)(this._threadContext.get().loggedUser,ya.UI(or.R)),feedback:ya.F2(e)})),ya.UI((({threadId:e,reader:t,feedback:n})=>({threadId:e,features:Array.from(this._featuresAndExperiments.features),readerExperiment:this._featuresAndExperiments.experimentNames[0],sessionUuid:this._sessionUuid,reader:t,feedback:n,supportsFilteredContent:this._featuresAndExperiments.features.has("filteredContent")}))),ya.g_((e=>T.of(m.kH(e))),(e=>cr((()=>this._rpcClient.get().sendReaderSurvey(e)),[tr(3),nr(5e3)],(e=>e instanceof rr.Lu||e instanceof rr.Bb&&e.code>=500))))))).subscribe(m.g_({onInProgress:o.Q1,onSuccess:o.Q1,onError:o.Q1,onFatal:e=>{this._logger.warn("Survey error",e),this._telemetry.readerGmail.warning("feedback","Survey error",e)}}))}_handleUIEvents(){return this._actions.pipe(D.h((0,v.Kg)((0,v.W9)((0,v.Kg)(H.is(H.Kind.copy),H.is(H.Kind.pin),H.is(H.Kind.dismiss),H.is(H.Kind.itemMounted)),(0,v.Kg)(H.itemTypeIs("summaryItem"),H.itemTypeIs("followUpItem"))),H.is(H.Kind.like),H.is(H.Kind.dislike),H.is(H.Kind.check))),D.h((()=>this._featuresAndExperiments.features.has("feedbackEvents"))),U.U((e=>({type:e.kind===H.Kind.itemMounted?"show":e.kind!==H.Kind.pin||e.pinned?e.kind!==H.Kind.check||e.checked?e.kind:"uncheck":"unpin",emailText:(e.kind,void H.Kind.itemMounted),subject:e.kind===H.Kind.check?"followUpItem":e.itemType,id:e.item.itemId,itemText:e.item.text,messageId:e.item.message.id}))),U.U((e=>"show"===e.type?{...e,filteringInfo:gr(this._threadRemoteDataManager,e.messageId,e.subject)}:e)),mr.e(100),D.h((e=>e.length>0)),Ya.zg((e=>(0,o.zG)(a.Y(ya.wE)({threadId:this._threadContext.get().threadId,reader:(0,o.zG)(this._threadContext.get().loggedUser,ya.UI(or.R))}),ya.UI((({threadId:t,reader:n})=>({threadId:t,features:Array.from(this._featuresAndExperiments.features),readerExperiment:this._featuresAndExperiments.experimentNames[0],sessionUuid:this._sessionUuid,reader:n,events:e,supportsFilteredContent:this._featuresAndExperiments.features.has("filteredContent")}))),ya.g_((e=>T.of(m.kH(e))),(e=>cr((()=>this._rpcClient.get().sendReaderEvents(e)),[tr(3),nr(5e3)],(e=>e instanceof rr.Lu||e instanceof rr.Bb&&e.code>=500)))))))).subscribe(m.g_({onInProgress:o.Q1,onSuccess:o.Q1,onError:o.Q1,onFatal:e=>{this._logger.warn("Feedback error",e),this._telemetry.readerGmail.warning("feedback","Feedback error",e)}}))}dispose(){this._subscriptions.unsubscribe()}}function hr(e){return{type:"tellUsMoreFeedback",feedbackText:e.text,messageId:e.source.item.message.id,subject:e.source.itemType,action:e.source.action,id:e.source.item.itemId,itemText:e.source.item.text}}function pr(e){return{type:"genericFeedback",placement:e.source.kind,feedbackText:e.text,score:(0,o.zG)(e.scoreResult,k.map((e=>e.score)),k.toUndefined),scoreLabel:(0,o.zG)(e.scoreResult,k.map((e=>e.label)),k.toUndefined)}}function gr(e,t,n){return"followUpItem"===n?(0,o.zG)(e.annotations.get().get(t),m.g_({onInProgress:o.r5,onSuccess:(0,o.ls)(k.chain((e=>e.filteringInfo)),k.toUndefined),onFatal:o.r5,onError:o.r5})):"summaryItem"===n?(0,o.zG)(e.summaries.get().get(t),m.g_({onInProgress:o.r5,onSuccess:(0,o.ls)(k.chain((e=>e.filteringInfo)),k.toUndefined),onFatal:o.r5,onError:o.r5})):void(0,V.vE)(n)}var fr=n(41263),br=n(86620),vr=n(92132),kr=n(33678),yr=n(15073),xr=n(42103),Ir=n(64078);const _r=({env:e,children:t,className:n})=>f.createElement(ns.o,{className:n},f.createElement(Xo.p,null,f.createElement(kr.a.Context.Provider,{value:new br.C(e)},f.createElement(vr.Q,{remSize:T.of(16),setter:e=>yr.u.setRootCssVar(document.documentElement,e)},f.createElement(xr.G.DefaultProvider,null,t,f.createElement(ts.p,{regular:!0,bold:!0}),f.createElement(es.G,null),f.createElement(Ir.X,null))))));var wr=n(16782);const Er=`${ls.k2} > div + div`;class Cr{constructor(e,t,n,i=Za.Y.create("Reader-Gmail-Panel")){this._logger=i,this._mounted=new wr.t(1),this.elementRef=f.createRef(),this.mounted=this._mounted.asObservable(),this._injectionSub=e.pipe(lt.w((e=>new cs.y((()=>(0,o.zG)(k.fromNullable(e.querySelector(Er)),k.filter((e=>e instanceof HTMLElement)),k.fold((()=>o.Q1),(e=>{const i=zo.VB.get({monitorAs:"reader-panel"}).inject(Ko.EM.fromDocument(e.ownerDocument,"grammarly-extension"),Ko.zs.appendChild(e),(()=>f.createElement(fr.L,{chunkName:"readerGmailThreadIntegration"},f.createElement(_r,{env:(0,d.O)()},f.createElement("div",{style:{marginTop:"2rem"},ref:this.elementRef},f.createElement(t,null),n?f.createElement(n,null):null)))));return this._mounted.next(),this._logger.debug("Panel injected"),()=>{i.dispose(),this._logger.debug("Panel disposed")}})))))))).subscribe()}dispose(){this._injectionSub.unsubscribe()}}var Ur=n(77150);class Sr{constructor(e,t,n,i=d.O,a,s=Za.Y.create("Reader-Gmail-Remote-Data")){this._threadContext=e,this._features=t,this._useCaching=n,this._getEnv=i,this._telemetry=a,this._logger=s,this._subscriptions=new ra.w,this._rpcClient=(0,ha.Vo)((()=>new sr(this._getEnv().bgRpc.api))),this._summariesToFetch=new _e.xQ,this._annotationsToFetch=new _e.xQ,this._summariesReadyToFetch=new _e.xQ,this._annotationsReadyToFetch=new _e.xQ,this._summaries=u.h.create(new Map),this._annotations=u.h.create(new Map),this.summaries=this._summaries.view(),this.annotations=this._annotations.view(),this._subscriptions.add(this._summariesToFetch.pipe(Nr(this._threadContext)).subscribe((e=>this._summariesReadyToFetch.next(e)))),this._subscriptions.add(this._annotationsToFetch.pipe(Nr(this._threadContext)).subscribe((e=>this._annotationsReadyToFetch.next(e)))),this._subscriptions.add(this._summariesReadyToFetch.pipe(Ya.zg((e=>this._getSummaries(e).pipe(U.U((t=>({requestedIds:e,response:t}))))))).subscribe((({requestedIds:e,response:t})=>{this._summaries.modify((n=>Array.from(e).reduce(((e,i)=>e.set(i,(0,o.zG)(m.n2(t)?(0,o.zG)(k.fromNullable(n.get(i)),k.getOrElse((()=>m.x5))):t,m.UI((e=>k.fromNullable(e[i])))))),new Map(n))))}))),this._subscriptions.add(this._annotationsReadyToFetch.pipe(Ya.zg((e=>this._getAnnotations(e).pipe(U.U((t=>({requestedIds:e,response:t}))))))).subscribe((({requestedIds:e,response:t})=>{this._annotations.modify((n=>Array.from(e).reduce(((e,i)=>e.set(i,(0,o.zG)(m.n2(t)?(0,o.zG)(k.fromNullable(n.get(i)),k.getOrElse((()=>m.x5))):t,m.UI((e=>k.fromNullable(e[i])))))),new Map(n))))})))}fetchSummaries(e){this._logger.debug(`requesting summaries for [${String(Array.from(e))}]`),this._summariesToFetch.next(e)}fetchAnnotations(e){this._logger.debug(`requesting annotations for [${String(Array.from(e))}]`),this._annotationsToFetch.next(e)}dispose(){this._subscriptions.unsubscribe()}_getThreadInfoForBackend(){return(0,o.zG)(this._threadContext.get(),(e=>a.Y(ya.wE)({id:e.threadId,subject:e.subject,messageCount:ya.F2(e.messageCount),messages:ya.F2(Array.from(e.expandedMessages.values()).filter(m.d6).map((e=>e.value))),loggedUser:e.loggedUser})),ya.UI((e=>({...e,messages:e.messages.reduce(((t,n)=>(t[n.id]={id:n.id,index:n.index,subject:e.subject,body:n.textMap.getRichText(),plainText:n.textMap.getPlainText(),date:n.context.date,author:n.context.author,audience:n.context.audience,replyTo:n.context.replyTo,semanticInformation:n.semanticInformation,links:n.context.links,isFromMailingList:n.context.isFromMailingList},t)),{})}))))}_getSummaries(e){return(0,o.zG)(this._getThreadInfoForBackend(),ya.g_((e=>T.of(m.kH(e))),(t=>cr((()=>(this._logger.debug(`Fetching summaries for [${String(Array.from(e))}]`),this._rpcClient.get().getReaderSummaries({thread:{id:t.id,subject:t.subject,messages:(0,o.zG)(t.messages,l.u4({},((e,t)=>(e[t.index]=(0,ca.fH)(t),e)))),num_messages:t.messageCount},reader:(0,or.R)(t.loggedUser),requestedMessageIds:Array.from(e),useCache:this._useCaching.get(),supportsFilteredContent:this._features.has("filteredContent")}).then((e=>((0,o.zG)(e,ya.Pd((e=>{this._telemetry.readerGmail.warning("summariesResponse",e.message,e),this._logger.warn("Summaries error",e.message)}),(e=>{this._logger.debug("Received summaries",e)}))),e))))),[tr(3),nr(5e3)],(e=>e instanceof rr.Lu||e instanceof rr.Bb&&e.code>=500)))))}_getAnnotations(e){return(0,o.zG)(this._getThreadInfoForBackend(),ya.g_((e=>T.of(m.kH(e))),(t=>cr((()=>(this._logger.debug(`Fetching annotations for [${String(Array.from(e))}]`),this._rpcClient.get().getReaderAnnotations({thread:{id:t.id,subject:t.subject,messages:(0,o.zG)(t.messages,l.u4({},((e,t)=>(e[t.index]=(0,ca.fH)(t),e)))),num_messages:t.messageCount},reader:(0,or.R)(t.loggedUser),requestedMessageIds:Array.from(e),useCache:this._useCaching.get(),supportsFilteredContent:this._features.has("filteredContent")}).then((e=>((0,o.zG)(e,ya.Pd((e=>{this._telemetry.readerGmail.warning("annotationsResponse",e.message,e),this._logger.warn("Annotations error",e.message)}),(e=>{this._logger.debug("Received annotations",e)}))),e))).then(ya.UI((0,o.ls)(l.Su(((e,n)=>{var i;const a=null===(i=t.messages[e])||void 0===i?void 0:i.plainText;return{...n,annotations:void 0!==a?n.annotations.map((e=>({...e,text:a.slice(e.span.s,e.span.e)}))):[]}}))))))),[tr(3),nr(5e3)],(e=>e instanceof rr.Lu||e instanceof rr.Bb&&e.code>=500)))))}}function Nr(e){return t=>{const n=new _e.xQ;return(0,o.zG)(t,Ja.b((e=>va.D(Array.from(e)))),Ya.zg((t=>e.pipe(U.U((e=>(0,o.zG)(k.fromNullable(e.expandedMessages.get(t)),k.fold(o.jv,m.d6)))),D.h(ha.fQ),ut.q(1),Wa.h(t)))),Ee.b((()=>n.next())),Ur.R((()=>n.pipe(Qa.b(200)))),U.U((e=>new Set(e))),D.h((e=>e.size>0)))}}function Mr(e,t,n,m,h,p,f,y,x,_=d.O,w=Za.Y.create("Reader-Gmail-Thread-Integration")){const C=ha.iy.create(),S=new Gs(h.doc,e,Ps(h.doc,t,(()=>h.url),(e=>0===e.index),w),x),F=new Sr(S.threadContext,n.features,m,_,x),A=u.h.create(null),G=A.pipe(lt.w((e=>e?e.annotations:T.of([])))),O=(z=n.features).has("summaries")||z.has("followUps")||z.has("links")?new Ta(i.create(S.threadContext,F.summaries,F.annotations),G.pipe(U.U((e=>e.length>0))),h.config.bundleInfo.browser,y,C,n.features,p):null;var z;const K=O?new sa.ViewModelImpl(p,y,C,S.threadContext):null,R=p.view((({inlineHighlightsEnabled:t})=>{A.modify((i=>(null==i||i.dispose(),!1!==t&&K&&(n.features.has("inlineCards")||n.features.has("inlineHighlights"))?new as(ae.aj([F.annotations,p.view((e=>(0,o.zG)(S.threadContext.get().threadId,k.fromEither,k.chain((t=>{var n,i;return(0,o.zG)(k.fromNullable(null===(i=null===(n=e.threadState)||void 0===n?void 0:n[t])||void 0===i?void 0:i.annotations),k.map((0,o.ls)(l.UI((0,o.ls)((e=>g.X.decode(e)),k.fromEither)),l.oA,l.u4(new Set,((e,t)=>t.dismissed?e.add(t.itemId):e)))))})),k.getOrElse((()=>new Set)))))]).pipe(we.M(S.threadContext),U.U((([[e,t],n])=>(0,o.zG)(e,r.Su(((e,i)=>(0,o.zG)(a.Y(k.option)({annotations:(0,o.zG)(i,ua.zk,k.flatten,k.map(b.ei("annotations")),k.map(s.hX((e=>!t.has(g.p.Id.create(e.id))))),k.chain(at.nI)),message:(0,o.zG)(k.fromNullable(n.expandedMessages.get(e)),k.chain(ua.zk))}),k.map((({annotations:e,message:t})=>({messageId:t.id,textMap:t.textMap,bodyNode:t.bodyNode,annotations:e})))))),r.DZ(o.yR))))),e,n.features,K):null)))})).subscribe(),B=new _e.xQ,Z=e=>t=>{const n=`${e} promise rejection: ${String(t)}`;w.error(n),x.readerGmail.warning("promiseRejection",n,t)},j=O&&K?function(e,t,n,i){const a=new ra.w;return a.add(t.pipe(D.h(H.is(H.Kind.seenInlineHighlightsOnboarding))).subscribe((()=>{n.seenReaderInlineHighlightsOnboarding().catch(i("CSActions.seenReaderInlineHighlightsOnboarding"))}))),a.add(e.pipe(D.h(H.is(H.Kind.inlineHighlightOnboardingElementMounted))).subscribe((({step:e,node:n})=>t.next({kind:H.Kind.inlineHighlightOnboardingElementMounted,step:e,node:n})))),a}(O.actions,K.actions,f,Z):null,q=O?function(e,t,n,i,a){const s=new ra.w,r=e=>(0,o.zG)(n.get().threadId,k.fromEither,kt.bw(e));return s.add(e.pipe(D.h((0,v.Kg)(H.is(H.Kind.optIn),H.is(H.Kind.optOut)))).subscribe((({kind:e})=>{t.seenReaderGmailOnboarding(e).catch(a("CSActions.seenReaderGmailOnboarding"))}))),s.add(e.pipe(D.h(H.is(H.Kind.threadViewNavigate))).subscribe((({action:e,nextIndex:t})=>i.next({nextActiveIndex:t,navigationAction:e})))),s.add(e.pipe(D.h((0,v.Kg)(H.is(H.Kind.check),(0,v.W9)((0,v.Kg)(H.is(H.Kind.pin),H.is(H.Kind.dismiss),H.is(H.Kind.like),H.is(H.Kind.dislike)),H.itemTypeIs("followUpItem")))),U.U((e=>e.kind===H.Kind.check?{...e.item,checked:e.checked}:Tr(e)))).subscribe((e=>r((n=>{t.readerGmailUpdateAnnotationItem({threadId:n,item:e}).catch(a("CSActions.readerGmailUpdateAnnotationItem"))}))))),s.add(e.pipe(D.h((0,v.W9)((0,v.Kg)(H.is(H.Kind.pin),H.is(H.Kind.dismiss),H.is(H.Kind.like),H.is(H.Kind.dislike)),H.itemTypeIs("summaryItem"))),U.U(Tr)).subscribe((e=>r((n=>{t.readerGmailUpdateSummaryItem({threadId:n,item:e}).catch(a("CSActions.readerGmailUpdateSummaryItem"))}))))),s.add(e.pipe(D.h((0,v.W9)((0,v.Kg)(H.is(H.Kind.pin),H.is(H.Kind.dismiss)),H.itemTypeIs("linkItem"))),U.U(Tr)).subscribe((e=>r((n=>{t.readerGmailUpdateLinkItem({threadId:n,item:e}).catch(a("CSActions.readerGmailUpdateLinkItem"))}))))),s.add(e.pipe(D.h(H.is(H.Kind.toggleInlineHighlights))).subscribe((({enabled:e})=>{t.toggleReaderInlineHighlights(e).catch(a("CSActions.toggleReaderInlineHighlights"))}))),s}(O.actions.asObservable(),f,S.threadContext,B,Z):null,W=new ur((null==O?void 0:O.actions)||qa.E,F,S.threadContext,C,n,_,x),$=O?new Cr(S.threadContext.view((e=>e.messageCount)).pipe(U.U((()=>{const t=Hs(e);return k.fromNullable(t[t.length-1])})),M.oA,rt.x()),(()=>{return N.UI.mount(na,(e=O,N.Z.composeKnot({content:N.Z.composeUnion({collapsed:$e(e),expanded:Fi(e),onboarding:ea(e)},(()=>e.state.pipe(U.U((e=>({kind:E(e)?"onboarding":I(e)?"expanded":"collapsed"})))))),notification:X(e)})));var e}),K?()=>N.UI.mount(ia.Onboarding,ia.createFlow(K)):void 0):null,Q=B.pipe(lt.w((()=>Qs(h.doc))),Ee.b(ya.Pd((e=>w.warn("Error while expanding messages",e)),(e=>{switch(e){case $s.expanded:return w.trace("Messages expanded");case $s.noExpansionNeeded:return w.trace("Thread already expanded");default:(0,V.vE)(e)}}))),ja.shareReplay({bufferSize:1,refCount:!0})),J=S.threadContext.pipe(ut.q(1),Ee.b((e=>{y.readerMailSessionStart(e.messageCount,C,(0,o.zG)(e.threadId,k.fromEither,k.toUndefined))}))).subscribe(),Y=(0,c.W$)(e),ee=Y?ba.T(B.pipe(U.U((e=>{var t;return(null===(t=null==$?void 0:$.elementRef)||void 0===t?void 0:t.current)?$.elementRef.current.getBoundingClientRect().top:null}))),Q.pipe(Wa.h(null))).pipe($a.G()).subscribe((([e,t])=>{var n;if((null===(n=null==$?void 0:$.elementRef)||void 0===n?void 0:n.current)&&null===t&&null!==e){const t=$.elementRef.current.getBoundingClientRect().top;Y.scrollTop=Y.scrollTop+t-e}})):null,te=Q.subscribe(),ne=p.pipe(lt.w((e=>e.seenOnboarding?T.of(!!e.enabled):p.pipe(D.h((e=>!!e.seenOnboarding)),U.U((e=>!!e.enabled))))),ut.q(1)),ie=n.features.has("summaries")&&$?ba.T(B,$.mounted.pipe(U.U((e=>({nextActiveIndex:1/0,navigationAction:L.last}))),(0,ua.Gx)(ne))).pipe(Qa.b(100),Ja.b((({nextActiveIndex:e,navigationAction:t})=>{const n=S.threadContext.get().messageCount,i=e=>e>=0&&e<n;switch(t){case L.left:return va.D([e-1,e].filter(i));case L.right:return va.D([e,e+1].filter(i));case L.first:return va.D([0,1].filter(i));case L.last:return va.D([n-2,n-1].filter(i));default:(0,V.vE)(t)}})),Ya.zg((e=>S.threadContext.view((t=>t.messageIndexToIdMap.get(e))).pipe(D.h(ha.fQ),ut.q(1)))),Xa.R(((e,t)=>new Set(e).add(t)),new Set),(0,ua.Yp)(eo.yv)).subscribe((e=>F.fetchSummaries(e))):null,oe=n.features.has("followUps")||n.features.has("inlineCards")||n.features.has("inlineHighlights")?S.threadContext.view((e=>new Set(e.messageIndexToIdMap.values()))).pipe(Xa.R(((e,t)=>new Set(Array.from(e).concat(Array.from(t)))),new Set),(0,ua.Yp)(eo.yv),(0,ua.Gx)(ne)).subscribe((e=>F.fetchAnnotations(e))):null;"prod"!==h.config.bundleInfo.env&&(0,ua.h$)(h.doc,{threadContextManager:S,threadRemoteDataManager:F,panelViewModel:O});const se=Date.now(),re=ba.T(Da.x.create(e,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["contenteditable"]}).pipe(U.U((e=>k.fromNullable(e.reduce(((e,t)=>null!==e?e:"attributes"==t.type&&(0,Va.Re)(t.target)?t.target.matches(ls.kO)?t.target:null:Array.from(t.addedNodes).filter(Va.Re).reduce(((e,t)=>null!==e?e:t.matches(ls.kO)?t:t.querySelector(ls.kO)),null)),null))))),va.D(Array.from(e.querySelectorAll(ls.kO)).map(k.some))).pipe(M.oA,rt.x(),U.U((e=>(0,o.zG)(k.fromNullable(e.closest(ls.e8)),k.chain((t=>{var n,i;return a.Y(k.option)({formEl:k.fromNullable(null===(n=t.closest(ls.KC))||void 0===n?void 0:n.querySelector(ls.ZA)),buttonEl:k.fromNullable(t.querySelector(ls.DM)),messageId:(0,o.zG)(k.fromNullable(null===(i=e.closest(ls.n4))||void 0===i?void 0:i.querySelector(ls.k2)),k.chain((e=>{var t;return k.fromNullable(null===(t=e.getAttribute(ls.bq))||void 0===t?void 0:t.slice(1))}))),startTime:k.some(Date.now()-se)})}))))),M.oA,we.M(S.threadContext),Ee.b((([e,t])=>{y.readerMailReplyStart(C,Date.now()-se,(0,o.zG)(t.threadId,k.fromEither,k.toUndefined)),null==O||O.actions.next({kind:H.Kind.expand,source:P.replyButton})})),Ya.zg((([e])=>Qe.R(e.buttonEl,"click").pipe(we.M(T.of(e),Ba.x.getRecipientsContextEventObservable(e.formEl,null).pipe(U.U((e=>e.length))),S.threadContext),D.h((([e,t,n])=>n>0)),Ee.b((([e,t,n,i])=>{(0,o.zG)(k.fromNullable(i.expandedMessages.get(t.messageId)),k.chain(ua.zk),kt.bw((e=>{y.readerMailReplySent(e.textMap.getPlainText().length,e.context.audience.length,n,C,Date.now()-t.startTime,(0,o.zG)(i.threadId,k.fromEither,k.toUndefined))})))})))))).subscribe();return w.debug("page integration created"),()=>{y.readerMailSessionEnd(C,(0,o.zG)(S.threadContext.get().threadId,k.fromEither,k.toUndefined)),W.dispose(),null==oe||oe.unsubscribe(),null==ie||ie.unsubscribe(),J.unsubscribe(),te.unsubscribe(),null==ee||ee.unsubscribe(),null==$||$.dispose(),null==O||O.dispose(),A.modify((e=>(null==e||e.dispose(),null))),R.unsubscribe(),F.dispose(),S.dispose(),re.unsubscribe(),null==q||q.unsubscribe(),null==j||j.unsubscribe(),w.debug("page integration disposed")}}function Tr(e){switch(e.kind){case H.Kind.pin:switch(e.itemType){case"linkItem":case"summaryItem":case"followUpItem":return{...e.item,pinned:e.pinned};default:(0,V.vE)(e.itemType)}break;case H.Kind.dismiss:return{...e.item,dismissed:!0};case H.Kind.like:case H.Kind.dislike:return{...e.item,rating:za(e.kind)};default:(0,V.vE)(e)}}},86620:(e,t,n)=>{n.d(t,{C:()=>d,U:()=>i});var i,a=n(27378),o=n(29511),s=n(33678),r=n(88056),l=n(95574);!function(e){let t;!function(e){e.isAppleSystem="isAppleSystem"}(t=e.SidebarFlag||(e.SidebarFlag={})),e.Flag={...t,...s.a.Flag},e.Context=a.createContext(r.Y.invariantContent("Environment"))}(i||(i={}));class d{constructor(e=(0,o.O)()){this._flags=new Set,this.actions={openUrl:e=>l.vM((()=>{document.location.href=e.toString()})),openPopup:e=>l.vM((()=>{const t=self.open(e.toString(),void 0,"noreferrer");t&&(t.opener=null)}))},e.config.systemInfo.os.isMac&&this._flags.add(i.Flag.isAppleSystem),this._flags.add(i.Flag.supportsSVGDominantBaseline),this._flags.add(i.Flag.onlyTrustedEvents)}has(e){return this._flags.has(e)}}},92132:(e,t,n)=>{n.d(t,{Q:()=>l});var i=n(27378),a=n(15073),o=n(60797),s=n(95300),r=n(5114);const l=({children:e,remSize:t,setter:n})=>(d+=1,i.useEffect((()=>{const e=t.subscribe((e=>{c.next(r.some(e)),n(r.some(e))}));return()=>{e.unsubscribe(),d-=1,0===d&&(c.next(r.none),n(r.none))}}),[t]),i.createElement(a.u.Context.Provider,{value:c.pipe(o.oA)},e));let d=0;const c=new s.X(r.none)},86705:(e,t,n)=>{n.d(t,{v:()=>o});var i=n(27378),a=n(80895);const o=({browser:e,className:t,title:n="BETA"})=>"safari"!==e?i.createElement(a.C,{title:n,className:t}):null},31944:(e,t,n)=>{n.d(t,{J:()=>r});var i=n(57050),a=n(27378),o=n(12187),s=n(22536);const r=({onChange:e,labelId:t,className:n,checkboxClassName:r,labelClassName:l,checked:d,children:c,disabled:m,dataGrammarlyPart:u="ui-kit-checkbox",tabIndex:h=0})=>{const[p,g]=a.useState(null!=d&&d);a.useEffect((()=>{g(Boolean(d))}),[d]);const f=t=>{t.preventDefault(),t.stopPropagation(),g(!p),null==e||e(!p)};return a.createElement("div",{"data-grammarly-part":u,...(0,o.Sh)(s.checkboxContainer,n)},a.createElement("div",{...(0,o.Sh)(s.checkbox,r,p?s.checkboxChecked:null),role:"checkbox","aria-checked":p,tabIndex:h,"aria-labelledby":t,onKeyDown:e=>{" "===e.key&&f(e)},onClick:m?i.Q1:f},p?a.createElement("div",{className:s.checkboxCheckmark}):null),a.createElement("label",{id:t,onClick:f,className:l},c))}},57053:(e,t,n)=>{n.d(t,{i:()=>s});var i=n(27378),a=n(12187),o=n(39070);const s=({maxRating:e=5,ratingLabels:t=["Not at all valuable","Slightly valuable","Somewhat valuable","Very valuable","Extremely valuable"],onChange:n,value:s,ariaLabel:r="Rating",className:l,ratingStarsClassName:d,ratingLegendClassName:c,ratingLabelsClassName:m})=>{const[u,h]=i.useState(s),[p,g]=i.useState(void 0);i.useEffect((()=>{h(s)}),[s]),i.useEffect((()=>{void 0!==u&&n(u)}),[u]);const f=[...Array(e).keys()].map((e=>e+1)),b=void 0!==p?p:u;return i.createElement("div",{"data-grammarly-part":"ui-kit-rating",role:"radiogroup","aria-label":r,...(0,a.Sh)(o.rating,l)},i.createElement("div",{...(0,a.Sh)(o.ratingStars,d),onMouseLeave:()=>g(void 0)},f.map((e=>{const t=void 0!==b&&b>=e;return i.createElement("input",{key:`rating-${e}`,id:`rating-${e}`,type:"radio",name:"rating",checked:u===e,onChange:e=>h(parseInt(e.target.value,10)),value:e,onMouseEnter:e=>{const t=e.target;g(parseInt(t.value,10))},...(0,a.Sh)(o.ratingStar,t?o.ratingStarFilled:null)})}))),i.createElement("div",{...(0,a.Sh)(o.ratingLabels,m)},f.map((e=>i.createElement("label",{key:`rating-label-${e}`,htmlFor:`rating-${e}`,...(0,a.Sh)(b===e?o.ratingLabelVisible:o.ratingLabelNotVisible)},t[e-1])))),void 0!==b?null:i.createElement("div",{...(0,a.Sh)(o.ratingLegend,c)},i.createElement("div",null,t[0]),i.createElement("div",null,t[f.length-1])))}},18347:(e,t,n)=>{n.d(t,{Eh:()=>a,Od:()=>s,e5:()=>o,nI:()=>r});var i=n(13853),a=(i.ZN,new Set,i.AO,i.Eh);i.G,i.UI,i.yW,i.tS,i.KX;i.t9,i.G0,i.jV,i.tV;var o=i.e5,s=(i.Lf,i.oP,i.u4,i.Lx,i.ri,i.$T,i.Od);var r=i.nI;i.oA,i.xu,i.DZ},83771:e=>{e.exports={layout:"_1hKpE",column:"_1rBJw",scrollView:"_1wR-W",sectionTitle:"-RBKX"}},47397:e=>{e.exports={empty:"_1XVf-",title:"_2AfjV",body:"_21gih"}},93253:e=>{e.exports={item:"_27MUw",content:"e2xP-",moreButton:"_2is65",pinned:"_1L-Hp",ellipsis:"_2TIW4"}},67465:e=>{e.exports={menu:"_1f4lm",pinned:"_1uRyx",button:"_12QVt",separator:"Q9ySg",inactiveIcon:"_2taPz"}},50243:e=>{e.exports={list:"u22ST"}},38459:e=>{e.exports={linkAndIcon:"_2mO4u",link:"_3djIE",linkWrapper:"kGyxh",icon:"_26TDA"}},45587:e=>{e.exports={itemLoading:"KdASy",lineOnly:"_3gA50",line:"_3btGG",lineLoading:"_3W_2s",rect:"_2Ln0z",rectLoading:"_1pxCc",lineAndCheckbox:"_3ZgMs",lineAndAvatar:"_1j1Dr"}},69566:e=>{e.exports={title:"rOb7m"}},11071:e=>{e.exports={textChecked:"_1Sg3F",checkboxWrapper:"_45wj5",label:"_1ybvy",checkbox:"T4rHe",itemText:"pqhgN"}},83581:e=>{e.exports={itemText:"_3h7i6"}},25756:e=>{e.exports={loader:"rfHCU",emptyCTAButton:"ZMDnY",warningGroup:"_1eJrv",warningIcon:"_3c_5k"}},79579:e=>{e.exports={emptyCTAButton:"_3kUpB"}},78870:e=>{e.exports={dialog:"_2-QQ0",header:"_1EWW5",headerGroup:"_1JdLn",buttons:"_3p63M",textbox:"_1CLrn",requiredTextBox:"_2T8Ox",requiredLabel:"_3HHRw"}},61033:e=>{e.exports={panelOverlay:"_1qTMO",dialog:"yOM_O"}},56229:e=>{e.exports={title:"_2k48T",rating:"_3V8Jf",ratingContainer:"_3T2eO",ratingStars:"_1WWyq",ratingLegend:"_9LsLz",ratingLabels:"_1j0UE",requiredLabel:"yOJki"}},35115:e=>{e.exports={title:"_57M23",description:"_2sj__"}},89739:e=>{e.exports={activeMailInfo:"_31J8M",date:"fHbk9",author:"BD2pG"}},37903:e=>{e.exports={header:"_1mfP5"}},14692:e=>{e.exports={navigationFrame:"v_SsT",buttonGroup:"_3n1p4",iconJump:"_22-y3",iconGoFirst:"_2OzZD",icon:"_3hVGV"}},16204:e=>{e.exports={buttonGroup:"_2tWWr",button:"_1jXO0"}},76168:e=>{e.exports={notification:"_1xXpR"}},40349:e=>{e.exports={controls:"_2Hipc",onboardingButtonGroup:"_-9OmU",optInButton:"_5OTjn",optOutButton:"_30tah",navigation:"_1jU2d",leftButton:"P6wpw",rightButton:"_3CBvI",arrowRight:"D-jgQ",stepOfN:"_1HJSf"}},86564:e=>{e.exports={disclaimer:"Y6xYb"}},57391:e=>{e.exports={illustration:"fcee3"}},51869:e=>{e.exports={onboarding:"_2ODbM",logo:"Lr1qJ",content:"_3-26v",badge:"_3POlX",steps:"_31CBV"}},77821:e=>{e.exports={highlightsOnboarding:"_1kj0B","highlightsOnboarding-button":"_1BN-s","highlightsOnboarding-icon":"_1ZhuO","highlightsOnboarding-header":"_17c8S","highlightsOnboarding-content":"_3bcKa","highlightsOnboarding-buttons":"_3kg0R"}},19230:e=>{e.exports={title:"gf4R_",body:"_2Vehu"}},23556:e=>{e.exports={header:"_3kzGL",nothingToRecap:"_3Y1Tm",spinner:"_3eEte"}},86885:e=>{e.exports={panelWrapper:"dVcQ2"}},35300:e=>{e.exports={onboarding:"_1hppt",toolbar:"_38d_I"}},64908:e=>{e.exports={panelGrid:"_1oojw",header:"_15T_5",toolbar:"_3jOrT"}},58120:e=>{e.exports={recapButton:"_318vF",logo:"Tn0sZ",recap:"_3L1sH"}},22536:e=>{e.exports={checkboxContainer:"_3bj_g",checkbox:"xrB8R",checkboxChecked:"Uhddy",checkboxCheckmark:"_1qI2g",spin:"_3S_a3"}},39070:e=>{e.exports={rating:"_2oJv0",ratingStars:"_3FAXT",ratingStar:"_1p53S",ratingStarFilled:"_1E3qz",ratingLabels:"jzPuo",ratingLabelVisible:"_3yF9v",ratingLabelNotVisible:"_2zNv4",ratingLegend:"_1XbY_",spin:"fu5_3"}},39335:(e,t,n)=>{var i={superfasthash:n(11028),murmurhash3:n(13786)};e.exports={createHash:function(e){e=e.replace(/![a-zA-z0-9]/g,"").toLowerCase();try{return i[e]}catch(e){throw new Error(e)}}}},13786:(e,t,n)=>{var i=n(81314);function a(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function o(e,t){return e<<t|e>>>32-t}function s(e){return e=a(e^=e>>>16,2246822507),e=a(e^=e>>>13,3266489909),e^=e>>>16}function r(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function d(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function c(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function m(e,t){return[e[0]^t[0],e[1]^t[1]]}function u(e){return e=m(e,[0,e[0]>>>1]),e=m(e=l(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=m(e=l(e,[3301882366,444984403]),[0,e[0]>>>1])}var h=function(e,t){e=""+e||"";var n=i.toU8IntArray(e);t=t||0;for(var a=(e={charCodeAt:function(e){return n[e]},length:n.length}).length%16,o=e.length-a,s=[0,t],h=[0,t],p=[0,0],g=[0,0],f=[2277735313,289559509],b=[1291169091,658871167],v=0;v<o;v+=16)p=[255&e.charCodeAt(v+4)|(255&e.charCodeAt(v+5))<<8|(255&e.charCodeAt(v+6))<<16|(255&e.charCodeAt(v+7))<<24,255&e.charCodeAt(v)|(255&e.charCodeAt(v+1))<<8|(255&e.charCodeAt(v+2))<<16|(255&e.charCodeAt(v+3))<<24],g=[255&e.charCodeAt(v+12)|(255&e.charCodeAt(v+13))<<8|(255&e.charCodeAt(v+14))<<16|(255&e.charCodeAt(v+15))<<24,255&e.charCodeAt(v+8)|(255&e.charCodeAt(v+9))<<8|(255&e.charCodeAt(v+10))<<16|(255&e.charCodeAt(v+11))<<24],p=d(p=l(p,f),31),s=r(s=d(s=m(s,p=l(p,b)),27),h),s=r(l(s,[0,5]),[0,1390208809]),g=d(g=l(g,b),33),h=r(h=d(h=m(h,g=l(g,f)),31),s),h=r(l(h,[0,5]),[0,944331445]);switch(p=[0,0],g=[0,0],a){case 15:g=m(g,c([0,e.charCodeAt(v+14)],48));case 14:g=m(g,c([0,e.charCodeAt(v+13)],40));case 13:g=m(g,c([0,e.charCodeAt(v+12)],32));case 12:g=m(g,c([0,e.charCodeAt(v+11)],24));case 11:g=m(g,c([0,e.charCodeAt(v+10)],16));case 10:g=m(g,c([0,e.charCodeAt(v+9)],8));case 9:g=l(g=m(g,[0,e.charCodeAt(v+8)]),b),h=m(h,g=l(g=d(g,33),f));case 8:p=m(p,c([0,e.charCodeAt(v+7)],56));case 7:p=m(p,c([0,e.charCodeAt(v+6)],48));case 6:p=m(p,c([0,e.charCodeAt(v+5)],40));case 5:p=m(p,c([0,e.charCodeAt(v+4)],32));case 4:p=m(p,c([0,e.charCodeAt(v+3)],24));case 3:p=m(p,c([0,e.charCodeAt(v+2)],16));case 2:p=m(p,c([0,e.charCodeAt(v+1)],8));case 1:p=l(p=m(p,[0,e.charCodeAt(v)]),f),s=m(s,p=l(p=d(p,31),b))}return s=r(s=m(s,[0,e.length]),h=m(h,[0,e.length])),h=r(h,s),s=r(s=u(s),h=u(h)),h=r(h,s),("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)+("00000000"+(h[0]>>>0).toString(16)).slice(-8)+("00000000"+(h[1]>>>0).toString(16)).slice(-8)};e.exports={x86Hash32:function(e,t){e=""+e||"";var n=i.toU8IntArray(e);t=t||0;for(var r=(e={charCodeAt:function(e){return n[e]},length:n.length}).length%4,l=e.length-r,d=t,c=0,m=3432918353,u=461845907,h=0;h<l;h+=4)c=a(c=255&e.charCodeAt(h)|(255&e.charCodeAt(h+1))<<8|(255&e.charCodeAt(h+2))<<16|(255&e.charCodeAt(h+3))<<24,m),c=a(c=o(c,15),u),d=a(d=o(d^=c,13),5)+3864292196;switch(c=0,r){case 3:c^=(255&e.charCodeAt(h+2))<<16;case 2:c^=(255&e.charCodeAt(h+1))<<8;case 1:c=a(c^=255&e.charCodeAt(h),m),d^=c=a(c=o(c,15),u)}return((d=s(d^=e.length))>>>0).toString(16)},x86Hash128:function(e,t){e=""+e||"";var n=i.toU8IntArray(e);t=t||0;for(var r=(e={charCodeAt:function(e){return n[e]},length:n.length}).length%16,l=e.length-r,d=t,c=t,m=t,u=t,h=0,p=0,g=0,f=0,b=597399067,v=2869860233,k=951274213,y=2716044179,x=0;x<l;x+=16)h=255&e.charCodeAt(x)|(255&e.charCodeAt(x+1))<<8|(255&e.charCodeAt(x+2))<<16|(255&e.charCodeAt(x+3))<<24,p=255&e.charCodeAt(x+4)|(255&e.charCodeAt(x+5))<<8|(255&e.charCodeAt(x+6))<<16|(255&e.charCodeAt(x+7))<<24,g=255&e.charCodeAt(x+8)|(255&e.charCodeAt(x+9))<<8|(255&e.charCodeAt(x+10))<<16|(255&e.charCodeAt(x+11))<<24,f=255&e.charCodeAt(x+12)|(255&e.charCodeAt(x+13))<<8|(255&e.charCodeAt(x+14))<<16|(255&e.charCodeAt(x+15))<<24,h=o(h=a(h,b),15),d=o(d^=h=a(h,v),19),d=a(d+=c,5)+1444728091,p=o(p=a(p,v),16),c=o(c^=p=a(p,k),17),c=a(c+=m,5)+197830471,g=o(g=a(g,k),17),m=o(m^=g=a(g,y),15),m=a(m+=u,5)+2530024501,f=o(f=a(f,y),18),u=o(u^=f=a(f,b),13),u=a(u+=d,5)+850148119;switch(h=0,p=0,g=0,f=0,r){case 15:f^=e.charCodeAt(x+14)<<16;case 14:f^=e.charCodeAt(x+13)<<8;case 13:f=a(f^=e.charCodeAt(x+12),y),u^=f=a(f=o(f,18),b);case 12:g^=e.charCodeAt(x+11)<<24;case 11:g^=e.charCodeAt(x+10)<<16;case 10:g^=e.charCodeAt(x+9)<<8;case 9:g=a(g^=e.charCodeAt(x+8),k),m^=g=a(g=o(g,17),y);case 8:p^=e.charCodeAt(x+7)<<24;case 7:p^=e.charCodeAt(x+6)<<16;case 6:p^=e.charCodeAt(x+5)<<8;case 5:p=a(p^=e.charCodeAt(x+4),v),c^=p=a(p=o(p,16),k);case 4:h^=e.charCodeAt(x+3)<<24;case 3:h^=e.charCodeAt(x+2)<<16;case 2:h^=e.charCodeAt(x+1)<<8;case 1:h=a(h^=e.charCodeAt(x),b),d^=h=a(h=o(h,15),v)}return d^=e.length,d+=c^=e.length,d+=m^=e.length,c+=d+=u^=e.length,m+=d,u+=d,d=s(d),d+=c=s(c),d+=m=s(m),c+=d+=u=s(u),m+=d,u+=d,("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(c>>>0).toString(16)).slice(-8)+("00000000"+(m>>>0).toString(16)).slice(-8)+("00000000"+(u>>>0).toString(16)).slice(-8)},x64Hash64:function(e,t){return h(e,t).slice(8)},x64Hash128:h,hash:function(e,t){return h(e,t)}}},11028:(e,t,n)=>{var i=n(81314);function a(e,t){return e[t]<<8|e[t+1]}e.exports={hash:function(e){var t,n=i.toU8IntArray(e+""),o=0;if(!e)return o.toString(16);var s=n.length,r=0;t=3&s,s>>>=2;for(var l=0;l<s;l++)o=(o+=a(n,r))<<16^(a(n,r+2)<<11^o),r+=4,o+=o>>11;switch(t){case 3:o+=a(n,r),o^=o<<16,o^=n[r+2]<<18,o+=o>>11;break;case 2:o+=a(n,r),o^=o<<11,o+=o>>17;break;case 1:o+=n[r],o^=o<<10,o+=o>>1}return o^=o<<3,o+=o>>5,o^=o<<4,o+=o>>17,o^=o<<25,o+=o>>6,i.intToUnsignedHex(o)}}},81314:e=>{e.exports={toU8IntArray:function(e){for(var t=[],n=[],i=0;i<e.length;i++){var a,o=e.charCodeAt(i);for(n.length=0;(a=255&o)||o;)n.push(a),o>>>=8;t=t.concat(n.reverse())}return t},intToUnsignedHex:function(e){for(var t,n=[];(t=65535&e)||e;)t=t.toString(16),t="0000".slice(t.length)+t,n.push(t),e>>>=16;return n.reverse().join("")}}}}]);
"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[195],{8781:(e,t,n)=>{n.d(t,{Z:()=>o});var r,a=n(5776);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}const o=function(e){return a.createElement("svg",l({width:"1em",height:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"icon"},e),r||(r=a.createElement("path",{d:"M20.2 13.65l-.007.168a1.95 1.95 0 01-3.893-.168V7.5l-.008-.122A.9.9 0 0014.5 7.5v.153A4.8 4.8 0 006.7 11.4v1.2a4.8 4.8 0 008.435 3.135A3.739 3.739 0 0018.25 17.4c.525 0 1.025-.108 1.478-.303A6.303 6.303 0 0113.9 21h-3.6A6.3 6.3 0 014 14.7V9.3A6.3 6.3 0 0110.3 3h3.6a6.3 6.3 0 016.3 6.3v4.35zM11.5 8.4a3 3 0 013 3v1.2a3 3 0 01-6 0v-1.2a3 3 0 013-3z",fill:"currentcolor",fillRule:"evenodd"})))}},736:(e,t,n)=>{n.d(t,{Z:()=>o});var r,a=n(5776);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}const o=function(e){return a.createElement("svg",l({width:"1em",height:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"icon"},e),r||(r=a.createElement("path",{d:"M20.25 13.375a3.125 3.125 0 01-5.723 1.738A4 4 0 017.5 12.5v-1a4 4 0 016.501-3.122L14 8.25a.75.75 0 011.493-.102l.007.102v5.125a1.625 1.625 0 003.244.14l.006-.14V9.75a5.25 5.25 0 00-5.034-5.246L13.5 4.5h-3a5.25 5.25 0 00-5.246 5.034l-.004.216v4.5a5.25 5.25 0 005.034 5.246l.216.004h3a.75.75 0 01.102 1.493L13.5 21h-3a6.75 6.75 0 01-6.746-6.513l-.004-.237v-4.5a6.75 6.75 0 016.513-6.746L10.5 3h3a6.75 6.75 0 016.746 6.513l.004.237v3.625zM11.5 9A2.5 2.5 0 009 11.5v1a2.5 2.5 0 105 0v-1A2.5 2.5 0 0011.5 9z",fill:"currentcolor",fillRule:"evenodd"})))}},5409:(e,t,n)=>{n.d(t,{x:()=>u});var r=n(4184),a=n.n(r),l=n(5776),o=n(7405);function u(e){let t=e.users,n=e.selected,r=e.onClick;return null!=t&&t.length?l.default.createElement("ul",{className:"flex overflow-hidden flex-col w-70 rounded-16 border border-theme-divider-secondary text-theme-label-primary",role:"listbox"},t.map(((e,t)=>l.default.createElement(o.z,{key:e.username,user:e,className:a()("px-3 cursor-pointer",t===n&&"bg-theme-active"),imageSize:"large",tag:"li",onClick:()=>r(e.username),"aria-selected":t===n,role:"option",disableTooltip:!0})))):null}},9366:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(5776),a=n(6548),l=n(736),o=n(8781);function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}const i=e=>r.default.createElement(a.Z,u({},e,{IconPrimary:l.Z,IconSecondary:o.Z}))},1796:(e,t,n)=>{n.d(t,{Z:()=>b});var r=n(5776),a=n(4184),l=n.n(a),o=n(2835),u=n(2198),i=n(435),c=n(6990),s=n(9065),f=n(8050),m=n(3833),d=n(2546),p=n(2210),y=n(5763),v=n(9366),h=n(8608);const b=function(e){let t=e.authorImage,n=e.authorName,a=e.publishDate,b=e.contentHtml,g=e.editContent,x=e.editId,w=e.input,E=e.errorMessage,O=e.sendingComment,C=e.onInput,k=e.sendComment,S=e.parentSelector,N=e.post;const A=(0,r.useContext)(o.ZP).user,j=(0,y.vg)({postId:N.id,onInput:C}),I=j.onMentionClick,P=j.onMentionKeypress,M=j.offset,T=j.mentions,z=j.mentionQuery,q=j.selected,D=j.commentRef,Z=j.onInitializeMention,R=j.onInputClick;return(0,r.useEffect)((()=>{var e;null===(e=D.current)||void 0===e||e.focus(),D.current&&(g&&(D.current.value=g),D.current.setAttribute("data-min-height",D.current.offsetHeight.toString()))}),[]),r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"overflow-auto max-h-[31rem]"},r.default.createElement("article",{className:l()("flex flex-col items-stretch",u.gO)},r.default.createElement("header",{className:"flex items-center mb-2"},r.default.createElement(f.Y,{size:"large",rounded:"full",user:{image:t,username:n},nativeLazyLoading:!0}),r.default.createElement("div",{className:"flex flex-col ml-2"},r.default.createElement("div",{className:"truncate typo-callout"},n),r.default.createElement("time",{dateTime:a.toString(),className:"text-theme-label-tertiary typo-callout"},(0,i.Pe)(a)))),r.default.createElement(d.Z,{content:b})),r.default.createElement("div",{className:"flex items-center px-2 h-11"},r.default.createElement("div",{className:"ml-3 w-px h-full bg-theme-divider-tertiary"}),r.default.createElement("div",{className:"ml-6 text-theme-label-secondary typo-caption1"},"Reply to"," ",r.default.createElement("strong",{className:"font-bold text-theme-label-primary"},n))),r.default.createElement("div",{className:"flex relative flex-1 pl-2"},r.default.createElement(f.Y,{user:A,size:"small",nativeLazyLoading:!0}),r.default.createElement("textarea",{className:l()("ml-3 flex-1 text-theme-label-primary bg-transparent border-none caret-theme-label-link break-words typo-subhead resize-none",s.Z.textarea),ref:D,placeholder:"Write your comment...",onInput:e=>{(0,y.nl)(e.currentTarget),C((0,h.X)(e.currentTarget.value))},onKeyDown:e=>(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&null!=w&&w.length?k(e):"Enter"!==e.key&&-1===y.Kt.indexOf(e.key)||null==T||!T.length?e.stopPropagation():e.preventDefault(),onKeyUp:P,onClick:R,onPaste:e=>{e.preventDefault();const t=e.clipboardData.getData("text/plain");document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,t):document.execCommand("paste",!1,t)},tabIndex:0,"aria-label":"New comment box","aria-multiline":!0})),r.default.createElement(p.l,{elementRef:D,offset:M,mentions:T,selected:q,query:z,appendTo:S,onMentionClick:I}),r.default.createElement("div",{className:"my-2 mx-3 text-theme-status-error typo-caption1",style:{minHeight:"1rem"}},E&&r.default.createElement("span",{role:"alert"},E))),r.default.createElement("footer",{className:"flex items-center pt-3"},r.default.createElement(c.z,{className:"mx-1 btn-tertiary",buttonSize:"small",icon:r.default.createElement(v.Z,null),onClick:Z}),r.default.createElement("div",{className:"ml-2 w-px h-6 border border-opacity-24 border-theme-divider-tertiary"}),r.default.createElement(m.D,{tag:"a",href:"https://www.markdownguide.org/cheat-sheet/",className:"ml-4 typo-caption1",defaultTypo:!1,target:"_blank"},"Markdown supported"),r.default.createElement(c.z,{disabled:!(null!=w&&w.trim().length)||w===g,loading:O,onClick:k,className:"ml-auto btn-primary-avocado"},x?"Update":"Comment")))}},5553:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(5776),a=n(6990),l=n(236);const o=["onDeleteComment","onRequestClose"];function u(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function i(e){let t=e.onDeleteComment,n=e.onRequestClose,i=u(e,o);return r.default.createElement(l.cV,i,r.default.createElement(l.G6,null,"Discard comment"),r.default.createElement(l.P5,null,"Are you sure you want to close and discard your comment?"),r.default.createElement(l.oP,null,r.default.createElement(a.z,{className:"btn-secondary",onClick:n},"Stay"),r.default.createElement(a.z,{className:"btn-primary-ketchup",onClick:t},"Discard")))}},5195:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var r=n(6484),a=n.n(r),l=n(5776),o=n(8767),u=n(5909),i=n(562),c=n(3160),s=n(2546),f=n(294),m=n(1796),d=n(6990),p=n(2508),y=n(5553),v=n(7803);const h=["onRequestClose","editId","onComment","onInputChange"];function b(){return b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}function g(e,t,n,r,a,l,o){try{var u=e[l](o),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(r,a)}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function O(e){let t=e.onRequestClose,n=e.editId,r=e.onComment,w=e.onInputChange,O=E(e,h);const C=x((0,l.useState)(O.editContent||""),2),k=C[0],S=C[1],N=x((0,l.useState)(!1),2),A=N[0],j=N[1],I=x((0,l.useState)("Write"),2),P=I[0],M=I[1],T=x((0,l.useState)(!1),2),z=T[0],q=T[1],D=x((0,l.useState)(null),2),Z=D[0],R=D[1],$="Preview"===P,L=(0,v.Y)().requestMethod,K=["comment_preview",k],J=(0,o.useQuery)(K,(()=>L(`${i.J}/graphql`,u.H4,{content:k},{requestKey:JSON.stringify(K)})),{enabled:$&&(null==k?void 0:k.length)>0}).data,U=e=>{!O.editContent&&null!=k&&k.length||O.editContent&&O.editContent!==k?j(!0):t(e)},Y=["post_comments_mutations",O.post.id],H=(0,o.useMutation)((e=>L(`${i.J}/graphql`,O.commentId?u.y5:u.hK,e,{requestKey:JSON.stringify(Y)})),{onSuccess:e=>e&&r(e.comment,!0)}).mutateAsync,Q=(0,o.useMutation)((e=>L(`${i.J}/graphql`,u.hp,e,{requestKey:JSON.stringify(Y)})),{onSuccess:e=>e&&r(e.comment,!1)}).mutateAsync,W=function(){var e,t=(e=a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z&&null!=k&&k.trim().length){e.next=2;break}return e.abrupt("return");case 2:if(R(null),q(!0),e.prev=4,!n){e.next=10;break}return e.next=8,Q({id:n,content:k});case 8:e.next=12;break;case 10:return e.next=12,H({id:O.commentId||O.post.id,content:k});case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),R("Something went wrong, try again"),q(!1);case 18:case"end":return e.stop()}}),e,null,[[4,14]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function o(e){g(l,r,a,o,u,"next",e)}function u(e){g(l,r,a,o,u,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,l.useEffect)((()=>{null==w||w(k)}),[k]),l.default.createElement(c.c,b({contentRef:e=>{e&&(e.scrollTop=e.scrollHeight-e.clientHeight)},onRequestClose:U,overlayClassName:"fixed-position",padding:!1},O),l.default.createElement(p.o,{onClick:U,className:"top-2"}),l.default.createElement(f.Z,{onActiveChange:e=>M(e),shouldMountInactive:!0,className:"tablet:max-h-[40rem] grow tablet:grow-0"},l.default.createElement(f.O,{label:"Write",className:"flex flex-col flex-1"},l.default.createElement(m.Z,b({},O,{onInput:S,input:k,editId:n,errorMessage:Z,sendingComment:z,sendComment:W}))),l.default.createElement(f.O,{label:"Preview",className:"flex overflow-y-auto flex-col flex-1"},$&&(null==J?void 0:J.preview)&&l.default.createElement(s.Z,{content:J.preview,appendTooltipTo:O.parentSelector}),$&&l.default.createElement(d.z,{disabled:!(null!=k&&k.trim().length)||k===O.editContent,loading:z,onClick:W,className:"mt-auto ml-auto btn-primary-avocado"},n?"Update":"Comment"))),l.default.createElement(y.Z,{isOpen:A,onRequestClose:()=>j(!1),onDeleteComment:t,shouldCloseOnOverlayClick:!1,parentSelector:O.parentSelector}))}},7405:(e,t,n)=>{n.d(t,{z:()=>d});var r=n(4184),a=n.n(r),l=n(5776),o=n(8050),u=n(2250),i=n(7877);const c=["imageSize","tag","user","className","disableTooltip","scrollingContainer","appendTooltipTo"];function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function f(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const m=(0,u.be)();function d(e){var t;let n=e.imageSize,r=void 0===n?"xlarge":n,u=e.tag,d=e.user,p=e.className,y=e.disableTooltip,v=e.scrollingContainer,h=e.appendTooltipTo,b=f(e,c);const g=u||"a",x=d.name,w=d.username,E=d.bio,O={appendTo:h||(null===(t=document)||void 0===t?void 0:t.body)||"parent",visible:!y&&void 0};return l.default.createElement(g,s({},b,{className:a()("flex flex-row py-3 px-6 hover:bg-theme-hover",p)}),l.default.createElement(i.R,{user:d,tooltip:O,scrollingContainer:v},l.default.createElement(o.Y,{user:d,size:r,nativeLazyLoading:!0})),l.default.createElement(i.R,{user:d,tooltip:O,scrollingContainer:v},l.default.createElement("div",{className:"flex overflow-hidden flex-col flex-1 ml-4 typo-callout"},l.default.createElement(m,{className:"font-bold"},x),l.default.createElement(m,{className:"text-theme-label-secondary"},"@",w),E&&l.default.createElement("span",{className:"mt-1 text-theme-label-tertiary"},E))))}},294:(e,t,n)=>{n.d(t,{O:()=>m,Z:()=>d});var r=n(5776),a=n(4184),l=n.n(a),o=n(649);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const m=e=>{let t=e.children,n=e.className,a=e.style;return r.default.createElement("div",{className:l()("p-3",n),style:a},t)};const d=function(e){let t=e.children,n=e.shouldMountInactive,a=void 0!==n&&n,u=e.onActiveChange,c=e.className,f=e.style;const m=s((0,r.useState)(t[0].props.label),2),d=m[0],p=m[1],y=e=>e.props.label===d;return r.default.createElement("div",{className:l()("flex flex-col",c),style:f},r.default.createElement("header",{className:"flex flex-row border-b border-theme-divider-tertiary"},r.default.createElement(o.Z,{items:t.map((e=>e.props.label)),onClick:e=>{p(e),u(e)},active:d})),a?t.map(((e,t)=>(0,r.createElement)(e.type,i(i({},e.props),{},{key:e.props.key||t,style:y(e)?e.props.style:i(i({},e.props.style),{},{display:"none"})})))):(()=>{if(!a){const e=t.find(y);return(0,r.createElement)(e.type,e.props)}return null})())}},649:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(4184),a=n.n(r),l=n(5776);const o=function(e){let t=e.items,n=e.active,r=e.onClick;return l.default.createElement("ul",{className:"flex flex-row"},t.map((e=>l.default.createElement("button",{key:e,className:a()("relative p-4 text-center typo-callout",e===n?"font-bold":"text-theme-label-tertiary"),onClick:()=>r(e),type:"button",role:"menuitem"},e,e===n&&l.default.createElement("div",{className:"absolute bottom-0 mx-auto w-4 h-px bg-theme-label-primary",style:{left:"calc(50% - 0.5rem)"}})))))}},2210:(e,t,n)=>{n.d(t,{l:()=>c});var r=n(5776),a=n(4403),l=n(5409),o=n(5782);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e){var t;let n=e.query,i=e.mentions,c=void 0===i?[]:i,s=e.selected,f=void 0===s?-1:s,m=e.offset,d=void 0===m?[0,0]:m,p=e.onMentionClick,y=e.appendTo,v=e.elementRef;if(o.jp)return null;const h=u(d,2),b=h[0],g=h[1],x=64*c.length;return r.default.createElement(a.BaseTooltip,{appendTo:y||(null===(t=document)||void 0===t?void 0:t.body)||"parent",content:r.default.createElement(l.x,{users:void 0!==n&&c,selected:f,onClick:p}),offset:[b,-1*(g+x+26)],interactive:!0,container:{className:"shadow",paddingClassName:"p-0",roundedClassName:"rounded-16",bgClassName:"bg-theme-bg-tertiary"},reference:v,arrow:!1,placement:"top-start",visible:void 0!==n})}},5763:(e,t,n)=>{n.d(t,{Kt:()=>g,nl:()=>w,vg:()=>E});var r=n(6484),a=n.n(r),l=n(8767),o=n(5776),u=n(5909),i=n(562),c=n(2835),s=n(7291),f=n(8608),m=n(3197),d=n(8577),p=n(7803);function y(e,t,n,r,a,l,o){try{var u=e[l](o),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(r,a)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function o(e){y(l,r,a,o,u,"next",e)}function u(e){y(l,r,a,o,u,"throw",e)}o(void 0)}))}}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const g=["ArrowUp","ArrowDown"],x=["ArrowLeft","ArrowRight"],w=e=>{const t=e.getAttribute("data-min-height"),n=parseInt(t,10);e.style.height="auto",e.style.height=`${Math.max(e.scrollHeight,n)}px`};function E(e){let t=e.postId,n=e.onInput;const r=["user-mention",t],y=(0,o.useRef)(null),b=(0,o.useContext)(c.ZP).user,E=(0,l.useQueryClient)(),O=h((0,o.useState)(0),2),C=O[0],k=O[1],S=h((0,o.useState)([0,0]),2),N=S[0],A=S[1],j=h((0,o.useState)([0,0]),2),I=j[0],P=j[1],M=h((0,o.useState)(),2),T=M[0],z=M[1],q=(0,p.Y)().requestMethod,D=(0,l.useQuery)(r,(()=>q(`${i.J}/graphql`,u.IP,{postId:t,query:T},{requestKey:JSON.stringify(r)})),{enabled:!!b&&void 0!==T,refetchOnWindowFocus:!1,refetchOnMount:!1}),Z=D.data,R=void 0===Z?{recommendedMentions:[]}:Z,$=D.refetch,L=(R||{}).recommendedMentions,K=h((0,s.Z)($,100),1)[0],J=function(){var e=v(a().mark((function e(t){var n,r,l,o,u,i,c,s,f,p,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.Y3)();case 2:if(n=y.current,r=(0,m.FN)(n),l=h(r,2),o=l[0],u=l[1],i=(0,m.qx)(n,[o,u]),c=h(i,3),s=c[0],f=c[1],p=c[2],s){e.next=8;break}return null==t||t(),e.abrupt("return");case 8:if(v=(0,m.gW)(n),f!==T){e.next=11;break}return e.abrupt("return");case 11:z(f),P([p,u]),A(v);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=e=>{if(null==L||!L.length)return;const t=y.current,a=`@${T}`,l=`@${e}`;(0,m.Oc)(t,I,a,l);const o=(0,m.kC)(t.value,I);t.focus(),t.selectionEnd=o+l.length,z(void 0),E.setQueryData(r,[]),n(t.value),w(t)},Y=e=>{const t=(0,m.oz)(e,I),n=""===T&&""===t||T===t||0===e.value.length?void 0:t;z(n),K()},H=()=>{J((()=>z(void 0)))},Q=function(){var e=v(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===x.indexOf(t.key)){e.next=2;break}return e.abrupt("return",H());case 2:if(void 0!==T){e.next=6;break}if((0,f.bJ)(t.key)||"@"===t.key||"Backspace"===t.key){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",J());case 6:if(-1===g.indexOf(t.key)){e.next=9;break}return"ArrowUp"===(r=t.key)&&C>0?k(C-1):"ArrowDown"===r&&C<L.length-1&&k(C+1),e.abrupt("return",t.preventDefault());case 9:if(" "!==t.key){e.next=11;break}return e.abrupt("return",z(void 0));case 11:if("Enter"!==t.key){e.next=14;break}return t.preventDefault(),e.abrupt("return",U(L[C].username));case 14:return e.next=16,(0,d.Y3)();case 16:if("Backspace"!==t.key){e.next=18;break}return e.abrupt("return",Y(y.current));case 18:return n=(0,f.xJ)(t.key)?void 0:(0,m.oz)(y.current,I),z(n),n&&K(),e.abrupt("return",null);case 22:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}(),W=()=>{if(void 0!==T)return;const e=y.current,t=e.selectionStart,n=e.value.substring(0,t),r=e.value.substring(t);e.value=`${n} @ ${r}`,e.focus(),e.selectionEnd=t+2,e.dispatchEvent(new KeyboardEvent("keydown",{key:"@"}))};return(0,o.useEffect)((()=>{var e;const t=e=>{if(e.stopPropagation(),void 0===T)return;const t=e.target,n="textarea"===t.tagName.toLocaleLowerCase(),r=(0,m.tD)(t,"tippy-content");n||r||z(void 0)},n=null===(e=y.current)||void 0===e?void 0:e.getRootNode();return n.addEventListener("mousedown",t),()=>{n.removeEventListener("mousedown",t)}}),[T]),(0,o.useEffect)((()=>{k(0)}),[T]),(0,o.useMemo)((()=>({commentRef:y,offset:N,selected:C,mentions:L,mentionQuery:T,onInputClick:H,onMentionClick:U,onMentionKeypress:Q,onInitializeMention:W})),[y,N,C,L,T])}},3197:(e,t,n)=>{n.d(t,{FN:()=>u,Oc:()=>s,gW:()=>i,kC:()=>f,oz:()=>c,qx:()=>m,tD:()=>d});var r=n(4184),a=n.n(r);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){if(e.selectionStart!==e.selectionEnd)return[0,0];const t=e.selectionStart,n=e.value.substring(0,t).split("\n"),r=n.length;return[n[n.length-1].length,r]}const i=e=>{const t=document.createElement("span"),n=document.createElement("span"),r=document.createElement("div");t.innerText=e.value.substring(0,e.selectionStart),n.innerText=e.value.substring(e.selectionStart),r.className=a()(e.className,"absolute invisible"),r.setAttribute("style","left: 2rem"),r.appendChild(t),r.appendChild(n),e.parentElement.appendChild(r);const l=[n.offsetLeft,n.offsetTop];return r.remove(),l};function c(e,t){let n=l(t,2),r=n[0],a=n[1];const o=e.value.split("\n")[a-1],u=((e,t)=>{const n=e.indexOf(" ",t);return-1===n?void 0:n})(o,r);return o.substring(r,u)}function s(e,t,n,r){let a=l(t,2),o=a[0],u=a[1];const i=e.value.split("\n").map(((e,t)=>{if(t!==u-1)return e;const a=e.substring(0,o-1),l=e.substring(o+n.length-1);return`${a}${r} ${l}`}));e.value=i.join("\n")}const f=(e,t)=>{let n=l(t,2),r=n[0],a=n[1];return e.split("\n").reduce(((e,t,n)=>n<a-1?e+t.length+1:n===a-1?e+r:e),0)};function m(e,t){let n=l(t,2),r=n[0],a=n[1],o=0;const u=e.value.split("\n")[a-1].split(" ").find(((e,t)=>{const n=t>0?1:0;return o+=e.length+n,o>=r}));return["@"===u.charAt(0),u.substring(1),o-u.length+1]}const d=(e,t)=>{if(!e.parentElement)return!1;const n=e.parentElement;return!!n.classList.contains(t)||d(n,t)}},8608:(e,t,n)=>{n.d(t,{X:()=>o,bJ:()=>r,xJ:()=>l});const r=e=>{const t=e.match(/^[a-z0-9]+$/i);return t&&1===t[0].length},a=/[ `!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?~]/,l=e=>a.test(e),o=e=>{var t;return(null===(t=e.replaceAll)||void 0===t?void 0:t.call(e," "," "))||e}},9065:(e,t,n)=>{n.d(t,{Z:()=>r});const r={textarea:"_1OXiSCwqooYx1fMwTCenKA"}}}]);
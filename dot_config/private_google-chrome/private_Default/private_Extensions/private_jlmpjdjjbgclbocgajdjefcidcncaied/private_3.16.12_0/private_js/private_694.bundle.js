"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[694],{9694:(e,t,r)=>{r.r(t),r.d(t,{default:()=>I});var a=r(6484),l=r.n(a),n=r(5776),i=r(8767),o=r(8687),u=r.n(o),s=r(6990),c=r(2508),m=r(122),d=r(562),f=r(5782),b=r(3160),p=r(2465),y=r(2835);const v=o.gql`
  mutation SubmitArticle($url: String!) {
    submitArticle(url: $url) {
      result
      reason
      post {
        id
        title
        commentsPermalink
        image
        readTime
        numUpvotes
        permalink
        source {
          id
          image
        }
      }
      submission {
        id
        url
        userId
        createdAt
        status
        reason
      }
    }
  }
`,h=o.gql`
  query SubmissionAvailability {
    submissionAvailability {
      hasAccess
      limit
      todaySubmissionsCount
    }
  }
`;var g=r(6646),w=r(8e3);const E=(0,r(2256).Z)("div","bg-theme-overlay-cabbage py-1 px-3 ml-2 rounded-10 text-theme-status-cabbage font-bold typo-body");function x(){return n.default.createElement(E,null,"Beta")}var O=r(6942);const S=["headerCopy","submitArticleModalButton","onRequestClose"];function k(){return k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},k.apply(this,arguments)}function N(e,t,r,a,l,n,i){try{var o=e[n](i),u=o.value}catch(e){return void r(e)}o.done?t(u):Promise.resolve(u).then(a,l)}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var a,l,n=[],i=!0,o=!1;try{for(r=r.call(e);!(i=(a=r.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,l=e}finally{try{i||null==r.return||r.return()}finally{if(o)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function P(e,t){if(null==e)return{};var r,a,l=function(e,t){if(null==e)return{};var r,a,l={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(l[r]=e[r]);return l}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}const C="Something went wrong, try again";function I(e){var t,r;let a=e.headerCopy,o=e.submitArticleModalButton,E=e.onRequestClose,A=P(e,S);const I=(0,n.useRef)(),q=(0,n.useContext)(y.ZP).user,U=(0,i.useQueryClient)(),Z=(0,n.useContext)(w.Z).trackEvent,z=j((0,n.useState)(!1),2),D=z[0],_=z[1],R=j((0,n.useState)(!1),2),$=R[0],T=R[1],B=j((0,n.useState)(!1),2),F=B[0],J=B[1],L=j((0,n.useState)(null),2),M=L[0],Q=L[1],Y=j((0,n.useState)(),2),H=Y[0],V=Y[1],W=["submission_availability",null==q?void 0:q.id],G=(0,i.useQuery)(W,(()=>u()(`${d.J}/graphql`,h))),K=G.data,X=G.isFetched,ee=(K||{}).submissionAvailability,te=null==ee?void 0:ee.hasAccess,re=(0,i.useMutation)((e=>u()(`${d.J}/graphql`,v,{url:e}))).mutateAsync,ae=e=>{Z({event_name:"submit article fail",extra:JSON.stringify({reason:e})})},le=function(){var e,t=(e=l().mark((function e(t){var r,a,n,i,u,s,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=(0,m.x)(t.currentTarget),Z({event_name:"submit article",feed_item_title:o,extra:JSON.stringify({url:null==r?void 0:r.articleUrl})}),T(!0),r.articleUrl){e.next=8;break}return V("Please submit a valid URL"),T(!1),e.abrupt("return");case 8:return e.prev=8,e.next=11,re(r.articleUrl);case 11:a=e.sent,n=a.submitArticle,i=n.reason,u=void 0===i?C:i,s=n.post,n.submission?(J(!0),(c={submissionAvailability:ee}).submissionAvailability.todaySubmissionsCount+=1,U.setQueryData(W,c),Z({event_name:"submit article succeed"})):s?(Q({post:s}),ae("Article exists already")):u&&(V(u),ae(u)),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(8),V(C),_(!1),ae(C);case 21:return e.prev=21,T(!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[8,16,21,24]])})),function(){var t=this,r=arguments;return new Promise((function(a,l){var n=e.apply(t,r);function i(e){N(n,a,l,i,o,"next",e)}function o(e){N(n,a,l,i,o,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();return X?n.default.createElement(b.c,k({},A,{onRequestClose:E,padding:!1}),n.default.createElement("header",{className:"flex justify-between items-center px-6 w-full h-14 border-b border-theme-divider-tertiary"},n.default.createElement("div",{className:"flex flex-row items-center"},n.default.createElement("h3",{className:"font-bold typo-title3"},a),n.default.createElement(x,null)),n.default.createElement(c.o,{onClick:E})),n.default.createElement("section",{className:"overflow-auto relative px-10 pt-6 pb-10 w-full h-full shrink max-h-full"},n.default.createElement("p",{className:"mb-2 typo-callout text-theme-label-tertiary"},"Found an interesting article? Do you want to share it with the community? Enter the article's URL / link below to add it to the feed."),!te&&n.default.createElement("p",{className:"mt-6 mb-2 typo-callout text-theme-label-tertiary"},"You need more reputation to enable this feature"),n.default.createElement("a",{className:"font-bold underline typo-callout text-theme-label-link",target:"_blank",rel:"noopener",href:f.WJ},"Learn more"),n.default.createElement("p",{className:"mt-6 mb-4 typo-callout"},"Daily suggestions used"," ",null!==(t=null==ee?void 0:ee.todaySubmissionsCount)&&void 0!==t?t:0,"/",null!==(r=null==ee?void 0:ee.limit)&&void 0!==r?r:3),n.default.createElement("form",{className:"w-full",ref:I,"aria-busy":$,onSubmit:le},n.default.createElement(p.n,{autoFocus:!0,type:"url",leftIcon:n.default.createElement(O.Z,null),fieldType:"tertiary",name:"articleUrl",inputId:"article_url",label:"Paste article url",disabled:!te,hint:H,valid:!H,valueChanged:()=>{I.current&&(M&&Q(null),H&&V(null),_(I.current.checkValidity()))}}),F?n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"flex items-center mt-4 mb-6 h-8 font-bold rounded-10 w-fit bg-theme-status-success text-theme-label-invert padding px-[0.9375rem]"},"Request sent"),n.default.createElement("p",{className:"mb-2 typo-callout text-theme-label-tertiary"},"You will be notified via email about the article request status.")):n.default.createElement(s.z,{className:"mt-4 btn-primary ",buttonSize:"small",type:"submit","aria-label":o,disabled:!D||!te,loading:$},n.default.createElement("span",{className:$&&"invisible"},o)))),M&&n.default.createElement("div",null,n.default.createElement("h4",{className:"px-10 pb-3.5 font-bold border-b border-theme-divider-tertiary typo-callout"},"Article exists"),n.default.createElement(g.Z,{postItem:M,showButtons:!1}))):n.default.createElement(n.default.Fragment,null)}},6646:(e,t,r)=>{r.d(t,{Z:()=>v});var a=r(5776),l=r(4184),n=r.n(l),i=r(1664),o=r.n(i),u=r(262),s=r(5708),c=r(2256),m=r(6990),d=r(104),f=r(8050),b=r(2360);const p=(0,c.Z)("div","absolute left-5 -my-1 w-8 h-8 rounded-full bg-theme-bg-primary"),y=e=>{let t=e.condition,r=e.wrapper,a=e.children;return t?r(a):a};function v(e){var t;let r=e.postItem,l=e.showButtons,i=void 0===l||l,c=e.clickable,v=void 0===c||c,h=e.onHide,g=e.className,w=e.onContextMenu;const E=r.timestampDb,x=r.post;return a.default.createElement(y,{condition:v,wrapper:e=>a.default.createElement(o(),{href:x.commentsPermalink},e)},a.default.createElement("article",{className:n()("flex relative flex-row items-center py-3 pr-5 pl-9",v&&"hover:bg-theme-hover hover:cursor-pointer",g)},a.default.createElement(b.E,{src:x.image,alt:x.title,className:"object-cover w-16 laptop:w-24 h-16 rounded-16",loading:"lazy",fallbackSrc:"https://res.cloudinary.com/daily-now/image/upload/f_auto/v1/placeholders/1"}),a.default.createElement(p,null),a.default.createElement(f.Y,{size:"small",rounded:"full",className:"absolute left-6",user:{image:null===(t=x.source)||void 0===t?void 0:t.image,username:`source of ${x.title}`},nativeLazyLoading:!0}),a.default.createElement("h3",{className:"flex flex-wrap flex-1 mr-6 ml-4 line-clamp-3 typo-callout"},x.title,a.default.createElement(d.Z,{readTime:x.readTime,numUpvotes:x.numUpvotes,typoClassName:"typo-callout"})),i&&h&&a.default.createElement(m.z,{buttonSize:"small",className:"hidden laptop:flex btn-tertiary",icon:a.default.createElement(u.Z,null),onClick:e=>{e.stopPropagation(),h({postId:x.id,timestamp:E})}}),i&&a.default.createElement(m.z,{className:"btn-tertiary","data-testId":`post-item-${x.id}`,icon:a.default.createElement(s.Z,null),onClick:e=>{e.stopPropagation(),w(e,r)},buttonSize:"small"})))}},122:(e,t,r)=>{function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){return Array.from(e.elements).reduce(((e,t)=>""===t.name?e:"checkbox"===t.type?l(l({},e),{},{[t.name]:t.checked}):"radio"!==t.type||t.checked?l(l({},e),{},{[t.name]:t.value.length?t.value:null}):e),t)}r.d(t,{x:()=>i})}}]);
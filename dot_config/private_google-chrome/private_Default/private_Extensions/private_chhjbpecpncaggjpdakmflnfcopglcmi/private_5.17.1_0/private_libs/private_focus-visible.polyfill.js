export default function applyFocusVisiblePolyfill(e,{attribute:t="data-focus-visible-added",className:n="focus-visible"}={}){var o=!0,d=!1,i=null,s={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function a(e){return!!(e&&e!==document&&"HTML"!==e.nodeName&&"BODY"!==e.nodeName&&"classList"in e&&"contains"in e.classList)}function u(e){e.classList.contains(n)||(e.classList.add(n),e.setAttribute(t,""))}function r(e){o=!1}function m(){document.addEventListener("mousemove",c),document.addEventListener("mousedown",c),document.addEventListener("mouseup",c),document.addEventListener("pointermove",c),document.addEventListener("pointerdown",c),document.addEventListener("pointerup",c),document.addEventListener("touchmove",c),document.addEventListener("touchstart",c),document.addEventListener("touchend",c)}function c(e){e.target.nodeName&&"html"===e.target.nodeName.toLowerCase()||(o=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mousedown",c),document.removeEventListener("mouseup",c),document.removeEventListener("pointermove",c),document.removeEventListener("pointerdown",c),document.removeEventListener("pointerup",c),document.removeEventListener("touchmove",c),document.removeEventListener("touchstart",c),document.removeEventListener("touchend",c))}document.addEventListener("keydown",(function(t){t.metaKey||t.altKey||t.ctrlKey||(a(e.activeElement)&&u(e.activeElement),o=!0)}),!0),document.addEventListener("mousedown",r,!0),document.addEventListener("pointerdown",r,!0),document.addEventListener("touchstart",r,!0),document.addEventListener("visibilitychange",(function(e){"hidden"===document.visibilityState&&(d&&(o=!0),m())}),!0),m(),e.addEventListener("focus",(function(e){var t,n,d;a(e.target)&&(o||(t=e.target,n=t.type,"INPUT"===(d=t.tagName)&&s[n]&&!t.readOnly||"TEXTAREA"===d&&!t.readOnly||t.isContentEditable))&&u(e.target)}),!0),e.addEventListener("blur",(function(e){var o;a(e.target)&&(e.target.classList.contains(n)||e.target.hasAttribute(t))&&(d=!0,window.clearTimeout(i),i=window.setTimeout((function(){d=!1}),100),(o=e.target).hasAttribute(t)&&(o.classList.remove(n),o.removeAttribute(t)))}),!0),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host?e.host.setAttribute("data-js-focus-visible",""):e.nodeType===Node.DOCUMENT_NODE&&(document.documentElement.classList.add("js-focus-visible"),document.documentElement.setAttribute("data-js-focus-visible",""))}